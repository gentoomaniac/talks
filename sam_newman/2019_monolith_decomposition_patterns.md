# GOTO 2019 • Monolith Decomposition Patterns • Sam Newman (2020-02-26)

![alt GOTO 2019 • Monolith Decomposition Patterns • Sam Newman](img/9I9GdSQ1bbM.jpg "GOTO 2019 • Monolith Decomposition Patterns • Sam Newman")

## Description

This presentation was recorded at GOTO Berlin 2019. #GOTOcon #GOTOber
http://gotober.com

Sam Newman - Expert in helping people ship software fast and author of “Building Microservices”

ABSTRACT
Big Bang rebuilds of systems are so 20th century. With our users expecting new functionality to be shipped more frequently than ever before, we no longer have the luxury of a complete system rebuild. In fact, a big bang migration of a monolithic architecture into a microservice architecture can be especially problematic, as we’ll explore in this talk.
We want to ship features, but we also want to improve our architecture, and for many of us this means breaking down existing systems into microservices. But how do you do this while still regularly releasing new features?
In this talk, I’ll share with you some key principles and a number of patterns which you can use to incrementally decompose an existing system into microservices. I’ll also cover off patterns that can work to migrate functionality out of systems you can’t change, which are useful when working with very old systems or vendor products. We'll look at the use of strangler patterns, change data capture [...]

Download slides and read the full abstract here:
https://gotober.com/2019/sessions/1127/monolith-decomposition-patterns

RECOMMENDED BOOKS
Sam Newman • Monolith to Microservices • https://amzn.to/2Nml96E

https://twitter.com/GOTOber
https://www.linkedin.com/company/goto-
https://www.facebook.com/GOTOConferences
#Microservices #SoftwareArchitecture #MicroserviceArchitecture #Monolith #MonolithicArchitecture

Looking for a unique learning experience?
Attend the next GOTO Conference near you! Get your ticket at http://gotocon.com

SUBSCRIBE TO OUR CHANNEL - new videos posted almost daily.
https://www.youtube.com/user/GotoConferences/?sub_confirmation=1

## Transcript

[0:00:03](https://youtu.be/9I9GdSQ1bbM?t=3) [Music]  
[0:00:12](https://youtu.be/9I9GdSQ1bbM?t=12) [Applause]  
[0:00:17](https://youtu.be/9I9GdSQ1bbM?t=17) everybody thank you so much for coming  
[0:00:19](https://youtu.be/9I9GdSQ1bbM?t=19) along I know it's a second day towards  
[0:00:22](https://youtu.be/9I9GdSQ1bbM?t=22) the end of the second day your energy  
[0:00:23](https://youtu.be/9I9GdSQ1bbM?t=23) levels are starting to dip a little bit  
[0:00:25](https://youtu.be/9I9GdSQ1bbM?t=25) you've got too much new information in  
[0:00:27](https://youtu.be/9I9GdSQ1bbM?t=27) your head you're feeling groggy and  
[0:00:28](https://youtu.be/9I9GdSQ1bbM?t=28) we're gonna cap it off later with some  
[0:00:30](https://youtu.be/9I9GdSQ1bbM?t=30) alcohol and Sam Aaron's gonna be playing  
[0:00:33](https://youtu.be/9I9GdSQ1bbM?t=33) some loud music to keep you awake so  
[0:00:35](https://youtu.be/9I9GdSQ1bbM?t=35) please do hang around for the party  
[0:00:36](https://youtu.be/9I9GdSQ1bbM?t=36) later I'm here to talk to you about  
[0:00:38](https://youtu.be/9I9GdSQ1bbM?t=38) monolith how we go from so a month to  
[0:00:40](https://youtu.be/9I9GdSQ1bbM?t=40) microservices should we even do it and  
[0:00:43](https://youtu.be/9I9GdSQ1bbM?t=43) I'm gonna share with you so about three  
[0:00:44](https://youtu.be/9I9GdSQ1bbM?t=44) or four different concrete patterns that  
[0:00:46](https://youtu.be/9I9GdSQ1bbM?t=46) you might want to be using as part of  
[0:00:48](https://youtu.be/9I9GdSQ1bbM?t=48) your decomposition of a system and  
[0:00:50](https://youtu.be/9I9GdSQ1bbM?t=50) thinking about how you might move  
[0:00:51](https://youtu.be/9I9GdSQ1bbM?t=51) towards a Microsoft architecture and  
[0:00:53](https://youtu.be/9I9GdSQ1bbM?t=53) fundamentally that is how I think you  
[0:00:55](https://youtu.be/9I9GdSQ1bbM?t=55) should use microservices I'm not really  
[0:00:58](https://youtu.be/9I9GdSQ1bbM?t=58) for adopting a micro-service  
[0:00:59](https://youtu.be/9I9GdSQ1bbM?t=59) architecture or up front so I think  
[0:01:01](https://youtu.be/9I9GdSQ1bbM?t=61) there's some challenges there so this is  
[0:01:03](https://youtu.be/9I9GdSQ1bbM?t=63) mostly going to be about how do we move  
[0:01:05](https://youtu.be/9I9GdSQ1bbM?t=65) towards a microservice architecture and  
[0:01:07](https://youtu.be/9I9GdSQ1bbM?t=67) fundamentally when something gets too  
[0:01:09](https://youtu.be/9I9GdSQ1bbM?t=69) big what you do about it and I do think  
[0:01:12](https://youtu.be/9I9GdSQ1bbM?t=72) it's the natural state of software to  
[0:01:14](https://youtu.be/9I9GdSQ1bbM?t=74) get too big right I think people feel  
[0:01:16](https://youtu.be/9I9GdSQ1bbM?t=76) bad or I get too big I can't deal with  
[0:01:18](https://youtu.be/9I9GdSQ1bbM?t=78) it now if the software was the right  
[0:01:20](https://youtu.be/9I9GdSQ1bbM?t=80) size you wouldn't split it apart so  
[0:01:23](https://youtu.be/9I9GdSQ1bbM?t=83) you're never going to get to the point  
[0:01:24](https://youtu.be/9I9GdSQ1bbM?t=84) where it you know it's got to get bigger  
[0:01:26](https://youtu.be/9I9GdSQ1bbM?t=86) for you to want to split it it's just  
[0:01:27](https://youtu.be/9I9GdSQ1bbM?t=87) life deal with it move on and what I'm  
[0:01:30](https://youtu.be/9I9GdSQ1bbM?t=90) hoping to do is share with you some  
[0:01:31](https://youtu.be/9I9GdSQ1bbM?t=91) concrete patterns that you can bring  
[0:01:33](https://youtu.be/9I9GdSQ1bbM?t=93) into action when these things happen I  
[0:01:35](https://youtu.be/9I9GdSQ1bbM?t=95) previously wrote a book about micro  
[0:01:37](https://youtu.be/9I9GdSQ1bbM?t=97) services and I've now run my own company  
[0:01:40](https://youtu.be/9I9GdSQ1bbM?t=100) I do training advisor work you can find  
[0:01:42](https://youtu.be/9I9GdSQ1bbM?t=102) out information about what I do on the  
[0:01:44](https://youtu.be/9I9GdSQ1bbM?t=104) Internet  
[0:01:45](https://youtu.be/9I9GdSQ1bbM?t=105) I am in the process where I finished my  
[0:01:47](https://youtu.be/9I9GdSQ1bbM?t=107) work I've handed over the proofs and  
[0:01:50](https://youtu.be/9I9GdSQ1bbM?t=110) everything of a new book called my  
[0:01:51](https://youtu.be/9I9GdSQ1bbM?t=111) little micro services which should be in  
[0:01:53](https://youtu.be/9I9GdSQ1bbM?t=113) print next month it's ironic that I  
[0:01:56](https://youtu.be/9I9GdSQ1bbM?t=116) spent a lot of my life trying to help  
[0:01:58](https://youtu.be/9I9GdSQ1bbM?t=118) people ship things quickly and  
[0:02:00](https://youtu.be/9I9GdSQ1bbM?t=120) frequently and as its idea of iterative  
[0:02:02](https://youtu.be/9I9GdSQ1bbM?t=122) incremental change and then I spent  
[0:02:04](https://youtu.be/9I9GdSQ1bbM?t=124) about last four years of my life  
[0:02:05](https://youtu.be/9I9GdSQ1bbM?t=125) creating books which have a very much a  
[0:02:07](https://youtu.be/9I9GdSQ1bbM?t=127) transactional one-off BIGBANG release  
[0:02:10](https://youtu.be/9I9GdSQ1bbM?t=130) going for them and something is just  
[0:02:12](https://youtu.be/9I9GdSQ1bbM?t=132) that the path to production for books  
[0:02:14](https://youtu.be/9I9GdSQ1bbM?t=134) seems to be going on forever but they  
[0:02:15](https://youtu.be/9I9GdSQ1bbM?t=135) should be out soon and you can get an  
[0:02:17](https://youtu.be/9I9GdSQ1bbM?t=137) access to an early version of this over  
[0:02:20](https://youtu.be/9I9GdSQ1bbM?t=140) sort of on the Internet  
[0:02:22](https://youtu.be/9I9GdSQ1bbM?t=142) but we here to talk about sort of micro  
[0:02:24](https://youtu.be/9I9GdSQ1bbM?t=144) services or more to the point or not  
[0:02:26](https://youtu.be/9I9GdSQ1bbM?t=146) really might be services but how do we  
[0:02:27](https://youtu.be/9I9GdSQ1bbM?t=147) go to something that looks a bit like  
[0:02:29](https://youtu.be/9I9GdSQ1bbM?t=149) this from from this from this this is  
[0:02:32](https://youtu.be/9I9GdSQ1bbM?t=152) the monolith of course some monoliths  
[0:02:34](https://youtu.be/9I9GdSQ1bbM?t=154) are picturesque and we've unfortunately  
[0:02:37](https://youtu.be/9I9GdSQ1bbM?t=157) I think we've come to sort of use the  
[0:02:40](https://youtu.be/9I9GdSQ1bbM?t=160) term monolith as a derogatory term we  
[0:02:43](https://youtu.be/9I9GdSQ1bbM?t=163) use the word monolith now instead of  
[0:02:45](https://youtu.be/9I9GdSQ1bbM?t=165) using the word legacy I would imagine  
[0:02:47](https://youtu.be/9I9GdSQ1bbM?t=167) there's probably some Google trend  
[0:02:49](https://youtu.be/9I9GdSQ1bbM?t=169) search I could do to show this happening  
[0:02:52](https://youtu.be/9I9GdSQ1bbM?t=172) and I could cherry-pick the data to  
[0:02:53](https://youtu.be/9I9GdSQ1bbM?t=173) prove my point but just go with me  
[0:02:55](https://youtu.be/9I9GdSQ1bbM?t=175) because I'm I'm just going to tell you  
[0:02:56](https://youtu.be/9I9GdSQ1bbM?t=176) its facts and we can move on but we do  
[0:02:58](https://youtu.be/9I9GdSQ1bbM?t=178) talk about the monolith as being a thing  
[0:03:02](https://youtu.be/9I9GdSQ1bbM?t=182) like it's a well understood shared  
[0:03:04](https://youtu.be/9I9GdSQ1bbM?t=184) concept but I don't think that's  
[0:03:06](https://youtu.be/9I9GdSQ1bbM?t=186) actually true because I think mothers  
[0:03:07](https://youtu.be/9I9GdSQ1bbM?t=187) actually come in all types of sizes and  
[0:03:09](https://youtu.be/9I9GdSQ1bbM?t=189) I think it's worth us exploring that  
[0:03:12](https://youtu.be/9I9GdSQ1bbM?t=192) very briefly the first thing is when I  
[0:03:14](https://youtu.be/9I9GdSQ1bbM?t=194) talk about a monolith I'm primarily  
[0:03:15](https://youtu.be/9I9GdSQ1bbM?t=195) talking about a unit of deployment and  
[0:03:18](https://youtu.be/9I9GdSQ1bbM?t=198) so a monolithic system would be one  
[0:03:20](https://youtu.be/9I9GdSQ1bbM?t=200) where all the functionality is has to be  
[0:03:22](https://youtu.be/9I9GdSQ1bbM?t=202) deployed on mass as part of a release  
[0:03:24](https://youtu.be/9I9GdSQ1bbM?t=204) process there's some nuance around that  
[0:03:27](https://youtu.be/9I9GdSQ1bbM?t=207) but we could start with the kind of de  
[0:03:29](https://youtu.be/9I9GdSQ1bbM?t=209) facto the simplest monolithic you'll  
[0:03:32](https://youtu.be/9I9GdSQ1bbM?t=212) ever type you will ever see which is so  
[0:03:34](https://youtu.be/9I9GdSQ1bbM?t=214) simple that you probably never actually  
[0:03:35](https://youtu.be/9I9GdSQ1bbM?t=215) see it because things are always a bit  
[0:03:36](https://youtu.be/9I9GdSQ1bbM?t=216) more complicated than this but basically  
[0:03:38](https://youtu.be/9I9GdSQ1bbM?t=218) all of our code is packaged together and  
[0:03:41](https://youtu.be/9I9GdSQ1bbM?t=221) deploy it as a single process we might  
[0:03:43](https://youtu.be/9I9GdSQ1bbM?t=223) have multiple copies of that process for  
[0:03:46](https://youtu.be/9I9GdSQ1bbM?t=226) increased scale or robustness and all of  
[0:03:49](https://youtu.be/9I9GdSQ1bbM?t=229) our data is in a database and I always  
[0:03:53](https://youtu.be/9I9GdSQ1bbM?t=233) like to tell people that this is a  
[0:03:54](https://youtu.be/9I9GdSQ1bbM?t=234) distributed system is just a really  
[0:03:56](https://youtu.be/9I9GdSQ1bbM?t=236) simple distributed system it will get  
[0:03:58](https://youtu.be/9I9GdSQ1bbM?t=238) slightly more complicated if you also  
[0:04:01](https://youtu.be/9I9GdSQ1bbM?t=241) have you know a web-based interface  
[0:04:03](https://youtu.be/9I9GdSQ1bbM?t=243) because now you've gotten at least two  
[0:04:04](https://youtu.be/9I9GdSQ1bbM?t=244) networks involved but most of the time  
[0:04:07](https://youtu.be/9I9GdSQ1bbM?t=247) you can sidestep the challenges  
[0:04:08](https://youtu.be/9I9GdSQ1bbM?t=248) associated with building distributed  
[0:04:11](https://youtu.be/9I9GdSQ1bbM?t=251) systems in this kind of topology we have  
[0:04:14](https://youtu.be/9I9GdSQ1bbM?t=254) the minor variation on this of course  
[0:04:15](https://youtu.be/9I9GdSQ1bbM?t=255) which is what some people refer to as  
[0:04:18](https://youtu.be/9I9GdSQ1bbM?t=258) the modular monolith this is where we're  
[0:04:20](https://youtu.be/9I9GdSQ1bbM?t=260) embracing cutting-edge ideas from the  
[0:04:22](https://youtu.be/9I9GdSQ1bbM?t=262) late 60s in terms of thinking about how  
[0:04:25](https://youtu.be/9I9GdSQ1bbM?t=265) to break the part software into your  
[0:04:26](https://youtu.be/9I9GdSQ1bbM?t=266) modular boundaries the idea here is that  
[0:04:29](https://youtu.be/9I9GdSQ1bbM?t=269) those modules can theoretically be  
[0:04:31](https://youtu.be/9I9GdSQ1bbM?t=271) worked on independently  
[0:04:32](https://youtu.be/9I9GdSQ1bbM?t=272) I actually think Amit Nam  
[0:04:34](https://youtu.be/9I9GdSQ1bbM?t=274) of the teams I work with would actually  
[0:04:36](https://youtu.be/9I9GdSQ1bbM?t=276) be better off with a modular monolith  
[0:04:38](https://youtu.be/9I9GdSQ1bbM?t=278) than they would a microservice  
[0:04:39](https://youtu.be/9I9GdSQ1bbM?t=279) architecture the challenge is often in  
[0:04:42](https://youtu.be/9I9GdSQ1bbM?t=282) how do you find and identify good  
[0:04:45](https://youtu.be/9I9GdSQ1bbM?t=285) modular boundaries which allows this  
[0:04:47](https://youtu.be/9I9GdSQ1bbM?t=287) work to be done independently and now  
[0:04:50](https://youtu.be/9I9GdSQ1bbM?t=290) with this sort of work I could take have  
[0:04:52](https://youtu.be/9I9GdSQ1bbM?t=292) a team working on module see a different  
[0:04:53](https://youtu.be/9I9GdSQ1bbM?t=293) team working on module a and so on and  
[0:04:55](https://youtu.be/9I9GdSQ1bbM?t=295) so forth  
[0:04:56](https://youtu.be/9I9GdSQ1bbM?t=296) allowing a degree of parallel working  
[0:04:58](https://youtu.be/9I9GdSQ1bbM?t=298) but fundamentally the act of deployment  
[0:05:01](https://youtu.be/9I9GdSQ1bbM?t=301) still is a monolithic unit I have to  
[0:05:04](https://youtu.be/9I9GdSQ1bbM?t=304) integrate that code together I  
[0:05:06](https://youtu.be/9I9GdSQ1bbM?t=306) statically link that code together I  
[0:05:08](https://youtu.be/9I9GdSQ1bbM?t=308) deploy the thing as a single unit at  
[0:05:10](https://youtu.be/9I9GdSQ1bbM?t=310) least that is the case for most runtimes  
[0:05:13](https://youtu.be/9I9GdSQ1bbM?t=313) there are of course runtimes out there  
[0:05:15](https://youtu.be/9I9GdSQ1bbM?t=315) which really do allow for the hot  
[0:05:17](https://youtu.be/9I9GdSQ1bbM?t=317) deployment of modules are in a really  
[0:05:20](https://youtu.be/9I9GdSQ1bbM?t=320) robust way you know they're kind of you  
[0:05:23](https://youtu.be/9I9GdSQ1bbM?t=323) know some of you may have heard of  
[0:05:24](https://youtu.be/9I9GdSQ1bbM?t=324) Greenspan's law which is the statement  
[0:05:26](https://youtu.be/9I9GdSQ1bbM?t=326) that every system evolves to contain a  
[0:05:28](https://youtu.be/9I9GdSQ1bbM?t=328) half-broken  
[0:05:29](https://youtu.be/9I9GdSQ1bbM?t=329) implementation of Lisp the microservice  
[0:05:32](https://youtu.be/9I9GdSQ1bbM?t=332) variation of that is that every micro  
[0:05:34](https://youtu.be/9I9GdSQ1bbM?t=334) service architecture eventually evolves  
[0:05:36](https://youtu.be/9I9GdSQ1bbM?t=336) the point where it contains a  
[0:05:37](https://youtu.be/9I9GdSQ1bbM?t=337) half-broken implementation of Erlang  
[0:05:39](https://youtu.be/9I9GdSQ1bbM?t=339) because Erlang does actually allow you  
[0:05:41](https://youtu.be/9I9GdSQ1bbM?t=341) to do some really funky staff around  
[0:05:43](https://youtu.be/9I9GdSQ1bbM?t=343) modular deployments and I hoping at the  
[0:05:46](https://youtu.be/9I9GdSQ1bbM?t=346) current pace of change in the Java world  
[0:05:48](https://youtu.be/9I9GdSQ1bbM?t=348) in about 15 to 20 years we too might  
[0:05:51](https://youtu.be/9I9GdSQ1bbM?t=351) have something that Erlang had 15 years  
[0:05:52](https://youtu.be/9I9GdSQ1bbM?t=352) ago cross fingers we'll see what happens  
[0:05:55](https://youtu.be/9I9GdSQ1bbM?t=355) but in all seriousness it we may well  
[0:05:57](https://youtu.be/9I9GdSQ1bbM?t=357) start moving back away from micro  
[0:05:59](https://youtu.be/9I9GdSQ1bbM?t=359) services if more of us have access to  
[0:06:02](https://youtu.be/9I9GdSQ1bbM?t=362) runtimes  
[0:06:03](https://youtu.be/9I9GdSQ1bbM?t=363) which allow us to hot-swap modules the  
[0:06:06](https://youtu.be/9I9GdSQ1bbM?t=366) reality is most of us don't and  
[0:06:07](https://youtu.be/9I9GdSQ1bbM?t=367) therefore we're forced into think  
[0:06:09](https://youtu.be/9I9GdSQ1bbM?t=369) different ways of working and different  
[0:06:11](https://youtu.be/9I9GdSQ1bbM?t=371) sort of architecture topologies a  
[0:06:13](https://youtu.be/9I9GdSQ1bbM?t=373) traditional modular monolith will  
[0:06:16](https://youtu.be/9I9GdSQ1bbM?t=376) typically have as well as being all  
[0:06:19](https://youtu.be/9I9GdSQ1bbM?t=379) bundled together in a single process the  
[0:06:21](https://youtu.be/9I9GdSQ1bbM?t=381) data is often still bundled up in a  
[0:06:24](https://youtu.be/9I9GdSQ1bbM?t=384) single database as well which does cause  
[0:06:27](https://youtu.be/9I9GdSQ1bbM?t=387) you issues if later on you want to maybe  
[0:06:30](https://youtu.be/9I9GdSQ1bbM?t=390) split module e out as to a separate  
[0:06:32](https://youtu.be/9I9GdSQ1bbM?t=392) micro service architecture and so you  
[0:06:35](https://youtu.be/9I9GdSQ1bbM?t=395) can look at variations of this approach  
[0:06:37](https://youtu.be/9I9GdSQ1bbM?t=397) which is something I've advocated in it  
[0:06:38](https://youtu.be/9I9GdSQ1bbM?t=398) with a few of the teams I've worked with  
[0:06:40](https://youtu.be/9I9GdSQ1bbM?t=400) which is you know if you think that  
[0:06:41](https://youtu.be/9I9GdSQ1bbM?t=401) maybe we'll do micro service in the  
[0:06:43](https://youtu.be/9I9GdSQ1bbM?t=403) future but we're not sure  
[0:06:44](https://youtu.be/9I9GdSQ1bbM?t=404) one of the ways you can kind of hedge  
[0:06:46](https://youtu.be/9I9GdSQ1bbM?t=406) your bets is to start with module  
[0:06:48](https://youtu.be/9I9GdSQ1bbM?t=408) boundaries where you think your  
[0:06:50](https://youtu.be/9I9GdSQ1bbM?t=410) micro-service boundaries would be but  
[0:06:52](https://youtu.be/9I9GdSQ1bbM?t=412) also isolate the data associated with  
[0:06:54](https://youtu.be/9I9GdSQ1bbM?t=414) those micro-services because it's often  
[0:06:57](https://youtu.be/9I9GdSQ1bbM?t=417) decomposing the database is the most  
[0:06:59](https://youtu.be/9I9GdSQ1bbM?t=419) problematic aspect we'll come back to  
[0:07:00](https://youtu.be/9I9GdSQ1bbM?t=420) that idea of how we pull databases apart  
[0:07:03](https://youtu.be/9I9GdSQ1bbM?t=423) a bit later on turns out it's really  
[0:07:05](https://youtu.be/9I9GdSQ1bbM?t=425) difficult and then of course we've got  
[0:07:07](https://youtu.be/9I9GdSQ1bbM?t=427) the other type of monoliths I'll two  
[0:07:09](https://youtu.be/9I9GdSQ1bbM?t=429) more to look at we've got kind of the  
[0:07:11](https://youtu.be/9I9GdSQ1bbM?t=431) third party model if this might be your  
[0:07:13](https://youtu.be/9I9GdSQ1bbM?t=433) your customizable off-the-shelf software  
[0:07:15](https://youtu.be/9I9GdSQ1bbM?t=435) finance base CRM it could be a cloud  
[0:07:18](https://youtu.be/9I9GdSQ1bbM?t=438) software it could be staff based  
[0:07:20](https://youtu.be/9I9GdSQ1bbM?t=440) software this is software which is  
[0:07:21](https://youtu.be/9I9GdSQ1bbM?t=441) completely out of your control and we're  
[0:07:24](https://youtu.be/9I9GdSQ1bbM?t=444) often in situations though where we want  
[0:07:25](https://youtu.be/9I9GdSQ1bbM?t=445) to migrate functionality away from these  
[0:07:27](https://youtu.be/9I9GdSQ1bbM?t=447) sorts of things you have limited ability  
[0:07:29](https://youtu.be/9I9GdSQ1bbM?t=449) to change the system  
[0:07:31](https://youtu.be/9I9GdSQ1bbM?t=451) you're even very little control over how  
[0:07:33](https://youtu.be/9I9GdSQ1bbM?t=453) it's implemented or built if you're  
[0:07:35](https://youtu.be/9I9GdSQ1bbM?t=455) lucky you'll get a database and that can  
[0:07:37](https://youtu.be/9I9GdSQ1bbM?t=457) open up interesting possibilities of  
[0:07:39](https://youtu.be/9I9GdSQ1bbM?t=459) doing things like change data capture  
[0:07:40](https://youtu.be/9I9GdSQ1bbM?t=460) you might even have api's if you're very  
[0:07:43](https://youtu.be/9I9GdSQ1bbM?t=463) very lucky again I have worked with or  
[0:07:45](https://youtu.be/9I9GdSQ1bbM?t=465) clients that have had to migrate away  
[0:07:46](https://youtu.be/9I9GdSQ1bbM?t=466) from their own software but treat it  
[0:07:49](https://youtu.be/9I9GdSQ1bbM?t=469) like blackbox software because they've  
[0:07:50](https://youtu.be/9I9GdSQ1bbM?t=470) lost the source code and it don't lose  
[0:07:53](https://youtu.be/9I9GdSQ1bbM?t=473) your source code please check source  
[0:07:54](https://youtu.be/9I9GdSQ1bbM?t=474) code in it is 2019 but I still have to  
[0:07:57](https://youtu.be/9I9GdSQ1bbM?t=477) say that every now and then the worst  
[0:07:59](https://youtu.be/9I9GdSQ1bbM?t=479) type of model if we deal with and buy  
[0:08:01](https://youtu.be/9I9GdSQ1bbM?t=481) worse I mean the type of monolithic  
[0:08:03](https://youtu.be/9I9GdSQ1bbM?t=483) architecture which tends to not be very  
[0:08:06](https://youtu.be/9I9GdSQ1bbM?t=486) beneficial for what we tend to want  
[0:08:08](https://youtu.be/9I9GdSQ1bbM?t=488) nowadays is of what's called the  
[0:08:10](https://youtu.be/9I9GdSQ1bbM?t=490) distributed monolith the distributed  
[0:08:12](https://youtu.be/9I9GdSQ1bbM?t=492) monolith is one where our software is  
[0:08:14](https://youtu.be/9I9GdSQ1bbM?t=494) actually the sort of deployment topology  
[0:08:16](https://youtu.be/9I9GdSQ1bbM?t=496) of our software is functionality  
[0:08:17](https://youtu.be/9I9GdSQ1bbM?t=497) deployed as separate processes those  
[0:08:20](https://youtu.be/9I9GdSQ1bbM?t=500) processes are communicating over  
[0:08:22](https://youtu.be/9I9GdSQ1bbM?t=502) networks but because of how we've broken  
[0:08:24](https://youtu.be/9I9GdSQ1bbM?t=504) that system apart or maybe other factors  
[0:08:26](https://youtu.be/9I9GdSQ1bbM?t=506) we're in a situation where code often  
[0:08:30](https://youtu.be/9I9GdSQ1bbM?t=510) needs to be changed across module  
[0:08:31](https://youtu.be/9I9GdSQ1bbM?t=511) boundaries maybe business functionality  
[0:08:33](https://youtu.be/9I9GdSQ1bbM?t=513) is smeared across these boundaries the  
[0:08:36](https://youtu.be/9I9GdSQ1bbM?t=516) classic three-tiered architecture would  
[0:08:38](https://youtu.be/9I9GdSQ1bbM?t=518) fall under this kind of banner and now  
[0:08:40](https://youtu.be/9I9GdSQ1bbM?t=520) you enter the world of either having to  
[0:08:41](https://youtu.be/9I9GdSQ1bbM?t=521) deploy everything together or quite  
[0:08:43](https://youtu.be/9I9GdSQ1bbM?t=523) complex release coordination activities  
[0:08:45](https://youtu.be/9I9GdSQ1bbM?t=525) to roll out changes we have to replace  
[0:08:47](https://youtu.be/9I9GdSQ1bbM?t=527) the whole system and these sorts of  
[0:08:49](https://youtu.be/9I9GdSQ1bbM?t=529) distributed monoliths have the problem  
[0:08:52](https://youtu.be/9I9GdSQ1bbM?t=532) that they have all the downsides of  
[0:08:53](https://youtu.be/9I9GdSQ1bbM?t=533) being a distributed system but also many  
[0:08:56](https://youtu.be/9I9GdSQ1bbM?t=536) of the downside  
[0:08:57](https://youtu.be/9I9GdSQ1bbM?t=537) of being a monolithic system as well  
[0:08:59](https://youtu.be/9I9GdSQ1bbM?t=539) this is a bad place to be if you're here  
[0:09:02](https://youtu.be/9I9GdSQ1bbM?t=542) the the secret to here is to not mad  
[0:09:04](https://youtu.be/9I9GdSQ1bbM?t=544) anymore services  
[0:09:05](https://youtu.be/9I9GdSQ1bbM?t=545) maybe you should be merging things back  
[0:09:07](https://youtu.be/9I9GdSQ1bbM?t=547) together again sometimes these  
[0:09:10](https://youtu.be/9I9GdSQ1bbM?t=550) distribution lists can actually emerge  
[0:09:11](https://youtu.be/9I9GdSQ1bbM?t=551) partly because of how your deployment  
[0:09:14](https://youtu.be/9I9GdSQ1bbM?t=554) processes work  
[0:09:15](https://youtu.be/9I9GdSQ1bbM?t=555) but fundamentally these systems have a  
[0:09:16](https://youtu.be/9I9GdSQ1bbM?t=556) high cost of change the scope of  
[0:09:19](https://youtu.be/9I9GdSQ1bbM?t=559) deployments are much larger there are  
[0:09:20](https://youtu.be/9I9GdSQ1bbM?t=560) many many more things to go wrong and  
[0:09:22](https://youtu.be/9I9GdSQ1bbM?t=562) you typically have much higher release  
[0:09:24](https://youtu.be/9I9GdSQ1bbM?t=564) coordination activity those of you who  
[0:09:27](https://youtu.be/9I9GdSQ1bbM?t=567) are practicing a relief technique called  
[0:09:29](https://youtu.be/9I9GdSQ1bbM?t=569) to the release train choo choo everybody  
[0:09:32](https://youtu.be/9I9GdSQ1bbM?t=572) aboard of the release train you may  
[0:09:34](https://youtu.be/9I9GdSQ1bbM?t=574) sometimes sleep walk into a distributed  
[0:09:37](https://youtu.be/9I9GdSQ1bbM?t=577) monolith the way the released trains  
[0:09:38](https://youtu.be/9I9GdSQ1bbM?t=578) work is you set a cadence you say every  
[0:09:40](https://youtu.be/9I9GdSQ1bbM?t=580) four weeks all the software we've  
[0:09:42](https://youtu.be/9I9GdSQ1bbM?t=582) created will go live at the same time  
[0:09:44](https://youtu.be/9I9GdSQ1bbM?t=584) the whole point of a release train is  
[0:09:47](https://youtu.be/9I9GdSQ1bbM?t=587) it's a remedial activity it is a  
[0:09:49](https://youtu.be/9I9GdSQ1bbM?t=589) stepping stone if you're looking to  
[0:09:51](https://youtu.be/9I9GdSQ1bbM?t=591) actually improve your delivery practices  
[0:09:53](https://youtu.be/9I9GdSQ1bbM?t=593) the release train is not an aspirational  
[0:09:55](https://youtu.be/9I9GdSQ1bbM?t=595) process for shipping software it's like  
[0:09:58](https://youtu.be/9I9GdSQ1bbM?t=598) having training wheels on your bike if  
[0:09:59](https://youtu.be/9I9GdSQ1bbM?t=599) you stay with the release train for too  
[0:10:02](https://youtu.be/9I9GdSQ1bbM?t=602) long you codify the idea that we bundle  
[0:10:05](https://youtu.be/9I9GdSQ1bbM?t=605) all of our software together and release  
[0:10:06](https://youtu.be/9I9GdSQ1bbM?t=606) it periodically that's not the point  
[0:10:08](https://youtu.be/9I9GdSQ1bbM?t=608) we're trying to move through that  
[0:10:09](https://youtu.be/9I9GdSQ1bbM?t=609) towards proper continuous delivery there  
[0:10:12](https://youtu.be/9I9GdSQ1bbM?t=612) are some processes out there such as  
[0:10:17](https://youtu.be/9I9GdSQ1bbM?t=617) safe which is anything but which  
[0:10:19](https://youtu.be/9I9GdSQ1bbM?t=619) actually codifies the release train as  
[0:10:21](https://youtu.be/9I9GdSQ1bbM?t=621) being the best way to release software  
[0:10:23](https://youtu.be/9I9GdSQ1bbM?t=623) which is patently insane if you don't  
[0:10:27](https://youtu.be/9I9GdSQ1bbM?t=627) know more on this topic I suggest you  
[0:10:29](https://youtu.be/9I9GdSQ1bbM?t=629) read a book that's quite hold now called  
[0:10:30](https://youtu.be/9I9GdSQ1bbM?t=630) continuous delivery which explains why a  
[0:10:32](https://youtu.be/9I9GdSQ1bbM?t=632) release train may not be what you want  
[0:10:34](https://youtu.be/9I9GdSQ1bbM?t=634) to aim for but it can actually lead to  
[0:10:36](https://youtu.be/9I9GdSQ1bbM?t=636) these really tightly integrated  
[0:10:38](https://youtu.be/9I9GdSQ1bbM?t=638) architectures so what we're looking for  
[0:10:41](https://youtu.be/9I9GdSQ1bbM?t=641) here is monoliths have properties those  
[0:10:45](https://youtu.be/9I9GdSQ1bbM?t=645) properties may or may not be a problem  
[0:10:46](https://youtu.be/9I9GdSQ1bbM?t=646) for you the fundamentally you have to  
[0:10:48](https://youtu.be/9I9GdSQ1bbM?t=648) accept that the monolith isn't  
[0:10:50](https://youtu.be/9I9GdSQ1bbM?t=650) necessarily the enemy it is extremely  
[0:10:53](https://youtu.be/9I9GdSQ1bbM?t=653) rare that your goal is to kill the  
[0:10:56](https://youtu.be/9I9GdSQ1bbM?t=656) monolith it sometimes happens but most  
[0:10:58](https://youtu.be/9I9GdSQ1bbM?t=658) of the time you're in a situation where  
[0:11:00](https://youtu.be/9I9GdSQ1bbM?t=660) you're trying to achieve something as a  
[0:11:02](https://youtu.be/9I9GdSQ1bbM?t=662) business but your current architecture  
[0:11:04](https://youtu.be/9I9GdSQ1bbM?t=664) won't let you achieve that goal and so  
[0:11:06](https://youtu.be/9I9GdSQ1bbM?t=666) what you need to do is you change the  
[0:11:08](https://youtu.be/9I9GdSQ1bbM?t=668) architecture enough to do what you need  
[0:11:10](https://youtu.be/9I9GdSQ1bbM?t=670) to do  
[0:11:10](https://youtu.be/9I9GdSQ1bbM?t=670) maybe to handle more scale to allow more  
[0:11:13](https://youtu.be/9I9GdSQ1bbM?t=673) developers to work side-by-side  
[0:11:15](https://youtu.be/9I9GdSQ1bbM?t=675) effectively and efficiently it is  
[0:11:17](https://youtu.be/9I9GdSQ1bbM?t=677) vanishingly rare that I work with teams  
[0:11:19](https://youtu.be/9I9GdSQ1bbM?t=679) who are trying to completely remove the  
[0:11:21](https://youtu.be/9I9GdSQ1bbM?t=681) old monolithic system they know we just  
[0:11:23](https://youtu.be/9I9GdSQ1bbM?t=683) need to change it enough to solve their  
[0:11:25](https://youtu.be/9I9GdSQ1bbM?t=685) immediate problems and then they get on  
[0:11:27](https://youtu.be/9I9GdSQ1bbM?t=687) with other things this idea I think too  
[0:11:30](https://youtu.be/9I9GdSQ1bbM?t=690) often is we're going to engage in some  
[0:11:32](https://youtu.be/9I9GdSQ1bbM?t=692) kind of like Big Bang rewrite of our  
[0:11:36](https://youtu.be/9I9GdSQ1bbM?t=696) systems so you know as Martin Fowler  
[0:11:39](https://youtu.be/9I9GdSQ1bbM?t=699) once said if you do a Big Bang rewrite  
[0:11:41](https://youtu.be/9I9GdSQ1bbM?t=701) the only thing you're guaranteed is a  
[0:11:43](https://youtu.be/9I9GdSQ1bbM?t=703) Big Bang which is great I like  
[0:11:45](https://youtu.be/9I9GdSQ1bbM?t=705) explosions in action films I don't  
[0:11:47](https://youtu.be/9I9GdSQ1bbM?t=707) necessarily like explosions in my IT  
[0:11:49](https://youtu.be/9I9GdSQ1bbM?t=709) projects the reality is that you know  
[0:11:54](https://youtu.be/9I9GdSQ1bbM?t=714) micro-services bring an awful lot of  
[0:11:56](https://youtu.be/9I9GdSQ1bbM?t=716) pain and suffering but it's very hard to  
[0:11:59](https://youtu.be/9I9GdSQ1bbM?t=719) assess how that's going to impact you  
[0:12:01](https://youtu.be/9I9GdSQ1bbM?t=721) until you've actually started using them  
[0:12:03](https://youtu.be/9I9GdSQ1bbM?t=723) it's this reason I don't you know we  
[0:12:05](https://youtu.be/9I9GdSQ1bbM?t=725) need to think about adopting  
[0:12:06](https://youtu.be/9I9GdSQ1bbM?t=726) micro-service is not like flicking a  
[0:12:07](https://youtu.be/9I9GdSQ1bbM?t=727) switch it's like turning the dial as you  
[0:12:10](https://youtu.be/9I9GdSQ1bbM?t=730) turn that dial up and you have more  
[0:12:12](https://youtu.be/9I9GdSQ1bbM?t=732) services you get more opportunity to  
[0:12:15](https://youtu.be/9I9GdSQ1bbM?t=735) take advantage of those services you  
[0:12:17](https://youtu.be/9I9GdSQ1bbM?t=737) also have more opportunity to take  
[0:12:19](https://youtu.be/9I9GdSQ1bbM?t=739) advantage of experience in a really true  
[0:12:22](https://youtu.be/9I9GdSQ1bbM?t=742) visceral way how horrifying distributed  
[0:12:26](https://youtu.be/9I9GdSQ1bbM?t=746) systems can become and for that reason  
[0:12:27](https://youtu.be/9I9GdSQ1bbM?t=747) it's a good idea to turn that dial up  
[0:12:29](https://youtu.be/9I9GdSQ1bbM?t=749) gradually create one or two services  
[0:12:32](https://youtu.be/9I9GdSQ1bbM?t=752) maybe extract just the one extract a  
[0:12:34](https://youtu.be/9I9GdSQ1bbM?t=754) piece of functionality from your  
[0:12:35](https://youtu.be/9I9GdSQ1bbM?t=755) monolith integrate it with the monolith  
[0:12:38](https://youtu.be/9I9GdSQ1bbM?t=758) first deploy it into a production  
[0:12:41](https://youtu.be/9I9GdSQ1bbM?t=761) environment and learn from that before  
[0:12:43](https://youtu.be/9I9GdSQ1bbM?t=763) you move on you will not appreciate the  
[0:12:46](https://youtu.be/9I9GdSQ1bbM?t=766) true horror pain and suffering of  
[0:12:48](https://youtu.be/9I9GdSQ1bbM?t=768) microservices until you're running them  
[0:12:50](https://youtu.be/9I9GdSQ1bbM?t=770) in production you have not completed a  
[0:12:52](https://youtu.be/9I9GdSQ1bbM?t=772) migration until it is in production so  
[0:12:54](https://youtu.be/9I9GdSQ1bbM?t=774) it's really important not just from the  
[0:12:56](https://youtu.be/9I9GdSQ1bbM?t=776) point of view that we're looking to  
[0:12:57](https://youtu.be/9I9GdSQ1bbM?t=777) incremental er change our architecture  
[0:12:59](https://youtu.be/9I9GdSQ1bbM?t=779) for you know it not taking us years to  
[0:13:02](https://youtu.be/9I9GdSQ1bbM?t=782) change something but also in terms of  
[0:13:04](https://youtu.be/9I9GdSQ1bbM?t=784) improving our feedback cycles start with  
[0:13:07](https://youtu.be/9I9GdSQ1bbM?t=787) something easy extract here deploy it  
[0:13:10](https://youtu.be/9I9GdSQ1bbM?t=790) learn from that experience use that to  
[0:13:12](https://youtu.be/9I9GdSQ1bbM?t=792) refine the next thing you do if  
[0:13:15](https://youtu.be/9I9GdSQ1bbM?t=795) therefore follows though that any  
[0:13:16](https://youtu.be/9I9GdSQ1bbM?t=796) techniques we use in this area must be  
[0:13:19](https://youtu.be/9I9GdSQ1bbM?t=799) things that allow us to make incremental  
[0:13:21](https://youtu.be/9I9GdSQ1bbM?t=801) change to aim  
[0:13:22](https://youtu.be/9I9GdSQ1bbM?t=802) system without requiring the whole thing  
[0:13:25](https://youtu.be/9I9GdSQ1bbM?t=805) to be we architected this also though of  
[0:13:27](https://youtu.be/9I9GdSQ1bbM?t=807) course has the added benefit that any  
[0:13:29](https://youtu.be/9I9GdSQ1bbM?t=809) incremental migration techniques we  
[0:13:30](https://youtu.be/9I9GdSQ1bbM?t=810) might use can also allow us to  
[0:13:32](https://youtu.be/9I9GdSQ1bbM?t=812) interleave a bit of architectural  
[0:13:34](https://youtu.be/9I9GdSQ1bbM?t=814) refactoring with you know shipping some  
[0:13:36](https://youtu.be/9I9GdSQ1bbM?t=816) features to our customers which might  
[0:13:38](https://youtu.be/9I9GdSQ1bbM?t=818) actually be a good idea so that all the  
[0:13:40](https://youtu.be/9I9GdSQ1bbM?t=820) techniques under take you through are  
[0:13:42](https://youtu.be/9I9GdSQ1bbM?t=822) designed to be used in an incremental  
[0:13:43](https://youtu.be/9I9GdSQ1bbM?t=823) fashion to allow you to turn that dial  
[0:13:46](https://youtu.be/9I9GdSQ1bbM?t=826) gradually to migrate your system to  
[0:13:49](https://youtu.be/9I9GdSQ1bbM?t=829) learn as you go and then maybe as you  
[0:13:50](https://youtu.be/9I9GdSQ1bbM?t=830) become more experienced you become  
[0:13:52](https://youtu.be/9I9GdSQ1bbM?t=832) bolder you can turn that dial more  
[0:13:54](https://youtu.be/9I9GdSQ1bbM?t=834) quickly  
[0:13:55](https://youtu.be/9I9GdSQ1bbM?t=835) although maybe you don't need to you've  
[0:13:57](https://youtu.be/9I9GdSQ1bbM?t=837) also got to remember that micro services  
[0:13:59](https://youtu.be/9I9GdSQ1bbM?t=839) are not the goal you don't win by doing  
[0:14:02](https://youtu.be/9I9GdSQ1bbM?t=842) micro services I win because I sell  
[0:14:05](https://youtu.be/9I9GdSQ1bbM?t=845) copies of my book that's great for me  
[0:14:06](https://youtu.be/9I9GdSQ1bbM?t=846) I'm not sure that that's necessary a  
[0:14:09](https://youtu.be/9I9GdSQ1bbM?t=849) life goal for yourselves this is why  
[0:14:11](https://youtu.be/9I9GdSQ1bbM?t=851) it's all so silly when people start  
[0:14:13](https://youtu.be/9I9GdSQ1bbM?t=853) comparing how many micro services you've  
[0:14:15](https://youtu.be/9I9GdSQ1bbM?t=855) got like somehow that's important  
[0:14:18](https://youtu.be/9I9GdSQ1bbM?t=858) comparing yourself with another company  
[0:14:20](https://youtu.be/9I9GdSQ1bbM?t=860) it's not helpful because they're in a  
[0:14:22](https://youtu.be/9I9GdSQ1bbM?t=862) different situation with different  
[0:14:24](https://youtu.be/9I9GdSQ1bbM?t=864) drivers different challenges different  
[0:14:25](https://youtu.be/9I9GdSQ1bbM?t=865) skills different technology  
[0:14:27](https://youtu.be/9I9GdSQ1bbM?t=867) so what mons oh I've got 1,400 micro  
[0:14:29](https://youtu.be/9I9GdSQ1bbM?t=869) services it seems nuts but they seem to  
[0:14:31](https://youtu.be/9I9GdSQ1bbM?t=871) be working quite well as a company you  
[0:14:33](https://youtu.be/9I9GdSQ1bbM?t=873) might need four if you're four and your  
[0:14:35](https://youtu.be/9I9GdSQ1bbM?t=875) developers are happy and your customers  
[0:14:37](https://youtu.be/9I9GdSQ1bbM?t=877) are happy move on with your life don't  
[0:14:39](https://youtu.be/9I9GdSQ1bbM?t=879) worry too much about it but just above  
[0:14:40](https://youtu.be/9I9GdSQ1bbM?t=880) all please please do buy my book so  
[0:14:44](https://youtu.be/9I9GdSQ1bbM?t=884) incremental migration patterns let's  
[0:14:46](https://youtu.be/9I9GdSQ1bbM?t=886) start with one of the most well known in  
[0:14:49](https://youtu.be/9I9GdSQ1bbM?t=889) this area we're gonna look at basically  
[0:14:50](https://youtu.be/9I9GdSQ1bbM?t=890) two patterns for how we might pull apart  
[0:14:52](https://youtu.be/9I9GdSQ1bbM?t=892) our application code and a couple around  
[0:14:55](https://youtu.be/9I9GdSQ1bbM?t=895) how we deal with the data we'll talk a  
[0:14:57](https://youtu.be/9I9GdSQ1bbM?t=897) little bit about data and data  
[0:14:58](https://youtu.be/9I9GdSQ1bbM?t=898) management as well so we can start off  
[0:15:01](https://youtu.be/9I9GdSQ1bbM?t=901) with quite a well-known patent and  
[0:15:02](https://youtu.be/9I9GdSQ1bbM?t=902) that's a pattern called the strangler  
[0:15:05](https://youtu.be/9I9GdSQ1bbM?t=905) fig pattern so this is actually named  
[0:15:07](https://youtu.be/9I9GdSQ1bbM?t=907) after a type of plant that you can find  
[0:15:09](https://youtu.be/9I9GdSQ1bbM?t=909) Australia what we're seeing here is  
[0:15:10](https://youtu.be/9I9GdSQ1bbM?t=910) actually a tree in the rain forest in  
[0:15:12](https://youtu.be/9I9GdSQ1bbM?t=912) Queensland we're seeing a tree and  
[0:15:14](https://youtu.be/9I9GdSQ1bbM?t=914) wrapped around it is actually a type of  
[0:15:15](https://youtu.be/9I9GdSQ1bbM?t=915) thick such a vine and basically it sort  
[0:15:18](https://youtu.be/9I9GdSQ1bbM?t=918) of descends and wraps itself around the  
[0:15:20](https://youtu.be/9I9GdSQ1bbM?t=920) plant the idea with the strangler fig is  
[0:15:22](https://youtu.be/9I9GdSQ1bbM?t=922) that by itself it couldn't possibly  
[0:15:25](https://youtu.be/9I9GdSQ1bbM?t=925) establish itself in a jungle setting it  
[0:15:27](https://youtu.be/9I9GdSQ1bbM?t=927) couldn't be tall enough to get it you  
[0:15:29](https://youtu.be/9I9GdSQ1bbM?t=929) know roots into the soil but also to get  
[0:15:31](https://youtu.be/9I9GdSQ1bbM?t=931) leaves up into the canopy or it can get  
[0:15:34](https://youtu.be/9I9GdSQ1bbM?t=934) photos  
[0:15:34](https://youtu.be/9I9GdSQ1bbM?t=934) this everything else and so it wraps  
[0:15:36](https://youtu.be/9I9GdSQ1bbM?t=936) itself around an existing structure and  
[0:15:38](https://youtu.be/9I9GdSQ1bbM?t=938) the strangler fig pattern in our  
[0:15:40](https://youtu.be/9I9GdSQ1bbM?t=940) application sense is the same idea we  
[0:15:43](https://youtu.be/9I9GdSQ1bbM?t=943) wrap new functionality around old  
[0:15:45](https://youtu.be/9I9GdSQ1bbM?t=945) functionality and this has also proved  
[0:15:47](https://youtu.be/9I9GdSQ1bbM?t=947) out another thing I've been saying for  
[0:15:48](https://youtu.be/9I9GdSQ1bbM?t=948) many years after having lived in  
[0:15:50](https://youtu.be/9I9GdSQ1bbM?t=950) Australia for quite a while it's that  
[0:15:52](https://youtu.be/9I9GdSQ1bbM?t=952) every people in Australia were lovely  
[0:15:53](https://youtu.be/9I9GdSQ1bbM?t=953) the food nice but all the things on the  
[0:15:56](https://youtu.be/9I9GdSQ1bbM?t=956) land want to kill you and all the things  
[0:15:58](https://youtu.be/9I9GdSQ1bbM?t=958) in the sea want to kill you the weather  
[0:15:59](https://youtu.be/9I9GdSQ1bbM?t=959) wants to kill you and some plants  
[0:16:01](https://youtu.be/9I9GdSQ1bbM?t=961) apparently want to kill other plants so  
[0:16:03](https://youtu.be/9I9GdSQ1bbM?t=963) please do go but just look up and watch  
[0:16:05](https://youtu.be/9I9GdSQ1bbM?t=965) for drop bears so the strangler fig  
[0:16:07](https://youtu.be/9I9GdSQ1bbM?t=967) pattern is very useful and it's  
[0:16:09](https://youtu.be/9I9GdSQ1bbM?t=969) surprisingly simple and bit but and and  
[0:16:12](https://youtu.be/9I9GdSQ1bbM?t=972) also can be used in so many different  
[0:16:14](https://youtu.be/9I9GdSQ1bbM?t=974) contexts the way it kind of works is we  
[0:16:17](https://youtu.be/9I9GdSQ1bbM?t=977) just wrap something new around the old  
[0:16:19](https://youtu.be/9I9GdSQ1bbM?t=979) system what we're really doing is we're  
[0:16:21](https://youtu.be/9I9GdSQ1bbM?t=981) intercepting calls to the old piece of  
[0:16:24](https://youtu.be/9I9GdSQ1bbM?t=984) functionality and diverting it to where  
[0:16:26](https://youtu.be/9I9GdSQ1bbM?t=986) the new functionality exists this has a  
[0:16:28](https://youtu.be/9I9GdSQ1bbM?t=988) nice padded property that the existing  
[0:16:31](https://youtu.be/9I9GdSQ1bbM?t=991) monastic system effectively remains  
[0:16:32](https://youtu.be/9I9GdSQ1bbM?t=992) unchanged well functionality hasn't been  
[0:16:35](https://youtu.be/9I9GdSQ1bbM?t=995) migrated calls go to the old system as  
[0:16:38](https://youtu.be/9I9GdSQ1bbM?t=998) before there are some types of  
[0:16:40](https://youtu.be/9I9GdSQ1bbM?t=1000) architectures that make it extremely  
[0:16:42](https://youtu.be/9I9GdSQ1bbM?t=1002) easy to implement a classic example of  
[0:16:45](https://youtu.be/9I9GdSQ1bbM?t=1005) this would be something like a system  
[0:16:47](https://youtu.be/9I9GdSQ1bbM?t=1007) driven via HTTP so in this situation  
[0:16:50](https://youtu.be/9I9GdSQ1bbM?t=1010) here we have a mullah thick system which  
[0:16:52](https://youtu.be/9I9GdSQ1bbM?t=1012) is restricting calls from some upstream  
[0:16:54](https://youtu.be/9I9GdSQ1bbM?t=1014) source via the HTTP protocol HTTP works  
[0:16:58](https://youtu.be/9I9GdSQ1bbM?t=1018) really well here because it's very easy  
[0:17:00](https://youtu.be/9I9GdSQ1bbM?t=1020) to transparently intercept and read and  
[0:17:03](https://youtu.be/9I9GdSQ1bbM?t=1023) divert calls without the client really  
[0:17:05](https://youtu.be/9I9GdSQ1bbM?t=1025) needing to be aware of that so this  
[0:17:07](https://youtu.be/9I9GdSQ1bbM?t=1027) could be asked looking to intercept HTTP  
[0:17:10](https://youtu.be/9I9GdSQ1bbM?t=1030) calls underneath the user interface this  
[0:17:13](https://youtu.be/9I9GdSQ1bbM?t=1033) could be a headless application the  
[0:17:15](https://youtu.be/9I9GdSQ1bbM?t=1035) first thing we would do in this  
[0:17:16](https://youtu.be/9I9GdSQ1bbM?t=1036) situation is we either put a proxy in  
[0:17:18](https://youtu.be/9I9GdSQ1bbM?t=1038) place that proxy is going to sit between  
[0:17:21](https://youtu.be/9I9GdSQ1bbM?t=1041) our monolithic system and the upstream  
[0:17:23](https://youtu.be/9I9GdSQ1bbM?t=1043) services I would advocate your totnes  
[0:17:25](https://youtu.be/9I9GdSQ1bbM?t=1045) proxy in place and you deploy that proxy  
[0:17:28](https://youtu.be/9I9GdSQ1bbM?t=1048) into production and you do nothing else  
[0:17:30](https://youtu.be/9I9GdSQ1bbM?t=1050) at this point it will just be doing  
[0:17:32](https://youtu.be/9I9GdSQ1bbM?t=1052) pass-through calls the reason for doing  
[0:17:34](https://youtu.be/9I9GdSQ1bbM?t=1054) this when we're moving to a Mike  
[0:17:35](https://youtu.be/9I9GdSQ1bbM?t=1055) reservist architecture we are adding  
[0:17:37](https://youtu.be/9I9GdSQ1bbM?t=1057) Network hops Network hops add latency  
[0:17:40](https://youtu.be/9I9GdSQ1bbM?t=1060) it's a good idea to find out how bad  
[0:17:42](https://youtu.be/9I9GdSQ1bbM?t=1062) your network is quite early on in this  
[0:17:44](https://youtu.be/9I9GdSQ1bbM?t=1064) process if you find that sticking your  
[0:17:47](https://youtu.be/9I9GdSQ1bbM?t=1067) network  
[0:17:47](https://youtu.be/9I9GdSQ1bbM?t=1067) proxy in between just your upstream of  
[0:17:50](https://youtu.be/9I9GdSQ1bbM?t=1070) your downstream service and you know 400  
[0:17:52](https://youtu.be/9I9GdSQ1bbM?t=1072) milliseconds of latency your network  
[0:17:55](https://youtu.be/9I9GdSQ1bbM?t=1075) sucks and you need to get a better one  
[0:17:57](https://youtu.be/9I9GdSQ1bbM?t=1077) I remember in 2005 we spent it was a  
[0:17:59](https://youtu.be/9I9GdSQ1bbM?t=1079) banking client we spent ages tracking  
[0:18:02](https://youtu.be/9I9GdSQ1bbM?t=1082) down a performs bottleneck and to find  
[0:18:05](https://youtu.be/9I9GdSQ1bbM?t=1085) the all traffic between two servers in  
[0:18:07](https://youtu.be/9I9GdSQ1bbM?t=1087) the same data center in London were  
[0:18:09](https://youtu.be/9I9GdSQ1bbM?t=1089) being routed via Luxembourg that puts a  
[0:18:12](https://youtu.be/9I9GdSQ1bbM?t=1092) bit of a cramp on your day and if you do  
[0:18:14](https://youtu.be/9I9GdSQ1bbM?t=1094) have a network which does suffer from  
[0:18:16](https://youtu.be/9I9GdSQ1bbM?t=1096) issues like that it's good to find that  
[0:18:18](https://youtu.be/9I9GdSQ1bbM?t=1098) out early and this is also the thing  
[0:18:20](https://youtu.be/9I9GdSQ1bbM?t=1100) where even our incremental refactorings  
[0:18:22](https://youtu.be/9I9GdSQ1bbM?t=1102) can be broken down into a series of  
[0:18:24](https://youtu.be/9I9GdSQ1bbM?t=1104) smaller steps each of those steps can be  
[0:18:26](https://youtu.be/9I9GdSQ1bbM?t=1106) put into a production environment and  
[0:18:28](https://youtu.be/9I9GdSQ1bbM?t=1108) can be assessed so at this point we're  
[0:18:31](https://youtu.be/9I9GdSQ1bbM?t=1111) able to assess the impact of adding an  
[0:18:32](https://youtu.be/9I9GdSQ1bbM?t=1112) additional network hop  
[0:18:33](https://youtu.be/9I9GdSQ1bbM?t=1113) we've also of course got the proxy in  
[0:18:35](https://youtu.be/9I9GdSQ1bbM?t=1115) place to start intercepting our calls  
[0:18:37](https://youtu.be/9I9GdSQ1bbM?t=1117) now what you do is you start working on  
[0:18:39](https://youtu.be/9I9GdSQ1bbM?t=1119) your brand-new service you deploy that  
[0:18:41](https://youtu.be/9I9GdSQ1bbM?t=1121) service into a production environment  
[0:18:43](https://youtu.be/9I9GdSQ1bbM?t=1123) you test it in situ we can do this  
[0:18:46](https://youtu.be/9I9GdSQ1bbM?t=1126) because it is not released to our users  
[0:18:49](https://youtu.be/9I9GdSQ1bbM?t=1129) we've too often I think can bound  
[0:18:51](https://youtu.be/9I9GdSQ1bbM?t=1131) combine these two concepts together in  
[0:18:53](https://youtu.be/9I9GdSQ1bbM?t=1133) our heads the idea of deployment into a  
[0:18:56](https://youtu.be/9I9GdSQ1bbM?t=1136) production environment and relief of  
[0:18:58](https://youtu.be/9I9GdSQ1bbM?t=1138) that software to our users those are  
[0:19:01](https://youtu.be/9I9GdSQ1bbM?t=1141) actually two separate activities I can  
[0:19:03](https://youtu.be/9I9GdSQ1bbM?t=1143) deploy something without releasing it  
[0:19:05](https://youtu.be/9I9GdSQ1bbM?t=1145) when I hide something behind a feature  
[0:19:07](https://youtu.be/9I9GdSQ1bbM?t=1147) flag it is deployed but not released  
[0:19:09](https://youtu.be/9I9GdSQ1bbM?t=1149) from doing dark launching is deployed  
[0:19:12](https://youtu.be/9I9GdSQ1bbM?t=1152) but not released in this situation here  
[0:19:14](https://youtu.be/9I9GdSQ1bbM?t=1154) I'm deploying my service into production  
[0:19:16](https://youtu.be/9I9GdSQ1bbM?t=1156) I can make sure the deployment process  
[0:19:18](https://youtu.be/9I9GdSQ1bbM?t=1158) works I can test it in situ but it's a  
[0:19:20](https://youtu.be/9I9GdSQ1bbM?t=1160) safe operation because at this point no  
[0:19:22](https://youtu.be/9I9GdSQ1bbM?t=1162) calls have been diverted once I'm happy  
[0:19:25](https://youtu.be/9I9GdSQ1bbM?t=1165) that my new service is working properly  
[0:19:27](https://youtu.be/9I9GdSQ1bbM?t=1167) and I think it's ready to take the  
[0:19:28](https://youtu.be/9I9GdSQ1bbM?t=1168) traffic all I need to do is to change  
[0:19:31](https://youtu.be/9I9GdSQ1bbM?t=1171) configuration the proxy to divert calls  
[0:19:33](https://youtu.be/9I9GdSQ1bbM?t=1173) it used to go to the monolith over into  
[0:19:35](https://youtu.be/9I9GdSQ1bbM?t=1175) my new micro service architecture if I  
[0:19:37](https://youtu.be/9I9GdSQ1bbM?t=1177) have a problem it's a quick rollback  
[0:19:39](https://youtu.be/9I9GdSQ1bbM?t=1179) what I need to do is change my proxy  
[0:19:41](https://youtu.be/9I9GdSQ1bbM?t=1181) configuration we will have to talk about  
[0:19:44](https://youtu.be/9I9GdSQ1bbM?t=1184) state if you're going to potentially  
[0:19:46](https://youtu.be/9I9GdSQ1bbM?t=1186) have a city appear at a time where you  
[0:19:48](https://youtu.be/9I9GdSQ1bbM?t=1188) might want to flick back to actually  
[0:19:49](https://youtu.be/9I9GdSQ1bbM?t=1189) serving that functionality out of the  
[0:19:51](https://youtu.be/9I9GdSQ1bbM?t=1191) monolithic system and these and the  
[0:19:53](https://youtu.be/9I9GdSQ1bbM?t=1193) service you've created is needing to  
[0:19:55](https://youtu.be/9I9GdSQ1bbM?t=1195) store or a tree state from a database  
[0:19:57](https://youtu.be/9I9GdSQ1bbM?t=1197) that does mean for a short period of  
[0:19:58](https://youtu.be/9I9GdSQ1bbM?t=1198) time you would have  
[0:20:00](https://youtu.be/9I9GdSQ1bbM?t=1200) kote you both have to use an access the  
[0:20:02](https://youtu.be/9I9GdSQ1bbM?t=1202) same database during that migration  
[0:20:04](https://youtu.be/9I9GdSQ1bbM?t=1204) period but nonetheless it's an  
[0:20:06](https://youtu.be/9I9GdSQ1bbM?t=1206) incredible useful idea I've done  
[0:20:08](https://youtu.be/9I9GdSQ1bbM?t=1208) variations of this with user interfaces  
[0:20:10](https://youtu.be/9I9GdSQ1bbM?t=1210) and other protocols I chatted to a real  
[0:20:12](https://youtu.be/9I9GdSQ1bbM?t=1212) estate company in Zurich called home  
[0:20:14](https://youtu.be/9I9GdSQ1bbM?t=1214) gates who use a stronger patent but they  
[0:20:16](https://youtu.be/9I9GdSQ1bbM?t=1216) were intercepting FTP not HTTP calls  
[0:20:19](https://youtu.be/9I9GdSQ1bbM?t=1219) I've seen it done with message brokers I  
[0:20:21](https://youtu.be/9I9GdSQ1bbM?t=1221) think there's a lot of different ways to  
[0:20:23](https://youtu.be/9I9GdSQ1bbM?t=1223) make this pattern work one of the nice  
[0:20:25](https://youtu.be/9I9GdSQ1bbM?t=1225) things about this is that no point here  
[0:20:27](https://youtu.be/9I9GdSQ1bbM?t=1227) is the monolith aware that anything is  
[0:20:28](https://youtu.be/9I9GdSQ1bbM?t=1228) going on  
[0:20:29](https://youtu.be/9I9GdSQ1bbM?t=1229) so these sites of ideas can work very  
[0:20:31](https://youtu.be/9I9GdSQ1bbM?t=1231) well when you're looking to migrate  
[0:20:33](https://youtu.be/9I9GdSQ1bbM?t=1233) functionality away from existing black  
[0:20:35](https://youtu.be/9I9GdSQ1bbM?t=1235) box systems that you'd have no control  
[0:20:36](https://youtu.be/9I9GdSQ1bbM?t=1236) over this could also work well if you  
[0:20:38](https://youtu.be/9I9GdSQ1bbM?t=1238) didn't want to disturb the team looking  
[0:20:40](https://youtu.be/9I9GdSQ1bbM?t=1240) after the monolith you're doing  
[0:20:41](https://youtu.be/9I9GdSQ1bbM?t=1241) something maybe a refactoring around the  
[0:20:43](https://youtu.be/9I9GdSQ1bbM?t=1243) edge so that's quite useful when we  
[0:20:46](https://youtu.be/9I9GdSQ1bbM?t=1246) start looking inside our model if we  
[0:20:47](https://youtu.be/9I9GdSQ1bbM?t=1247) realize there's only certain pieces of  
[0:20:49](https://youtu.be/9I9GdSQ1bbM?t=1249) functionality it's likely to work for so  
[0:20:51](https://youtu.be/9I9GdSQ1bbM?t=1251) this is sort of showing the  
[0:20:52](https://youtu.be/9I9GdSQ1bbM?t=1252) relationships between bits of business  
[0:20:54](https://youtu.be/9I9GdSQ1bbM?t=1254) functionality inside our monolith we've  
[0:20:56](https://youtu.be/9I9GdSQ1bbM?t=1256) got a bit of a directive a cyclical  
[0:20:59](https://youtu.be/9I9GdSQ1bbM?t=1259) graph of dependencies this is the kind  
[0:21:01](https://youtu.be/9I9GdSQ1bbM?t=1261) of thing that would come out sort of  
[0:21:02](https://youtu.be/9I9GdSQ1bbM?t=1262) domain modeling exercise so these these  
[0:21:04](https://youtu.be/9I9GdSQ1bbM?t=1264) boxes they might represent your bounded  
[0:21:06](https://youtu.be/9I9GdSQ1bbM?t=1266) contexts for example and therefore all  
[0:21:08](https://youtu.be/9I9GdSQ1bbM?t=1268) your candidates for which things should  
[0:21:10](https://youtu.be/9I9GdSQ1bbM?t=1270) be a service and so if I'm looking at  
[0:21:13](https://youtu.be/9I9GdSQ1bbM?t=1273) something like say invoicing or order  
[0:21:16](https://youtu.be/9I9GdSQ1bbM?t=1276) management those things are likely going  
[0:21:18](https://youtu.be/9I9GdSQ1bbM?t=1278) to be higher up in my call stack it's a  
[0:21:21](https://youtu.be/9I9GdSQ1bbM?t=1281) bit easier to intercept those calls  
[0:21:22](https://youtu.be/9I9GdSQ1bbM?t=1282) coming in but if I take a look at  
[0:21:24](https://youtu.be/9I9GdSQ1bbM?t=1284) something say the ability to award  
[0:21:26](https://youtu.be/9I9GdSQ1bbM?t=1286) points for boarding making orders or  
[0:21:29](https://youtu.be/9I9GdSQ1bbM?t=1289) sending notifications to our customers  
[0:21:31](https://youtu.be/9I9GdSQ1bbM?t=1291) those are things which are deeper inside  
[0:21:33](https://youtu.be/9I9GdSQ1bbM?t=1293) our system there's not a call that comes  
[0:21:35](https://youtu.be/9I9GdSQ1bbM?t=1295) in that I can match that functionality  
[0:21:36](https://youtu.be/9I9GdSQ1bbM?t=1296) when I place an order receive a payment  
[0:21:39](https://youtu.be/9I9GdSQ1bbM?t=1299) as a side effect of those operations I  
[0:21:42](https://youtu.be/9I9GdSQ1bbM?t=1302) might send notifications so they thought  
[0:21:44](https://youtu.be/9I9GdSQ1bbM?t=1304) if I wanted to extract notifications  
[0:21:47](https://youtu.be/9I9GdSQ1bbM?t=1307) related functionality or loyalty related  
[0:21:49](https://youtu.be/9I9GdSQ1bbM?t=1309) function meows that monolith I'm gonna  
[0:21:51](https://youtu.be/9I9GdSQ1bbM?t=1311) have to get my hands dirty and go inside  
[0:21:52](https://youtu.be/9I9GdSQ1bbM?t=1312) the monolith and sort that out and this  
[0:21:55](https://youtu.be/9I9GdSQ1bbM?t=1315) is where another pattern comes in and  
[0:21:56](https://youtu.be/9I9GdSQ1bbM?t=1316) that's a pattern called branch by  
[0:21:58](https://youtu.be/9I9GdSQ1bbM?t=1318) abstraction now this pattern is  
[0:22:00](https://youtu.be/9I9GdSQ1bbM?t=1320) something you might know of if you've  
[0:22:01](https://youtu.be/9I9GdSQ1bbM?t=1321) done any trunk based development is very  
[0:22:03](https://youtu.be/9I9GdSQ1bbM?t=1323) useful in that context but it's also  
[0:22:05](https://youtu.be/9I9GdSQ1bbM?t=1325) incredibly useful for micro service  
[0:22:07](https://youtu.be/9I9GdSQ1bbM?t=1327) migrations because it gives us a safe  
[0:22:09](https://youtu.be/9I9GdSQ1bbM?t=1329) way to  
[0:22:10](https://youtu.be/9I9GdSQ1bbM?t=1330) factor critical code paths in a way that  
[0:22:12](https://youtu.be/9I9GdSQ1bbM?t=1332) can also be verified we'll come back to  
[0:22:14](https://youtu.be/9I9GdSQ1bbM?t=1334) that verification a bit later on so the  
[0:22:17](https://youtu.be/9I9GdSQ1bbM?t=1337) way this works is we need to create an  
[0:22:19](https://youtu.be/9I9GdSQ1bbM?t=1339) abstraction over the current  
[0:22:21](https://youtu.be/9I9GdSQ1bbM?t=1341) functionality the functionality you're  
[0:22:23](https://youtu.be/9I9GdSQ1bbM?t=1343) trying to move you need to basically get  
[0:22:25](https://youtu.be/9I9GdSQ1bbM?t=1345) all that functionality in a box put it  
[0:22:27](https://youtu.be/9I9GdSQ1bbM?t=1347) in the box still a bit of refactoring  
[0:22:28](https://youtu.be/9I9GdSQ1bbM?t=1348) and so you know you start looking around  
[0:22:30](https://youtu.be/9I9GdSQ1bbM?t=1350) and get all the notifications  
[0:22:31](https://youtu.be/9I9GdSQ1bbM?t=1351) functionality and now I've got a  
[0:22:32](https://youtu.be/9I9GdSQ1bbM?t=1352) notifications class that's easy and I  
[0:22:35](https://youtu.be/9I9GdSQ1bbM?t=1355) changed the existing functionality to  
[0:22:37](https://youtu.be/9I9GdSQ1bbM?t=1357) use that class so this is just a good  
[0:22:39](https://youtu.be/9I9GdSQ1bbM?t=1359) bit of creating a nice abstraction and  
[0:22:41](https://youtu.be/9I9GdSQ1bbM?t=1361) then create an abstraction point which  
[0:22:44](https://youtu.be/9I9GdSQ1bbM?t=1364) would allow me to toggle between  
[0:22:45](https://youtu.be/9I9GdSQ1bbM?t=1365) implementations this is what's known as  
[0:22:47](https://youtu.be/9I9GdSQ1bbM?t=1367) an interface in an object-oriented  
[0:22:48](https://youtu.be/9I9GdSQ1bbM?t=1368) system so at this point the sisters  
[0:22:51](https://youtu.be/9I9GdSQ1bbM?t=1371) would be a safe refactoring to do most  
[0:22:53](https://youtu.be/9I9GdSQ1bbM?t=1373) of you probably are using languages that  
[0:22:56](https://youtu.be/9I9GdSQ1bbM?t=1376) give you a refactoring browser just  
[0:22:58](https://youtu.be/9I9GdSQ1bbM?t=1378) creating a new abstraction point over an  
[0:23:01](https://youtu.be/9I9GdSQ1bbM?t=1381) existing bit of functionality this is an  
[0:23:03](https://youtu.be/9I9GdSQ1bbM?t=1383) easy refactoring to do and at this point  
[0:23:05](https://youtu.be/9I9GdSQ1bbM?t=1385) nothing's got exciting you can be  
[0:23:07](https://youtu.be/9I9GdSQ1bbM?t=1387) chipping away at this over a period of a  
[0:23:09](https://youtu.be/9I9GdSQ1bbM?t=1389) few days while you're doing other things  
[0:23:11](https://youtu.be/9I9GdSQ1bbM?t=1391) what this is now giving us is a point at  
[0:23:13](https://youtu.be/9I9GdSQ1bbM?t=1393) which we could swap in an alternative  
[0:23:15](https://youtu.be/9I9GdSQ1bbM?t=1395) implementation of our notifications  
[0:23:18](https://youtu.be/9I9GdSQ1bbM?t=1398) functionality but we could do that  
[0:23:19](https://youtu.be/9I9GdSQ1bbM?t=1399) inside the same running system the  
[0:23:22](https://youtu.be/9I9GdSQ1bbM?t=1402) reason is patents called branch by  
[0:23:23](https://youtu.be/9I9GdSQ1bbM?t=1403) abstraction is it's really being  
[0:23:25](https://youtu.be/9I9GdSQ1bbM?t=1405) compared to the normal way we would  
[0:23:27](https://youtu.be/9I9GdSQ1bbM?t=1407) handle this  
[0:23:27](https://youtu.be/9I9GdSQ1bbM?t=1407) which is potentially doing is  
[0:23:28](https://youtu.be/9I9GdSQ1bbM?t=1408) refactoring in a different source code  
[0:23:30](https://youtu.be/9I9GdSQ1bbM?t=1410) branch the issue is that denies as a  
[0:23:33](https://youtu.be/9I9GdSQ1bbM?t=1413) whole load of interesting possibilities  
[0:23:35](https://youtu.be/9I9GdSQ1bbM?t=1415) when it comes to how we roll this  
[0:23:36](https://youtu.be/9I9GdSQ1bbM?t=1416) functionality out also merging so this  
[0:23:40](https://youtu.be/9I9GdSQ1bbM?t=1420) is actually a much smarter technique for  
[0:23:42](https://youtu.be/9I9GdSQ1bbM?t=1422) these kinds of situations so we've got  
[0:23:45](https://youtu.be/9I9GdSQ1bbM?t=1425) our extraction point this is easy the  
[0:23:46](https://youtu.be/9I9GdSQ1bbM?t=1426) next thing we're going to do is we can  
[0:23:47](https://youtu.be/9I9GdSQ1bbM?t=1427) start working on our brand-new service  
[0:23:50](https://youtu.be/9I9GdSQ1bbM?t=1430) implementation and this is going to be a  
[0:23:52](https://youtu.be/9I9GdSQ1bbM?t=1432) nice news notification service that's  
[0:23:54](https://youtu.be/9I9GdSQ1bbM?t=1434) going to receive requests the  
[0:23:56](https://youtu.be/9I9GdSQ1bbM?t=1436) functionality that used to be inside our  
[0:23:59](https://youtu.be/9I9GdSQ1bbM?t=1439) monolith has been copied into that  
[0:24:01](https://youtu.be/9I9GdSQ1bbM?t=1441) notification service assuming we can do  
[0:24:03](https://youtu.be/9I9GdSQ1bbM?t=1443) a straight copy and paste that service  
[0:24:06](https://youtu.be/9I9GdSQ1bbM?t=1446) calling implementation there is  
[0:24:07](https://youtu.be/9I9GdSQ1bbM?t=1447) effectively just going to be client code  
[0:24:09](https://youtu.be/9I9GdSQ1bbM?t=1449) inside the monolith it's going to call  
[0:24:11](https://youtu.be/9I9GdSQ1bbM?t=1451) out to our service and that service  
[0:24:13](https://youtu.be/9I9GdSQ1bbM?t=1453) coding implementation is going to  
[0:24:15](https://youtu.be/9I9GdSQ1bbM?t=1455) implement the same interface it is  
[0:24:17](https://youtu.be/9I9GdSQ1bbM?t=1457) checked in it is deployed into  
[0:24:19](https://youtu.be/9I9GdSQ1bbM?t=1459) production but again it is deployed but  
[0:24:21](https://youtu.be/9I9GdSQ1bbM?t=1461) not really  
[0:24:22](https://youtu.be/9I9GdSQ1bbM?t=1462) because the implementation of the  
[0:24:24](https://youtu.be/9I9GdSQ1bbM?t=1464) abstraction we're using is the existing  
[0:24:26](https://youtu.be/9I9GdSQ1bbM?t=1466) functionality when we're ready and we  
[0:24:29](https://youtu.be/9I9GdSQ1bbM?t=1469) think you know what our new  
[0:24:30](https://youtu.be/9I9GdSQ1bbM?t=1470) functionality is working well and you  
[0:24:31](https://youtu.be/9I9GdSQ1bbM?t=1471) know how I've been able to test it  
[0:24:32](https://youtu.be/9I9GdSQ1bbM?t=1472) because we've been able to test it in  
[0:24:34](https://youtu.be/9I9GdSQ1bbM?t=1474) production because we've been deploying  
[0:24:35](https://youtu.be/9I9GdSQ1bbM?t=1475) on notification service in production we  
[0:24:39](https://youtu.be/9I9GdSQ1bbM?t=1479) can switch it over and that again is a  
[0:24:40](https://youtu.be/9I9GdSQ1bbM?t=1480) simple use for feature flag so now the  
[0:24:43](https://youtu.be/9I9GdSQ1bbM?t=1483) implementation of the interface we're  
[0:24:45](https://youtu.be/9I9GdSQ1bbM?t=1485) using is our new service calling  
[0:24:46](https://youtu.be/9I9GdSQ1bbM?t=1486) implementation if that works everyone is  
[0:24:49](https://youtu.be/9I9GdSQ1bbM?t=1489) happy and low there was much rejoicing  
[0:24:51](https://youtu.be/9I9GdSQ1bbM?t=1491) and then you can gob viously clean up  
[0:24:54](https://youtu.be/9I9GdSQ1bbM?t=1494) the feature flag after a period of  
[0:24:55](https://youtu.be/9I9GdSQ1bbM?t=1495) several weeks so once you feel that you  
[0:24:57](https://youtu.be/9I9GdSQ1bbM?t=1497) don't want the option to be able to  
[0:24:58](https://youtu.be/9I9GdSQ1bbM?t=1498) switch it back cleanly you can then do  
[0:25:01](https://youtu.be/9I9GdSQ1bbM?t=1501) is if you want to remove the feature  
[0:25:02](https://youtu.be/9I9GdSQ1bbM?t=1502) flag and potentially even remove the  
[0:25:05](https://youtu.be/9I9GdSQ1bbM?t=1505) abstraction point and the old  
[0:25:07](https://youtu.be/9I9GdSQ1bbM?t=1507) implementation there by cleaning up the  
[0:25:08](https://youtu.be/9I9GdSQ1bbM?t=1508) code base nice thing about having both  
[0:25:12](https://youtu.be/9I9GdSQ1bbM?t=1512) implementations in there is it opens up  
[0:25:13](https://youtu.be/9I9GdSQ1bbM?t=1513) the possibility of us doing things like  
[0:25:15](https://youtu.be/9I9GdSQ1bbM?t=1515) dark launching and parallel runs which  
[0:25:18](https://youtu.be/9I9GdSQ1bbM?t=1518) is a really interesting techniques all  
[0:25:19](https://youtu.be/9I9GdSQ1bbM?t=1519) right before I forget if you want to do  
[0:25:21](https://youtu.be/9I9GdSQ1bbM?t=1521) that little refactoring before we get to  
[0:25:23](https://youtu.be/9I9GdSQ1bbM?t=1523) the service a bit there's a really good  
[0:25:24](https://youtu.be/9I9GdSQ1bbM?t=1524) book by Michael feathers called working  
[0:25:26](https://youtu.be/9I9GdSQ1bbM?t=1526) effectively with monolith code which I'm  
[0:25:29](https://youtu.be/9I9GdSQ1bbM?t=1529) going to get Michael to rename it so he  
[0:25:30](https://youtu.be/9I9GdSQ1bbM?t=1530) can jump on the same bang banking that  
[0:25:32](https://youtu.be/9I9GdSQ1bbM?t=1532) I'd be riding the last ten years but  
[0:25:34](https://youtu.be/9I9GdSQ1bbM?t=1534) this is a great book about how to  
[0:25:35](https://youtu.be/9I9GdSQ1bbM?t=1535) refactor existing systems he talks a lot  
[0:25:37](https://youtu.be/9I9GdSQ1bbM?t=1537) about how we identify seems encapsulate  
[0:25:40](https://youtu.be/9I9GdSQ1bbM?t=1540) code safely inside those seams and  
[0:25:43](https://youtu.be/9I9GdSQ1bbM?t=1543) making you know and how we can add tests  
[0:25:44](https://youtu.be/9I9GdSQ1bbM?t=1544) to do that operation in a really nice  
[0:25:47](https://youtu.be/9I9GdSQ1bbM?t=1547) managed way there's different versions  
[0:25:49](https://youtu.be/9I9GdSQ1bbM?t=1549) of the code examples of his book for  
[0:25:51](https://youtu.be/9I9GdSQ1bbM?t=1551) different languages as well if we can  
[0:25:54](https://youtu.be/9I9GdSQ1bbM?t=1554) implement both implementations of our  
[0:25:56](https://youtu.be/9I9GdSQ1bbM?t=1556) notifications functionality inside the  
[0:25:59](https://youtu.be/9I9GdSQ1bbM?t=1559) same monolith at the same time it allows  
[0:26:01](https://youtu.be/9I9GdSQ1bbM?t=1561) it to do something like a parallel run  
[0:26:03](https://youtu.be/9I9GdSQ1bbM?t=1563) with a parallel run when a call comes in  
[0:26:05](https://youtu.be/9I9GdSQ1bbM?t=1565) to implement that piece of functionality  
[0:26:07](https://youtu.be/9I9GdSQ1bbM?t=1567) we actually can dispatch that  
[0:26:08](https://youtu.be/9I9GdSQ1bbM?t=1568) functionality to both implementations  
[0:26:11](https://youtu.be/9I9GdSQ1bbM?t=1571) this might look a bit odd but what we're  
[0:26:13](https://youtu.be/9I9GdSQ1bbM?t=1573) basically doing here is these patterns  
[0:26:15](https://youtu.be/9I9GdSQ1bbM?t=1575) are architectural refactoring patterns a  
[0:26:18](https://youtu.be/9I9GdSQ1bbM?t=1578) refactoring is something where we change  
[0:26:20](https://youtu.be/9I9GdSQ1bbM?t=1580) the structure of the code but we don't  
[0:26:22](https://youtu.be/9I9GdSQ1bbM?t=1582) want to change the behavior of the code  
[0:26:24](https://youtu.be/9I9GdSQ1bbM?t=1584) we want to be able to verify that the  
[0:26:26](https://youtu.be/9I9GdSQ1bbM?t=1586) system is still functionally the same as  
[0:26:28](https://youtu.be/9I9GdSQ1bbM?t=1588) it was before but we've now got an  
[0:26:30](https://youtu.be/9I9GdSQ1bbM?t=1590) architecture the let's do other things  
[0:26:32](https://youtu.be/9I9GdSQ1bbM?t=1592) so how do we make sure it's function  
[0:26:34](https://youtu.be/9I9GdSQ1bbM?t=1594) equivalent we'll do a comparison and if  
[0:26:37](https://youtu.be/9I9GdSQ1bbM?t=1597) we can coexist both implementations we  
[0:26:39](https://youtu.be/9I9GdSQ1bbM?t=1599) can do a live comparison so in this  
[0:26:42](https://youtu.be/9I9GdSQ1bbM?t=1602) situation a call that comes in with cool  
[0:26:44](https://youtu.be/9I9GdSQ1bbM?t=1604) both existing implementation and the  
[0:26:46](https://youtu.be/9I9GdSQ1bbM?t=1606) brand new service calling implementation  
[0:26:48](https://youtu.be/9I9GdSQ1bbM?t=1608) will be able to verify whether or not we  
[0:26:50](https://youtu.be/9I9GdSQ1bbM?t=1610) get the same answers we can also verify  
[0:26:52](https://youtu.be/9I9GdSQ1bbM?t=1612) whether or not the brand new service  
[0:26:54](https://youtu.be/9I9GdSQ1bbM?t=1614) according implementation responds  
[0:26:56](https://youtu.be/9I9GdSQ1bbM?t=1616) quickly enough and this can allow us to  
[0:26:58](https://youtu.be/9I9GdSQ1bbM?t=1618) actually sort of say well actually we  
[0:27:00](https://youtu.be/9I9GdSQ1bbM?t=1620) are executing both pathways it seems to  
[0:27:02](https://youtu.be/9I9GdSQ1bbM?t=1622) be behaving fine okay now we're ready to  
[0:27:04](https://youtu.be/9I9GdSQ1bbM?t=1624) switch over during this period normally  
[0:27:06](https://youtu.be/9I9GdSQ1bbM?t=1626) the existing implementation would kind  
[0:27:08](https://youtu.be/9I9GdSQ1bbM?t=1628) of be the source of truth in terms of  
[0:27:10](https://youtu.be/9I9GdSQ1bbM?t=1630) which results you actually would keep on  
[0:27:12](https://youtu.be/9I9GdSQ1bbM?t=1632) going forward this is an incredibly  
[0:27:14](https://youtu.be/9I9GdSQ1bbM?t=1634) useful technique a github actually uses  
[0:27:17](https://youtu.be/9I9GdSQ1bbM?t=1637) technique a lot into it when they've  
[0:27:19](https://youtu.be/9I9GdSQ1bbM?t=1639) been restructuring their Ruby code bases  
[0:27:21](https://youtu.be/9I9GdSQ1bbM?t=1641) but actually created a tool called  
[0:27:22](https://youtu.be/9I9GdSQ1bbM?t=1642) github scientist which is a library for  
[0:27:25](https://youtu.be/9I9GdSQ1bbM?t=1645) managing these parallel run situations  
[0:27:27](https://youtu.be/9I9GdSQ1bbM?t=1647) allowing you to run two implementations  
[0:27:29](https://youtu.be/9I9GdSQ1bbM?t=1649) of the code and actually set up sort of  
[0:27:31](https://youtu.be/9I9GdSQ1bbM?t=1651) like a scoring system say is the new  
[0:27:34](https://youtu.be/9I9GdSQ1bbM?t=1654) implementation working appropriately  
[0:27:35](https://youtu.be/9I9GdSQ1bbM?t=1655) this is written for Ruby but there's a  
[0:27:37](https://youtu.be/9I9GdSQ1bbM?t=1657) whole load of ports for different  
[0:27:39](https://youtu.be/9I9GdSQ1bbM?t=1659) languages right now it's there's a lot  
[0:27:42](https://youtu.be/9I9GdSQ1bbM?t=1662) of Perl ones there that's really hard  
[0:27:44](https://youtu.be/9I9GdSQ1bbM?t=1664) anyway I didn't realize that was still a  
[0:27:47](https://youtu.be/9I9GdSQ1bbM?t=1667) thing but it is still a thing and it's  
[0:27:48](https://youtu.be/9I9GdSQ1bbM?t=1668) got scientist ports for it now this is  
[0:27:50](https://youtu.be/9I9GdSQ1bbM?t=1670) quite useful okay so we can now run  
[0:27:52](https://youtu.be/9I9GdSQ1bbM?t=1672) these things side by side again not some  
[0:27:54](https://youtu.be/9I9GdSQ1bbM?t=1674) only something we can do because of that  
[0:27:56](https://youtu.be/9I9GdSQ1bbM?t=1676) branch by abstraction pattern plus it  
[0:27:58](https://youtu.be/9I9GdSQ1bbM?t=1678) also means we get to use trunk based  
[0:27:59](https://youtu.be/9I9GdSQ1bbM?t=1679) development which means everyone's going  
[0:28:01](https://youtu.be/9I9GdSQ1bbM?t=1681) to be happier so that's good down with  
[0:28:03](https://youtu.be/9I9GdSQ1bbM?t=1683) branches I have sides that the data  
[0:28:07](https://youtu.be/9I9GdSQ1bbM?t=1687) question and we need to talk about data  
[0:28:08](https://youtu.be/9I9GdSQ1bbM?t=1688) very briefly with our normal monolithic  
[0:28:11](https://youtu.be/9I9GdSQ1bbM?t=1691) system we have all of our data in a  
[0:28:12](https://youtu.be/9I9GdSQ1bbM?t=1692) database I've extracted out my new  
[0:28:15](https://youtu.be/9I9GdSQ1bbM?t=1695) functionality from my monolith but my  
[0:28:18](https://youtu.be/9I9GdSQ1bbM?t=1698) invoicing service needs to access data  
[0:28:20](https://youtu.be/9I9GdSQ1bbM?t=1700) so the question is what should I do in a  
[0:28:23](https://youtu.be/9I9GdSQ1bbM?t=1703) situation now when we're looking at  
[0:28:26](https://youtu.be/9I9GdSQ1bbM?t=1706) situations where we may want to switch  
[0:28:28](https://youtu.be/9I9GdSQ1bbM?t=1708) which functionality is live either the  
[0:28:30](https://youtu.be/9I9GdSQ1bbM?t=1710) invoicing functionality in the monolith  
[0:28:32](https://youtu.be/9I9GdSQ1bbM?t=1712) versus the invoicing functionality in  
[0:28:34](https://youtu.be/9I9GdSQ1bbM?t=1714) our new invoicing service we're in that  
[0:28:36](https://youtu.be/9I9GdSQ1bbM?t=1716) state where we're switching between it  
[0:28:38](https://youtu.be/9I9GdSQ1bbM?t=1718) it's sort of quite appropriate to just  
[0:28:40](https://youtu.be/9I9GdSQ1bbM?t=1720) sort of for a short period of time to  
[0:28:43](https://youtu.be/9I9GdSQ1bbM?t=1723) just access the same database once  
[0:28:45](https://youtu.be/9I9GdSQ1bbM?t=1725) you've decided though that actually know  
[0:28:47](https://youtu.be/9I9GdSQ1bbM?t=1727) the  
[0:28:47](https://youtu.be/9I9GdSQ1bbM?t=1727) invoicing service is now where  
[0:28:49](https://youtu.be/9I9GdSQ1bbM?t=1729) dysfunctionality is going to live we  
[0:28:51](https://youtu.be/9I9GdSQ1bbM?t=1731) need to avoid this direct database  
[0:28:52](https://youtu.be/9I9GdSQ1bbM?t=1732) connection because that's going to be an  
[0:28:54](https://youtu.be/9I9GdSQ1bbM?t=1734) ongoing source of coupling you know as  
[0:28:57](https://youtu.be/9I9GdSQ1bbM?t=1737) we all know if any of you spent any time  
[0:28:58](https://youtu.be/9I9GdSQ1bbM?t=1738) looking to micro services menu you know  
[0:29:01](https://youtu.be/9I9GdSQ1bbM?t=1741) virtually everybody will say don't share  
[0:29:04](https://youtu.be/9I9GdSQ1bbM?t=1744) databases and there's a really good  
[0:29:05](https://youtu.be/9I9GdSQ1bbM?t=1745) reason behind that so that isn't like  
[0:29:07](https://youtu.be/9I9GdSQ1bbM?t=1747) doing this but for short periods of time  
[0:29:09](https://youtu.be/9I9GdSQ1bbM?t=1749) as a migration technique it's ok as long  
[0:29:12](https://youtu.be/9I9GdSQ1bbM?t=1752) as you kind of you're doing this for  
[0:29:13](https://youtu.be/9I9GdSQ1bbM?t=1753) like a few weeks just to just know in  
[0:29:15](https://youtu.be/9I9GdSQ1bbM?t=1755) your head you haven't actually finished  
[0:29:17](https://youtu.be/9I9GdSQ1bbM?t=1757) extracting that invoicing service  
[0:29:18](https://youtu.be/9I9GdSQ1bbM?t=1758) because you're still showing a database  
[0:29:20](https://youtu.be/9I9GdSQ1bbM?t=1760) so until we've dealt with that situation  
[0:29:22](https://youtu.be/9I9GdSQ1bbM?t=1762) your extraction is not complete so we  
[0:29:26](https://youtu.be/9I9GdSQ1bbM?t=1766) then need to think about is ok with I  
[0:29:28](https://youtu.be/9I9GdSQ1bbM?t=1768) can't do this what are the kind of  
[0:29:29](https://youtu.be/9I9GdSQ1bbM?t=1769) scenarios well the first thing is to  
[0:29:32](https://youtu.be/9I9GdSQ1bbM?t=1772) think about is well what is the data I'm  
[0:29:34](https://youtu.be/9I9GdSQ1bbM?t=1774) trying to access so if the data I'm  
[0:29:36](https://youtu.be/9I9GdSQ1bbM?t=1776) trying to access is data that I don't  
[0:29:38](https://youtu.be/9I9GdSQ1bbM?t=1778) really own like it's non invoice related  
[0:29:41](https://youtu.be/9I9GdSQ1bbM?t=1781) data but data I need to be aware of for  
[0:29:44](https://youtu.be/9I9GdSQ1bbM?t=1784) example I might need to look up a  
[0:29:46](https://youtu.be/9I9GdSQ1bbM?t=1786) customer details or information about an  
[0:29:48](https://youtu.be/9I9GdSQ1bbM?t=1788) order that data and the processes that  
[0:29:51](https://youtu.be/9I9GdSQ1bbM?t=1791) manage that data that's all still inside  
[0:29:54](https://youtu.be/9I9GdSQ1bbM?t=1794) the monolithic system in that situation  
[0:29:55](https://youtu.be/9I9GdSQ1bbM?t=1795) is completely appropriate for our brand  
[0:29:58](https://youtu.be/9I9GdSQ1bbM?t=1798) new service to go to the monolith and  
[0:30:00](https://youtu.be/9I9GdSQ1bbM?t=1800) ask so in this situation we expose some  
[0:30:02](https://youtu.be/9I9GdSQ1bbM?t=1802) kind of content service interface in  
[0:30:04](https://youtu.be/9I9GdSQ1bbM?t=1804) this example here have made that an API  
[0:30:06](https://youtu.be/9I9GdSQ1bbM?t=1806) so I go fetch the information I want  
[0:30:09](https://youtu.be/9I9GdSQ1bbM?t=1809) I've avoided direct database access by  
[0:30:11](https://youtu.be/9I9GdSQ1bbM?t=1811) creating its API I'm allowing myself the  
[0:30:14](https://youtu.be/9I9GdSQ1bbM?t=1814) ability to decide what is shared and  
[0:30:16](https://youtu.be/9I9GdSQ1bbM?t=1816) what is hidden now if the data you want  
[0:30:20](https://youtu.be/9I9GdSQ1bbM?t=1820) is really data that you should own we  
[0:30:22](https://youtu.be/9I9GdSQ1bbM?t=1822) need to invert this relationship in that  
[0:30:25](https://youtu.be/9I9GdSQ1bbM?t=1825) situation we need to grab that data are  
[0:30:27](https://youtu.be/9I9GdSQ1bbM?t=1827) skipping this we need to grab that data  
[0:30:29](https://youtu.be/9I9GdSQ1bbM?t=1829) from the monolithic system to me  
[0:30:33](https://youtu.be/9I9GdSQ1bbM?t=1833) transitions and pull that data over into  
[0:30:35](https://youtu.be/9I9GdSQ1bbM?t=1835) our schema into our world  
[0:30:37](https://youtu.be/9I9GdSQ1bbM?t=1837) so we now want to own and manage that  
[0:30:40](https://youtu.be/9I9GdSQ1bbM?t=1840) data it is ours we should now be the  
[0:30:42](https://youtu.be/9I9GdSQ1bbM?t=1842) source of truth for this data  
[0:30:44](https://youtu.be/9I9GdSQ1bbM?t=1844) the monolith of course needs invoicing  
[0:30:46](https://youtu.be/9I9GdSQ1bbM?t=1846) data so it now needs to come and talk to  
[0:30:48](https://youtu.be/9I9GdSQ1bbM?t=1848) our brand-new service so it's honey you  
[0:30:51](https://youtu.be/9I9GdSQ1bbM?t=1851) got to decide when you're putting a  
[0:30:52](https://youtu.be/9I9GdSQ1bbM?t=1852) service out what data do you need some  
[0:30:55](https://youtu.be/9I9GdSQ1bbM?t=1855) data is yours and that should come with  
[0:30:56](https://youtu.be/9I9GdSQ1bbM?t=1856) you some data should stay where it is  
[0:30:59](https://youtu.be/9I9GdSQ1bbM?t=1859) and then you  
[0:30:59](https://youtu.be/9I9GdSQ1bbM?t=1859) user well defined API the the kind of  
[0:31:02](https://youtu.be/9I9GdSQ1bbM?t=1862) difficult situation is sometimes with  
[0:31:03](https://youtu.be/9I9GdSQ1bbM?t=1863) these monoliths you can sometimes end up  
[0:31:05](https://youtu.be/9I9GdSQ1bbM?t=1865) a situation whether the - depends on you  
[0:31:06](https://youtu.be/9I9GdSQ1bbM?t=1866) and you depend on the monolith and then  
[0:31:07](https://youtu.be/9I9GdSQ1bbM?t=1867) things get a bit hairy but you know I  
[0:31:10](https://youtu.be/9I9GdSQ1bbM?t=1870) can only cover so much stuff in this  
[0:31:12](https://youtu.be/9I9GdSQ1bbM?t=1872) talk so let's go a bit deeper into this  
[0:31:15](https://youtu.be/9I9GdSQ1bbM?t=1875) idea of moving data because just that  
[0:31:17](https://youtu.be/9I9GdSQ1bbM?t=1877) transition is quite nice look they're  
[0:31:19](https://youtu.be/9I9GdSQ1bbM?t=1879) just all did I made a box appear and  
[0:31:20](https://youtu.be/9I9GdSQ1bbM?t=1880) then the Box traveled across the system  
[0:31:23](https://youtu.be/9I9GdSQ1bbM?t=1883) and I knew if I was being mean I could  
[0:31:25](https://youtu.be/9I9GdSQ1bbM?t=1885) say and that's how you do dates  
[0:31:26](https://youtu.be/9I9GdSQ1bbM?t=1886) basically fracturing which of course is  
[0:31:28](https://youtu.be/9I9GdSQ1bbM?t=1888) hiding a lot of information and detail  
[0:31:30](https://youtu.be/9I9GdSQ1bbM?t=1890) so we all talked about a couple of show  
[0:31:33](https://youtu.be/9I9GdSQ1bbM?t=1893) a couple of examples of database  
[0:31:34](https://youtu.be/9I9GdSQ1bbM?t=1894) refactorings now the first thing I'd say  
[0:31:37](https://youtu.be/9I9GdSQ1bbM?t=1897) when we look at database refactoring is  
[0:31:39](https://youtu.be/9I9GdSQ1bbM?t=1899) do take a look at this book by Scott  
[0:31:41](https://youtu.be/9I9GdSQ1bbM?t=1901) Ambler and promote ah glad you're still  
[0:31:43](https://youtu.be/9I9GdSQ1bbM?t=1903) it's probably a little bit old now but  
[0:31:45](https://youtu.be/9I9GdSQ1bbM?t=1905) this is for database refactoring what  
[0:31:47](https://youtu.be/9I9GdSQ1bbM?t=1907) Martin's book we fracturing is full code  
[0:31:48](https://youtu.be/9I9GdSQ1bbM?t=1908) refactoring so this is talking about the  
[0:31:50](https://youtu.be/9I9GdSQ1bbM?t=1910) low-level patterns of how you refactor a  
[0:31:53](https://youtu.be/9I9GdSQ1bbM?t=1913) relational database  
[0:31:55](https://youtu.be/9I9GdSQ1bbM?t=1915) most of the stuff I'm talking about here  
[0:31:57](https://youtu.be/9I9GdSQ1bbM?t=1917) and I talked about in the book are for  
[0:31:58](https://youtu.be/9I9GdSQ1bbM?t=1918) refactoring relational databases because  
[0:32:00](https://youtu.be/9I9GdSQ1bbM?t=1920) in many ways they have more challenges  
[0:32:02](https://youtu.be/9I9GdSQ1bbM?t=1922) in this space but a lot of these  
[0:32:04](https://youtu.be/9I9GdSQ1bbM?t=1924) techniques work just as well for other  
[0:32:05](https://youtu.be/9I9GdSQ1bbM?t=1925) types of non relational databases  
[0:32:07](https://youtu.be/9I9GdSQ1bbM?t=1927) the other thing you're going to want as  
[0:32:09](https://youtu.be/9I9GdSQ1bbM?t=1929) if you're doing this work is some kind  
[0:32:11](https://youtu.be/9I9GdSQ1bbM?t=1931) of tool chain that allows you to make  
[0:32:13](https://youtu.be/9I9GdSQ1bbM?t=1933) incremental changes to databases allows  
[0:32:17](https://youtu.be/9I9GdSQ1bbM?t=1937) you to version control those changes and  
[0:32:19](https://youtu.be/9I9GdSQ1bbM?t=1939) run them in a deterministic fashion an  
[0:32:21](https://youtu.be/9I9GdSQ1bbM?t=1941) example tool would be something like  
[0:32:23](https://youtu.be/9I9GdSQ1bbM?t=1943) Flyway DB the Flyway D bees excellent  
[0:32:26](https://youtu.be/9I9GdSQ1bbM?t=1946) for doing this there are other similar  
[0:32:27](https://youtu.be/9I9GdSQ1bbM?t=1947) tool chains for different languages by a  
[0:32:29](https://youtu.be/9I9GdSQ1bbM?t=1949) much much more hesitant about the use of  
[0:32:32](https://youtu.be/9I9GdSQ1bbM?t=1952) schema diffing tools for these kinds of  
[0:32:34](https://youtu.be/9I9GdSQ1bbM?t=1954) purposes but take a look at Flyway and  
[0:32:36](https://youtu.be/9I9GdSQ1bbM?t=1956) you'll find the equivalent for whatever  
[0:32:37](https://youtu.be/9I9GdSQ1bbM?t=1957) kind of environment you want Ruby  
[0:32:39](https://youtu.be/9I9GdSQ1bbM?t=1959) migrations is another great example and  
[0:32:41](https://youtu.be/9I9GdSQ1bbM?t=1961) so we've got a tour like this we've got  
[0:32:43](https://youtu.be/9I9GdSQ1bbM?t=1963) some basic refactorings it's all looks  
[0:32:46](https://youtu.be/9I9GdSQ1bbM?t=1966) like it's gonna be quite straightforward  
[0:32:47](https://youtu.be/9I9GdSQ1bbM?t=1967) and then we start getting into some  
[0:32:48](https://youtu.be/9I9GdSQ1bbM?t=1968) nasty issues so we can start off with a  
[0:32:51](https://youtu.be/9I9GdSQ1bbM?t=1971) pretty simple case here we've got a  
[0:32:52](https://youtu.be/9I9GdSQ1bbM?t=1972) monolithic ecommerce site we actually  
[0:32:55](https://youtu.be/9I9GdSQ1bbM?t=1975) sell compact discs I've been selling  
[0:32:57](https://youtu.be/9I9GdSQ1bbM?t=1977) compact discs for my fake company since  
[0:32:59](https://youtu.be/9I9GdSQ1bbM?t=1979) 2011 and we're starting to feel the  
[0:33:02](https://youtu.be/9I9GdSQ1bbM?t=1982) pinch a little bit so it turns out no  
[0:33:03](https://youtu.be/9I9GdSQ1bbM?t=1983) one wants them anymore we're thinking of  
[0:33:05](https://youtu.be/9I9GdSQ1bbM?t=1985) diversifying into selling 8-track  
[0:33:07](https://youtu.be/9I9GdSQ1bbM?t=1987) cassettes because we assume that after  
[0:33:08](https://youtu.be/9I9GdSQ1bbM?t=1988) vinyl that's where the smart money's  
[0:33:09](https://youtu.be/9I9GdSQ1bbM?t=1989) gonna be maybe some laser discs  
[0:33:12](https://youtu.be/9I9GdSQ1bbM?t=1992) so we've got some catalog related  
[0:33:14](https://youtu.be/9I9GdSQ1bbM?t=1994) functionality and this knows the name of  
[0:33:17](https://youtu.be/9I9GdSQ1bbM?t=1997) the artists and they've got some ID for  
[0:33:20](https://youtu.be/9I9GdSQ1bbM?t=2000) a piece of information here so we've got  
[0:33:21](https://youtu.be/9I9GdSQ1bbM?t=2001) the best of death polka volume for death  
[0:33:24](https://youtu.be/9I9GdSQ1bbM?t=2004) polka is a thing I thought had made that  
[0:33:26](https://youtu.be/9I9GdSQ1bbM?t=2006) musical genre up until one of my  
[0:33:27](https://youtu.be/9I9GdSQ1bbM?t=2007) workshop attendees played me some deaf  
[0:33:29](https://youtu.be/9I9GdSQ1bbM?t=2009) polka and my ears were bleeding  
[0:33:31](https://youtu.be/9I9GdSQ1bbM?t=2011) afterwards and we've got finance related  
[0:33:34](https://youtu.be/9I9GdSQ1bbM?t=2014) functionality and this is where it's  
[0:33:35](https://youtu.be/9I9GdSQ1bbM?t=2015) going to store effectively our financial  
[0:33:37](https://youtu.be/9I9GdSQ1bbM?t=2017) transactions and and maybe as simple as  
[0:33:39](https://youtu.be/9I9GdSQ1bbM?t=2019) putting something into a ledger table  
[0:33:41](https://youtu.be/9I9GdSQ1bbM?t=2021) okay so as we make a transaction we  
[0:33:43](https://youtu.be/9I9GdSQ1bbM?t=2023) store stuff in a ledger table we've got  
[0:33:45](https://youtu.be/9I9GdSQ1bbM?t=2025) a very simple use case we want to  
[0:33:47](https://youtu.be/9I9GdSQ1bbM?t=2027) display a top ten list of our  
[0:33:49](https://youtu.be/9I9GdSQ1bbM?t=2029) bestsellers so what are the CDs that  
[0:33:52](https://youtu.be/9I9GdSQ1bbM?t=2032) have sold the best in the last week now  
[0:33:55](https://youtu.be/9I9GdSQ1bbM?t=2035) in this kind of situation with just  
[0:33:56](https://youtu.be/9I9GdSQ1bbM?t=2036) these two tables that's actually a very  
[0:33:58](https://youtu.be/9I9GdSQ1bbM?t=2038) simple straightforward query we would do  
[0:34:01](https://youtu.be/9I9GdSQ1bbM?t=2041) a select on the ledger table we would  
[0:34:03](https://youtu.be/9I9GdSQ1bbM?t=2043) group would limit that select based on  
[0:34:05](https://youtu.be/9I9GdSQ1bbM?t=2045) items sold in the last week we were  
[0:34:08](https://youtu.be/9I9GdSQ1bbM?t=2048) grouped by the ID of the CD and count up  
[0:34:10](https://youtu.be/9I9GdSQ1bbM?t=2050) how many copies of that CD we sold so at  
[0:34:13](https://youtu.be/9I9GdSQ1bbM?t=2053) that point we've got ten IDs and the  
[0:34:16](https://youtu.be/9I9GdSQ1bbM?t=2056) counts of how many copies we sold that  
[0:34:18](https://youtu.be/9I9GdSQ1bbM?t=2058) ID by itself is not very useful for a  
[0:34:21](https://youtu.be/9I9GdSQ1bbM?t=2061) webpage linga top ten releases but the  
[0:34:23](https://youtu.be/9I9GdSQ1bbM?t=2063) information about those albums is over  
[0:34:25](https://youtu.be/9I9GdSQ1bbM?t=2065) that line items table and so we would  
[0:34:27](https://youtu.be/9I9GdSQ1bbM?t=2067) need to go and make effective your join  
[0:34:28](https://youtu.be/9I9GdSQ1bbM?t=2068) over into the line items table to pull  
[0:34:31](https://youtu.be/9I9GdSQ1bbM?t=2071) back that data but we're thinking about  
[0:34:34](https://youtu.be/9I9GdSQ1bbM?t=2074) making catalog and Finance two separate  
[0:34:37](https://youtu.be/9I9GdSQ1bbM?t=2077) services the the issue though is we've  
[0:34:39](https://youtu.be/9I9GdSQ1bbM?t=2079) got a join relationship here so we have  
[0:34:41](https://youtu.be/9I9GdSQ1bbM?t=2081) to deal with that join relationship so  
[0:34:44](https://youtu.be/9I9GdSQ1bbM?t=2084) what we instead we're gonna want to do  
[0:34:45](https://youtu.be/9I9GdSQ1bbM?t=2085) is move the join relationship up into  
[0:34:47](https://youtu.be/9I9GdSQ1bbM?t=2087) the applications here we're gonna do a  
[0:34:49](https://youtu.be/9I9GdSQ1bbM?t=2089) query to fetch things from the ledger  
[0:34:51](https://youtu.be/9I9GdSQ1bbM?t=2091) and pull back the date so we need and  
[0:34:52](https://youtu.be/9I9GdSQ1bbM?t=2092) that's at that point it's only going to  
[0:34:54](https://youtu.be/9I9GdSQ1bbM?t=2094) be the IDS using those IDs we're then  
[0:34:56](https://youtu.be/9I9GdSQ1bbM?t=2096) going to go to the catalog service and  
[0:34:58](https://youtu.be/9I9GdSQ1bbM?t=2098) say please give me the information for  
[0:35:00](https://youtu.be/9I9GdSQ1bbM?t=2100) these items and that will give us the  
[0:35:02](https://youtu.be/9I9GdSQ1bbM?t=2102) same functionality as the old join query  
[0:35:05](https://youtu.be/9I9GdSQ1bbM?t=2105) but now we're effectively increasing  
[0:35:07](https://youtu.be/9I9GdSQ1bbM?t=2107) Network hops we're increasing database  
[0:35:09](https://youtu.be/9I9GdSQ1bbM?t=2109) calls as well we end up with this sort  
[0:35:11](https://youtu.be/9I9GdSQ1bbM?t=2111) of system now for something like top 10  
[0:35:14](https://youtu.be/9I9GdSQ1bbM?t=2114) list that's generated once a week the  
[0:35:16](https://youtu.be/9I9GdSQ1bbM?t=2116) increased latency of this operations  
[0:35:18](https://youtu.be/9I9GdSQ1bbM?t=2118) between art and over concern this is a  
[0:35:20](https://youtu.be/9I9GdSQ1bbM?t=2120) very easy thing to cache but there are  
[0:35:22](https://youtu.be/9I9GdSQ1bbM?t=2122) other more insidious problems that we  
[0:35:24](https://youtu.be/9I9GdSQ1bbM?t=2124) have  
[0:35:24](https://youtu.be/9I9GdSQ1bbM?t=2124) here if you look inside that monolithic  
[0:35:27](https://youtu.be/9I9GdSQ1bbM?t=2127) schemer we probably got a relationship  
[0:35:28](https://youtu.be/9I9GdSQ1bbM?t=2128) like this we've got a ledger table or  
[0:35:31](https://youtu.be/9I9GdSQ1bbM?t=2131) with the rose in it we've got the online  
[0:35:33](https://youtu.be/9I9GdSQ1bbM?t=2133) items table and we are going to have a  
[0:35:35](https://youtu.be/9I9GdSQ1bbM?t=2135) foreign key relationships that skew  
[0:35:37](https://youtu.be/9I9GdSQ1bbM?t=2137) column or sometimes called the stock  
[0:35:38](https://youtu.be/9I9GdSQ1bbM?t=2138) keeping unit that is a foreign key  
[0:35:40](https://youtu.be/9I9GdSQ1bbM?t=2140) relationship that points and refers to  
[0:35:42](https://youtu.be/9I9GdSQ1bbM?t=2142) rows in the line items table there's got  
[0:35:44](https://youtu.be/9I9GdSQ1bbM?t=2144) two main things that you do this for in  
[0:35:46](https://youtu.be/9I9GdSQ1bbM?t=2146) relational databases one it improves  
[0:35:49](https://youtu.be/9I9GdSQ1bbM?t=2149) performance for joint operations and two  
[0:35:51](https://youtu.be/9I9GdSQ1bbM?t=2151) it enforces referential integrity or I  
[0:35:54](https://youtu.be/9I9GdSQ1bbM?t=2154) wouldn't be able to delete row one two  
[0:35:56](https://youtu.be/9I9GdSQ1bbM?t=2156) three because the database let's say  
[0:35:58](https://youtu.be/9I9GdSQ1bbM?t=2158) uh-uh  
[0:35:58](https://youtu.be/9I9GdSQ1bbM?t=2158) you can't do that because you're gonna  
[0:36:00](https://youtu.be/9I9GdSQ1bbM?t=2160) you've got references about inbound  
[0:36:02](https://youtu.be/9I9GdSQ1bbM?t=2162) references although normally we're using  
[0:36:04](https://youtu.be/9I9GdSQ1bbM?t=2164) a database as a safety net right the  
[0:36:06](https://youtu.be/9I9GdSQ1bbM?t=2166) application layer would hopefully stop  
[0:36:08](https://youtu.be/9I9GdSQ1bbM?t=2168) us from doing that invalid operation but  
[0:36:10](https://youtu.be/9I9GdSQ1bbM?t=2170) if we've missed that it was still weak  
[0:36:11](https://youtu.be/9I9GdSQ1bbM?t=2171) enforced in court in the database layer  
[0:36:13](https://youtu.be/9I9GdSQ1bbM?t=2173) we moved to these thing to separate  
[0:36:16](https://youtu.be/9I9GdSQ1bbM?t=2176) schemas owned by two separate databases  
[0:36:18](https://youtu.be/9I9GdSQ1bbM?t=2178) we kind of have some questions the first  
[0:36:21](https://youtu.be/9I9GdSQ1bbM?t=2181) thing is how do we even denote this  
[0:36:22](https://youtu.be/9I9GdSQ1bbM?t=2182) relationship exists anymore  
[0:36:24](https://youtu.be/9I9GdSQ1bbM?t=2184) and it's a particular example what I've  
[0:36:26](https://youtu.be/9I9GdSQ1bbM?t=2186) done is I've replaced the SKU column  
[0:36:28](https://youtu.be/9I9GdSQ1bbM?t=2188) here with a sort of templated URI I  
[0:36:30](https://youtu.be/9I9GdSQ1bbM?t=2190) figured this would be a way to wind-up  
[0:36:33](https://youtu.be/9I9GdSQ1bbM?t=2193) people that don't like rest and also  
[0:36:34](https://youtu.be/9I9GdSQ1bbM?t=2194) people that are really pure about their  
[0:36:35](https://youtu.be/9I9GdSQ1bbM?t=2195) rescues and get annoyed both camps at  
[0:36:38](https://youtu.be/9I9GdSQ1bbM?t=2198) the same time so in this example if I  
[0:36:40](https://youtu.be/9I9GdSQ1bbM?t=2200) was building a rest-based system this  
[0:36:42](https://youtu.be/9I9GdSQ1bbM?t=2202) would allow the finance service to  
[0:36:44](https://youtu.be/9I9GdSQ1bbM?t=2204) directly dereference that pointer  
[0:36:45](https://youtu.be/9I9GdSQ1bbM?t=2205) effectively that referent that HTTP  
[0:36:47](https://youtu.be/9I9GdSQ1bbM?t=2207) reference and pull back information  
[0:36:49](https://youtu.be/9I9GdSQ1bbM?t=2209) about that album and that's nice because  
[0:36:52](https://youtu.be/9I9GdSQ1bbM?t=2212) on the point of view the finance service  
[0:36:53](https://youtu.be/9I9GdSQ1bbM?t=2213) i don't literally know how need to know  
[0:36:55](https://youtu.be/9I9GdSQ1bbM?t=2215) how to look that thing up i just  
[0:36:56](https://youtu.be/9I9GdSQ1bbM?t=2216) reference that pointer a lot of people  
[0:36:58](https://youtu.be/9I9GdSQ1bbM?t=2218) get worried about this there so what  
[0:37:00](https://youtu.be/9I9GdSQ1bbM?t=2220) happens if I changed my mind about how I  
[0:37:01](https://youtu.be/9I9GdSQ1bbM?t=2221) look these things up I'm then gonna have  
[0:37:03](https://youtu.be/9I9GdSQ1bbM?t=2223) to go and rewrite the foreign key  
[0:37:05](https://youtu.be/9I9GdSQ1bbM?t=2225) relationships effectively in the system  
[0:37:07](https://youtu.be/9I9GdSQ1bbM?t=2227) so a lot of people just leave the IDS as  
[0:37:09](https://youtu.be/9I9GdSQ1bbM?t=2229) they were before and then in an  
[0:37:11](https://youtu.be/9I9GdSQ1bbM?t=2231) application code the application code of  
[0:37:13](https://youtu.be/9I9GdSQ1bbM?t=2233) the finance service needs to know how to  
[0:37:15](https://youtu.be/9I9GdSQ1bbM?t=2235) do that lookup the bigger issue of  
[0:37:17](https://youtu.be/9I9GdSQ1bbM?t=2237) course is that we've got nothing  
[0:37:19](https://youtu.be/9I9GdSQ1bbM?t=2239) enforcing our referential integrity in  
[0:37:20](https://youtu.be/9I9GdSQ1bbM?t=2240) this situation there's nothing to stop  
[0:37:23](https://youtu.be/9I9GdSQ1bbM?t=2243) us deleting wrote one two three from the  
[0:37:24](https://youtu.be/9I9GdSQ1bbM?t=2244) catalog and that would potentially cause  
[0:37:27](https://youtu.be/9I9GdSQ1bbM?t=2247) kind of an interesting problem at this  
[0:37:29](https://youtu.be/9I9GdSQ1bbM?t=2249) point now sometimes and I suggest this  
[0:37:33](https://youtu.be/9I9GdSQ1bbM?t=2253) you know people is always okay if you do  
[0:37:34](https://youtu.be/9I9GdSQ1bbM?t=2254) a cascading delete so you could  
[0:37:36](https://youtu.be/9I9GdSQ1bbM?t=2256) implement a cascading delete in  
[0:37:38](https://youtu.be/9I9GdSQ1bbM?t=2258) situation bites a when I deleted an item  
[0:37:40](https://youtu.be/9I9GdSQ1bbM?t=2260) from the catalog table I could fire an  
[0:37:41](https://youtu.be/9I9GdSQ1bbM?t=2261) event that event could say item 1 2 3  
[0:37:44](https://youtu.be/9I9GdSQ1bbM?t=2264) deleted the things that care about that  
[0:37:46](https://youtu.be/9I9GdSQ1bbM?t=2266) could also delete a row from their  
[0:37:49](https://youtu.be/9I9GdSQ1bbM?t=2269) location if they've got a reference on  
[0:37:50](https://youtu.be/9I9GdSQ1bbM?t=2270) it now I will say this deleting things  
[0:37:54](https://youtu.be/9I9GdSQ1bbM?t=2274) from financial ledger is a great way to  
[0:37:56](https://youtu.be/9I9GdSQ1bbM?t=2276) go to prison so don't do that in this  
[0:37:58](https://youtu.be/9I9GdSQ1bbM?t=2278) particular situation but nonetheless you  
[0:38:00](https://youtu.be/9I9GdSQ1bbM?t=2280) can see how you could implement similar  
[0:38:02](https://youtu.be/9I9GdSQ1bbM?t=2282) sip processes like a cascading delete in  
[0:38:04](https://youtu.be/9I9GdSQ1bbM?t=2284) a systems-based environment if you  
[0:38:07](https://youtu.be/9I9GdSQ1bbM?t=2287) worried about deletion causing a  
[0:38:08](https://youtu.be/9I9GdSQ1bbM?t=2288) structural you know referential  
[0:38:10](https://youtu.be/9I9GdSQ1bbM?t=2290) integrity you could also just do a store  
[0:38:12](https://youtu.be/9I9GdSQ1bbM?t=2292) set of a soft Ally now a status column  
[0:38:14](https://youtu.be/9I9GdSQ1bbM?t=2294) says it's things no longer available and  
[0:38:16](https://youtu.be/9I9GdSQ1bbM?t=2296) that has solved this problem but that's  
[0:38:18](https://youtu.be/9I9GdSQ1bbM?t=2298) not a problem that could have existed in  
[0:38:19](https://youtu.be/9I9GdSQ1bbM?t=2299) the old system we potentially have had  
[0:38:22](https://youtu.be/9I9GdSQ1bbM?t=2302) to change the behavior of our system to  
[0:38:24](https://youtu.be/9I9GdSQ1bbM?t=2304) cope with this lack of enforced data  
[0:38:27](https://youtu.be/9I9GdSQ1bbM?t=2307) integrity and we've also made this  
[0:38:30](https://youtu.be/9I9GdSQ1bbM?t=2310) operation slower so you've got to decide  
[0:38:33](https://youtu.be/9I9GdSQ1bbM?t=2313) if all of that was worth it did you get  
[0:38:35](https://youtu.be/9I9GdSQ1bbM?t=2315) enough out of these new services maybe  
[0:38:37](https://youtu.be/9I9GdSQ1bbM?t=2317) you did maybe you didn't but you've got  
[0:38:39](https://youtu.be/9I9GdSQ1bbM?t=2319) to be aware of the things going in and  
[0:38:40](https://youtu.be/9I9GdSQ1bbM?t=2320) again this is something it's much easier  
[0:38:42](https://youtu.be/9I9GdSQ1bbM?t=2322) to assess the impact of if you've made  
[0:38:44](https://youtu.be/9I9GdSQ1bbM?t=2324) one cut at a time deployed it into  
[0:38:46](https://youtu.be/9I9GdSQ1bbM?t=2326) production measured it and understood  
[0:38:48](https://youtu.be/9I9GdSQ1bbM?t=2328) the behavior but fundamentally we've got  
[0:38:51](https://youtu.be/9I9GdSQ1bbM?t=2331) more Network hops and we've lost  
[0:38:53](https://youtu.be/9I9GdSQ1bbM?t=2333) enforcement of data integrity so we'll  
[0:38:58](https://youtu.be/9I9GdSQ1bbM?t=2338) look at the look at the last example now  
[0:39:02](https://youtu.be/9I9GdSQ1bbM?t=2342) and I figured it's towards the end of  
[0:39:04](https://youtu.be/9I9GdSQ1bbM?t=2344) the day so we'll talk about one of the  
[0:39:06](https://youtu.be/9I9GdSQ1bbM?t=2346) more contentious areas of distributed  
[0:39:07](https://youtu.be/9I9GdSQ1bbM?t=2347) systems just before you get some beer so  
[0:39:10](https://youtu.be/9I9GdSQ1bbM?t=2350) this is a very simple example of our  
[0:39:11](https://youtu.be/9I9GdSQ1bbM?t=2351) music shop we've got the catalog of  
[0:39:13](https://youtu.be/9I9GdSQ1bbM?t=2353) warehouse functionality we're storing  
[0:39:15](https://youtu.be/9I9GdSQ1bbM?t=2355) stuff in an item table and the row of an  
[0:39:17](https://youtu.be/9I9GdSQ1bbM?t=2357) item table looks like this but the BG's  
[0:39:19](https://youtu.be/9I9GdSQ1bbM?t=2359) hits four dollars 99 forty five four  
[0:39:22](https://youtu.be/9I9GdSQ1bbM?t=2362) twenty five is the number of items in  
[0:39:24](https://youtu.be/9I9GdSQ1bbM?t=2364) stock the BG's hits four ninety nine is  
[0:39:27](https://youtu.be/9I9GdSQ1bbM?t=2367) a recommended retail price for this  
[0:39:28](https://youtu.be/9I9GdSQ1bbM?t=2368) masterpiece and we're looking at maybe  
[0:39:31](https://youtu.be/9I9GdSQ1bbM?t=2371) making catalog and warehouse to separate  
[0:39:33](https://youtu.be/9I9GdSQ1bbM?t=2373) services so to prepare the groundwork  
[0:39:35](https://youtu.be/9I9GdSQ1bbM?t=2375) for that a pretty obvious refactoring  
[0:39:37](https://youtu.be/9I9GdSQ1bbM?t=2377) would be to do something like we'll  
[0:39:39](https://youtu.be/9I9GdSQ1bbM?t=2379) actually just take this table and split  
[0:39:40](https://youtu.be/9I9GdSQ1bbM?t=2380) it into two separate tables again this  
[0:39:42](https://youtu.be/9I9GdSQ1bbM?t=2382) is really bread-and-butter refactoring  
[0:39:44](https://youtu.be/9I9GdSQ1bbM?t=2384) stuff so this is nice it looks great so  
[0:39:48](https://youtu.be/9I9GdSQ1bbM?t=2388) now we can have trans log of the  
[0:39:49](https://youtu.be/9I9GdSQ1bbM?t=2389) warehouse a to set  
[0:39:50](https://youtu.be/9I9GdSQ1bbM?t=2390) services but then we start putting that  
[0:39:51](https://youtu.be/9I9GdSQ1bbM?t=2391) in a production running context we might  
[0:39:54](https://youtu.be/9I9GdSQ1bbM?t=2394) end up with a quite simple topology like  
[0:39:56](https://youtu.be/9I9GdSQ1bbM?t=2396) this I've got my catalog service I've  
[0:39:58](https://youtu.be/9I9GdSQ1bbM?t=2398) got my payment gateway I've got my  
[0:39:59](https://youtu.be/9I9GdSQ1bbM?t=2399) warehouse service my warehouse service  
[0:40:01](https://youtu.be/9I9GdSQ1bbM?t=2401) tells me what I've got in stock now in a  
[0:40:03](https://youtu.be/9I9GdSQ1bbM?t=2403) distributed system we are always on the  
[0:40:06](https://youtu.be/9I9GdSQ1bbM?t=2406) watch out for things called partitions  
[0:40:07](https://youtu.be/9I9GdSQ1bbM?t=2407) partitions are what occurs where one  
[0:40:09](https://youtu.be/9I9GdSQ1bbM?t=2409) part of a dish which your system cannot  
[0:40:10](https://youtu.be/9I9GdSQ1bbM?t=2410) see another part of a distributed system  
[0:40:13](https://youtu.be/9I9GdSQ1bbM?t=2413) these things are not under your control  
[0:40:15](https://youtu.be/9I9GdSQ1bbM?t=2415) they will happen and if you don't plan  
[0:40:17](https://youtu.be/9I9GdSQ1bbM?t=2417) for them they're going to happen anyway  
[0:40:18](https://youtu.be/9I9GdSQ1bbM?t=2418) so you have to plan for them right so  
[0:40:20](https://youtu.be/9I9GdSQ1bbM?t=2420) we're gonna take a look at a scenario  
[0:40:21](https://youtu.be/9I9GdSQ1bbM?t=2421) has been created by our brave new world  
[0:40:23](https://youtu.be/9I9GdSQ1bbM?t=2423) the payment the warehouse for some  
[0:40:26](https://youtu.be/9I9GdSQ1bbM?t=2426) reason cannot currently be reached this  
[0:40:28](https://youtu.be/9I9GdSQ1bbM?t=2428) means we cannot check our stock levels  
[0:40:30](https://youtu.be/9I9GdSQ1bbM?t=2430) remember the old monolithic system this  
[0:40:32](https://youtu.be/9I9GdSQ1bbM?t=2432) is a failure mode that could not exist  
[0:40:35](https://youtu.be/9I9GdSQ1bbM?t=2435) it was either all up or all down now  
[0:40:37](https://youtu.be/9I9GdSQ1bbM?t=2437) we've got a partial failure we know how  
[0:40:40](https://youtu.be/9I9GdSQ1bbM?t=2440) much stuff costs we can take people's  
[0:40:42](https://youtu.be/9I9GdSQ1bbM?t=2442) money but we don't know how much stuff  
[0:40:44](https://youtu.be/9I9GdSQ1bbM?t=2444) we've got in stock now I don't ask you a  
[0:40:46](https://youtu.be/9I9GdSQ1bbM?t=2446) question if you're running this CD  
[0:40:49](https://youtu.be/9I9GdSQ1bbM?t=2449) online Emporium and you had a failure  
[0:40:52](https://youtu.be/9I9GdSQ1bbM?t=2452) mode like this so you know how much  
[0:40:53](https://youtu.be/9I9GdSQ1bbM?t=2453) stuff costs but you don't know if you've  
[0:40:56](https://youtu.be/9I9GdSQ1bbM?t=2456) got those items in stock put your hands  
[0:40:58](https://youtu.be/9I9GdSQ1bbM?t=2458) up if you tell us if you just you keep  
[0:40:59](https://youtu.be/9I9GdSQ1bbM?t=2459) selling CDs you capitalist bastard right  
[0:41:04](https://youtu.be/9I9GdSQ1bbM?t=2464) I put your hands up if you wouldn't sell  
[0:41:07](https://youtu.be/9I9GdSQ1bbM?t=2467) CDs you would be out of business in like  
[0:41:10](https://youtu.be/9I9GdSQ1bbM?t=2470) a heartbeat right in this business  
[0:41:13](https://youtu.be/9I9GdSQ1bbM?t=2473) context ecommerce companies keep selling  
[0:41:15](https://youtu.be/9I9GdSQ1bbM?t=2475) and the reason they keep selling is they  
[0:41:17](https://youtu.be/9I9GdSQ1bbM?t=2477) go through a very simple thinking  
[0:41:18](https://youtu.be/9I9GdSQ1bbM?t=2478) process if I don't sell any CDs then we  
[0:41:21](https://youtu.be/9I9GdSQ1bbM?t=2481) make no money we can't sell CDs that we  
[0:41:24](https://youtu.be/9I9GdSQ1bbM?t=2484) do have in stock our customers are upset  
[0:41:26](https://youtu.be/9I9GdSQ1bbM?t=2486) and they go and buy the CDs somewhere  
[0:41:28](https://youtu.be/9I9GdSQ1bbM?t=2488) else and they don't come back if we sell  
[0:41:31](https://youtu.be/9I9GdSQ1bbM?t=2491) the CDs and it turns out we don't  
[0:41:33](https://youtu.be/9I9GdSQ1bbM?t=2493) actually have them in stock we can  
[0:41:35](https://youtu.be/9I9GdSQ1bbM?t=2495) apologize we can give those people a  
[0:41:37](https://youtu.be/9I9GdSQ1bbM?t=2497) refund we can offer to backorder that CD  
[0:41:40](https://youtu.be/9I9GdSQ1bbM?t=2500) but we're probably going to set up set  
[0:41:42](https://youtu.be/9I9GdSQ1bbM?t=2502) and fewer of our customers and we're  
[0:41:44](https://youtu.be/9I9GdSQ1bbM?t=2504) going to make more money so they always  
[0:41:46](https://youtu.be/9I9GdSQ1bbM?t=2506) will make that trade-off change the  
[0:41:48](https://youtu.be/9I9GdSQ1bbM?t=2508) context you get a different outcome if  
[0:41:50](https://youtu.be/9I9GdSQ1bbM?t=2510) you're selling tickets for a concert  
[0:41:52](https://youtu.be/9I9GdSQ1bbM?t=2512) they tend to make a different trade-off  
[0:41:54](https://youtu.be/9I9GdSQ1bbM?t=2514) because if I sell tickets and then  
[0:41:57](https://youtu.be/9I9GdSQ1bbM?t=2517) you think you've got a ticket to go and  
[0:41:59](https://youtu.be/9I9GdSQ1bbM?t=2519) see the World Cup final in Japan and you  
[0:42:01](https://youtu.be/9I9GdSQ1bbM?t=2521) booked flights and then we email you and  
[0:42:03](https://youtu.be/9I9GdSQ1bbM?t=2523) go oh you don't have tickets to see the  
[0:42:04](https://youtu.be/9I9GdSQ1bbM?t=2524) World Cup you're a bit annoyed the other  
[0:42:07](https://youtu.be/9I9GdSQ1bbM?t=2527) thing of course is if your tickets can't  
[0:42:08](https://youtu.be/9I9GdSQ1bbM?t=2528) be purchased right now on that website  
[0:42:10](https://youtu.be/9I9GdSQ1bbM?t=2530) what do you do as the person buying a  
[0:42:13](https://youtu.be/9I9GdSQ1bbM?t=2533) ticket you'd go back later because those  
[0:42:16](https://youtu.be/9I9GdSQ1bbM?t=2536) tickets are only hold it held by that  
[0:42:18](https://youtu.be/9I9GdSQ1bbM?t=2538) supplier because basically these sort of  
[0:42:21](https://youtu.be/9I9GdSQ1bbM?t=2541) online ticketing companies are  
[0:42:22](https://youtu.be/9I9GdSQ1bbM?t=2542) effectively a cartel this trade-off  
[0:42:24](https://youtu.be/9I9GdSQ1bbM?t=2544) actually speaks to one of the more  
[0:42:26](https://youtu.be/9I9GdSQ1bbM?t=2546) fundamental trade-offs we look at in  
[0:42:27](https://youtu.be/9I9GdSQ1bbM?t=2547) distributed systems and a lot of things  
[0:42:29](https://youtu.be/9I9GdSQ1bbM?t=2549) have been talked a lot of rubbish has  
[0:42:31](https://youtu.be/9I9GdSQ1bbM?t=2551) talked about these things and that's a  
[0:42:33](https://youtu.be/9I9GdSQ1bbM?t=2553) thing called cap theory so cap Theory  
[0:42:37](https://youtu.be/9I9GdSQ1bbM?t=2557) basically talks the trade-offs that  
[0:42:38](https://youtu.be/9I9GdSQ1bbM?t=2558) happen in in a distributed system I'm  
[0:42:40](https://youtu.be/9I9GdSQ1bbM?t=2560) simplifying this to the point where  
[0:42:42](https://youtu.be/9I9GdSQ1bbM?t=2562) whatever you think about is when a  
[0:42:44](https://youtu.be/9I9GdSQ1bbM?t=2564) partition occurs you have to decide  
[0:42:46](https://youtu.be/9I9GdSQ1bbM?t=2566) whether or not consistency or  
[0:42:49](https://youtu.be/9I9GdSQ1bbM?t=2569) availability is more important to you  
[0:42:50](https://youtu.be/9I9GdSQ1bbM?t=2570) when we say we're gonna take the money  
[0:42:52](https://youtu.be/9I9GdSQ1bbM?t=2572) what we're basically saying is it's more  
[0:42:54](https://youtu.be/9I9GdSQ1bbM?t=2574) important to us to maintain availability  
[0:42:57](https://youtu.be/9I9GdSQ1bbM?t=2577) of the operation to sell CD's and in  
[0:43:01](https://youtu.be/9I9GdSQ1bbM?t=2581) exchange for doing that we're now going  
[0:43:02](https://youtu.be/9I9GdSQ1bbM?t=2582) to have an inconsistent view of our  
[0:43:04](https://youtu.be/9I9GdSQ1bbM?t=2584) stock if we don't take the money we're  
[0:43:06](https://youtu.be/9I9GdSQ1bbM?t=2586) saying it's more important for us to  
[0:43:07](https://youtu.be/9I9GdSQ1bbM?t=2587) have a view of our stock consistency in  
[0:43:10](https://youtu.be/9I9GdSQ1bbM?t=2590) that context is more important to us and  
[0:43:12](https://youtu.be/9I9GdSQ1bbM?t=2592) we're gonna trade off availability that  
[0:43:14](https://youtu.be/9I9GdSQ1bbM?t=2594) is about as much as any of you ever need  
[0:43:16](https://youtu.be/9I9GdSQ1bbM?t=2596) to know about cap Theory don't look any  
[0:43:18](https://youtu.be/9I9GdSQ1bbM?t=2598) further into it just gonna make  
[0:43:19](https://youtu.be/9I9GdSQ1bbM?t=2599) everybody's heads hurt what you can say  
[0:43:21](https://youtu.be/9I9GdSQ1bbM?t=2601) if you also do is whenever you meet  
[0:43:22](https://youtu.be/9I9GdSQ1bbM?t=2602) someone that says I've beaten cat theory  
[0:43:24](https://youtu.be/9I9GdSQ1bbM?t=2604) you can just you know ignore them and  
[0:43:26](https://youtu.be/9I9GdSQ1bbM?t=2606) more pass them because they haven't  
[0:43:27](https://youtu.be/9I9GdSQ1bbM?t=2607) they've just made a trade off and that's  
[0:43:28](https://youtu.be/9I9GdSQ1bbM?t=2608) fine we've gone through a lot and I'm  
[0:43:32](https://youtu.be/9I9GdSQ1bbM?t=2612) out of time so I won't talk about that  
[0:43:34](https://youtu.be/9I9GdSQ1bbM?t=2614) this is sort of there's a lot more  
[0:43:36](https://youtu.be/9I9GdSQ1bbM?t=2616) patterns in my book if you want to go  
[0:43:38](https://youtu.be/9I9GdSQ1bbM?t=2618) over onto a rise online learning  
[0:43:40](https://youtu.be/9I9GdSQ1bbM?t=2620) platform you can read an ear production  
[0:43:42](https://youtu.be/9I9GdSQ1bbM?t=2622) version of it it will be in print next  
[0:43:45](https://youtu.be/9I9GdSQ1bbM?t=2625) month more informations over my website  
[0:43:47](https://youtu.be/9I9GdSQ1bbM?t=2627) but thank you very much for your time  
[0:43:49](https://youtu.be/9I9GdSQ1bbM?t=2629) [Applause]  
[0:43:53](https://youtu.be/9I9GdSQ1bbM?t=2633) [Music]  
[0:43:53](https://youtu.be/9I9GdSQ1bbM?t=2633) [Applause]  

