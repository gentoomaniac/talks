# DEF CON 26 - Eyal Itkin, Yaniv Balmas - What the Fax?! (2018-09-13)

![alt DEF CON 26 - Eyal Itkin, Yaniv Balmas - What the Fax?!](img/qLCE8spVX9Q.jpg "DEF CON 26 - Eyal Itkin, Yaniv Balmas - What the Fax?!")

## Description

Unless you've been living under a rock for the past 30 years or so, you probably know what a fax machine is. For decades, fax machines were used worldwide as the main way of electronic document delivery. But this happened in the 1980s. Humanity has since developed far more advanced ways to send digital content, and fax machines are all in the past, right? After all, they should now be nothing more than a glorified museum item. Who on earth is still using fax machines? 

The answer, to our great horror, is EVERYONE. State authorities, banks, service providers and many others are still using fax machines, despite their debatable quality and almost non-existent security. In fact, using fax machines is often mandatory and considered a solid and trustworthy method of delivering information. 

What the Fax?! We embarked on a journey with the singular goal of disrupting this insane state of affairs. We went to work, determined to show that the common fax machine could be compromised via mere access to its fully exposed and unprotected telephone line -- thus completely bypassing all perimeter security protections and shattering to pieces all modern-day security concepts. 

Join us as we take you through the strange world of embedded operating systems, 30-year-old protocols, museum grade compression algorithms, weird extensions and undebuggable environments. See for yourself first-hand as we give a live demonstration of the first ever full fax exploitation, leading to complete control over the entire device as well as the network, using nothing but a standard telephone line. 

This talk is intended to be the canary in the coal mine. The technology community cannot sit idly by while this ongoing madness is allowed to continue. The world must stop using FAX!

## Transcript

[0:00:00](https://youtu.be/qLCE8spVX9Q?t=0) [Applause]  
[0:00:19](https://youtu.be/qLCE8spVX9Q?t=19) hello everyone  
[0:00:20](https://youtu.be/qLCE8spVX9Q?t=20) thanks for coming to our talk what the  
[0:00:23](https://youtu.be/qLCE8spVX9Q?t=23) facts let's do some 1980s  
[0:00:27](https://youtu.be/qLCE8spVX9Q?t=27) hacking party yeah so my name is Yaniv  
[0:00:32](https://youtu.be/qLCE8spVX9Q?t=32) Palmas and here is a young it cane we  
[0:00:35](https://youtu.be/qLCE8spVX9Q?t=35) are both security researcher as a walk  
[0:00:36](https://youtu.be/qLCE8spVX9Q?t=36) for checkpoint research and let's begin  
[0:00:39](https://youtu.be/qLCE8spVX9Q?t=39) with a brief history of facts so it was  
[0:00:43](https://youtu.be/qLCE8spVX9Q?t=43) it all started in 1846 when a scientist  
[0:00:46](https://youtu.be/qLCE8spVX9Q?t=46) named Alexander Bane invented a center  
[0:00:48](https://youtu.be/qLCE8spVX9Q?t=48) first image of a wire and just a fun  
[0:00:51](https://youtu.be/qLCE8spVX9Q?t=51) fact this happened around 20 years  
[0:00:53](https://youtu.be/qLCE8spVX9Q?t=53) before the invention of the light bulb  
[0:00:55](https://youtu.be/qLCE8spVX9Q?t=55) and then facts evolved a bit and came to  
[0:00:58](https://youtu.be/qLCE8spVX9Q?t=58) be this machines again just before the  
[0:01:01](https://youtu.be/qLCE8spVX9Q?t=61) invention of the telephone radio fakes  
[0:01:03](https://youtu.be/qLCE8spVX9Q?t=63) fax came to be and then in 1966 a small  
[0:01:07](https://youtu.be/qLCE8spVX9Q?t=67) company called Xerox invented the first  
[0:01:10](https://youtu.be/qLCE8spVX9Q?t=70) commercial fax machines and really  
[0:01:12](https://youtu.be/qLCE8spVX9Q?t=72) change the way we send electronic  
[0:01:14](https://youtu.be/qLCE8spVX9Q?t=74) documents from one to each other and  
[0:01:17](https://youtu.be/qLCE8spVX9Q?t=77) then throughout the years there was few  
[0:01:19](https://youtu.be/qLCE8spVX9Q?t=79) standards for fax but at 1980 the last  
[0:01:22](https://youtu.be/qLCE8spVX9Q?t=82) and most recent standards for fax came  
[0:01:24](https://youtu.be/qLCE8spVX9Q?t=84) to be by an organization called ITU and  
[0:01:27](https://youtu.be/qLCE8spVX9Q?t=87) namely the protocols are t-38 e46 those  
[0:01:32](https://youtu.be/qLCE8spVX9Q?t=92) are practically the same protocols we  
[0:01:34](https://youtu.be/qLCE8spVX9Q?t=94) still use today when we send fax and now  
[0:01:38](https://youtu.be/qLCE8spVX9Q?t=98) you know this was in the past but what's  
[0:01:41](https://youtu.be/qLCE8spVX9Q?t=101) happening today I mean let's compare we  
[0:01:45](https://youtu.be/qLCE8spVX9Q?t=105) have better ways to send aleko  
[0:01:47](https://youtu.be/qLCE8spVX9Q?t=107) electronic documents who want to to  
[0:01:48](https://youtu.be/qLCE8spVX9Q?t=108) other right let's compare fax to just  
[0:01:51](https://youtu.be/qLCE8spVX9Q?t=111) one of them  
[0:01:52](https://youtu.be/qLCE8spVX9Q?t=112) let's say email right so if we compare  
[0:01:55](https://youtu.be/qLCE8spVX9Q?t=115) fax to email and just to remind you we  
[0:01:58](https://youtu.be/qLCE8spVX9Q?t=118) are comparing this to this right so in  
[0:02:02](https://youtu.be/qLCE8spVX9Q?t=122) terms of quality you just saw the  
[0:02:04](https://youtu.be/qLCE8spVX9Q?t=124) pictures you know I have nothing to add  
[0:02:06](https://youtu.be/qLCE8spVX9Q?t=126) in terms of accessibility I'm pretty  
[0:02:09](https://youtu.be/qLCE8spVX9Q?t=129) sure most or all of you have 24 by 7  
[0:02:12](https://youtu.be/qLCE8spVX9Q?t=132) axis  
[0:02:12](https://youtu.be/qLCE8spVX9Q?t=132) females right I'm not so sure you're  
[0:02:14](https://youtu.be/qLCE8spVX9Q?t=134) carrying around your fax machines with  
[0:02:16](https://youtu.be/qLCE8spVX9Q?t=136) you in terms of reliability so when you  
[0:02:19](https://youtu.be/qLCE8spVX9Q?t=139) send an email  
[0:02:20](https://youtu.be/qLCE8spVX9Q?t=140) it gets received but you know when it's  
[0:02:22](https://youtu.be/qLCE8spVX9Q?t=142) in the fax it might get accidentally  
[0:02:24](https://youtu.be/qLCE8spVX9Q?t=144) shredded the dog might might eat it or  
[0:02:26](https://youtu.be/qLCE8spVX9Q?t=146) you know you can never know if it got to  
[0:02:28](https://youtu.be/qLCE8spVX9Q?t=148) its destination and in terms of  
[0:02:30](https://youtu.be/qLCE8spVX9Q?t=150) authenticity well we can argue about  
[0:02:32](https://youtu.be/qLCE8spVX9Q?t=152) email whether or not it's authenticated  
[0:02:34](https://youtu.be/qLCE8spVX9Q?t=154) but we do have extensions like public  
[0:02:36](https://youtu.be/qLCE8spVX9Q?t=156) key cryptography what we don't have is  
[0:02:38](https://youtu.be/qLCE8spVX9Q?t=158) we have nothing for fax simply no  
[0:02:40](https://youtu.be/qLCE8spVX9Q?t=160) authentication at all so yeah looking at  
[0:02:44](https://youtu.be/qLCE8spVX9Q?t=164) this table you might think okay so it's  
[0:02:47](https://youtu.be/qLCE8spVX9Q?t=167) 2018 who is using fax probably nobody is  
[0:02:50](https://youtu.be/qLCE8spVX9Q?t=170) using right wrong fax is pretty much  
[0:02:55](https://youtu.be/qLCE8spVX9Q?t=175) live in qicang still it's being used all  
[0:02:59](https://youtu.be/qLCE8spVX9Q?t=179) over the place  
[0:02:59](https://youtu.be/qLCE8spVX9Q?t=179) ships maritime use it to receive those  
[0:03:02](https://youtu.be/qLCE8spVX9Q?t=182) critical maps in open seas according to  
[0:03:06](https://youtu.be/qLCE8spVX9Q?t=186) Wikipedia 90% of the Japanese population  
[0:03:09](https://youtu.be/qLCE8spVX9Q?t=189) use fax what they really like fax over  
[0:03:11](https://youtu.be/qLCE8spVX9Q?t=191) there but I don't know why yeah but  
[0:03:14](https://youtu.be/qLCE8spVX9Q?t=194) they're Japanese so and if you do a lot  
[0:03:18](https://youtu.be/qLCE8spVX9Q?t=198) of Google combos like you know contact  
[0:03:21](https://youtu.be/qLCE8spVX9Q?t=201) us and fax you'll find over 300 million  
[0:03:24](https://youtu.be/qLCE8spVX9Q?t=204) fax numbers published on Google and  
[0:03:26](https://youtu.be/qLCE8spVX9Q?t=206) that's just the published numbers think  
[0:03:28](https://youtu.be/qLCE8spVX9Q?t=208) about how many fax machines don't have  
[0:03:30](https://youtu.be/qLCE8spVX9Q?t=210) the published numbers out there so it's  
[0:03:32](https://youtu.be/qLCE8spVX9Q?t=212) simply a huge amount of fax numbers and  
[0:03:34](https://youtu.be/qLCE8spVX9Q?t=214) fax machines out there today and the  
[0:03:37](https://youtu.be/qLCE8spVX9Q?t=217) thing is that it's not only how many fax  
[0:03:39](https://youtu.be/qLCE8spVX9Q?t=219) machines are other but it's also who  
[0:03:41](https://youtu.be/qLCE8spVX9Q?t=221) uses fax well if you're a small  
[0:03:43](https://youtu.be/qLCE8spVX9Q?t=223) corporate or a huge cooperate you have a  
[0:03:45](https://youtu.be/qLCE8spVX9Q?t=225) fax number you don't necessarily receive  
[0:03:48](https://youtu.be/qLCE8spVX9Q?t=228) faxes over this number but you do have a  
[0:03:50](https://youtu.be/qLCE8spVX9Q?t=230) fax number and it's published out there  
[0:03:52](https://youtu.be/qLCE8spVX9Q?t=232) if you're a bank they love faxes in  
[0:03:54](https://youtu.be/qLCE8spVX9Q?t=234) banks right so this is Bank of China the  
[0:03:56](https://youtu.be/qLCE8spVX9Q?t=236) biggest bank in the world with over  
[0:03:58](https://youtu.be/qLCE8spVX9Q?t=238) three point six two trillion dollars in  
[0:04:00](https://youtu.be/qLCE8spVX9Q?t=240) assets and that's their fax number and  
[0:04:02](https://youtu.be/qLCE8spVX9Q?t=242) maybe most importantly government  
[0:04:04](https://youtu.be/qLCE8spVX9Q?t=244) offices use fax if you ever wanted to  
[0:04:08](https://youtu.be/qLCE8spVX9Q?t=248) fax to our beloved Donald Trump  
[0:04:11](https://youtu.be/qLCE8spVX9Q?t=251) this is his fax number which is google  
[0:04:13](https://youtu.be/qLCE8spVX9Q?t=253) it it's there so the thing is that  
[0:04:16](https://youtu.be/qLCE8spVX9Q?t=256) sometimes all banks and healthcare and  
[0:04:19](https://youtu.be/qLCE8spVX9Q?t=259) government agencies they don't only  
[0:04:21](https://youtu.be/qLCE8spVX9Q?t=261) allow you to send fax but it's actually  
[0:04:25](https://youtu.be/qLCE8spVX9Q?t=265) taury to send fax you can under either  
[0:04:27](https://youtu.be/qLCE8spVX9Q?t=267) use postal mail or fax to send them  
[0:04:30](https://youtu.be/qLCE8spVX9Q?t=270) information it's a good thing that they  
[0:04:32](https://youtu.be/qLCE8spVX9Q?t=272) took mail pigeons out of it but you know  
[0:04:35](https://youtu.be/qLCE8spVX9Q?t=275) so yeah it's a thing and when you're  
[0:04:38](https://youtu.be/qLCE8spVX9Q?t=278) thinking about it well you're thinking  
[0:04:40](https://youtu.be/qLCE8spVX9Q?t=280) probably what the fax I mean it's 2018  
[0:04:43](https://youtu.be/qLCE8spVX9Q?t=283) we should evolve to better ways of  
[0:04:45](https://youtu.be/qLCE8spVX9Q?t=285) electronic document delivery right and  
[0:04:48](https://youtu.be/qLCE8spVX9Q?t=288) now see this is how fax looks like today  
[0:04:51](https://youtu.be/qLCE8spVX9Q?t=291) well it's no longer this standalone fax  
[0:04:54](https://youtu.be/qLCE8spVX9Q?t=294) machines that we used to add twenty or  
[0:04:56](https://youtu.be/qLCE8spVX9Q?t=296) thirty years ago right  
[0:04:57](https://youtu.be/qLCE8spVX9Q?t=297) today fax is embedded this all protocols  
[0:05:00](https://youtu.be/qLCE8spVX9Q?t=300) are embedded within newer technologies  
[0:05:03](https://youtu.be/qLCE8spVX9Q?t=303) we have fax to email services as I said  
[0:05:06](https://youtu.be/qLCE8spVX9Q?t=306) we have fax of a radio and fax over  
[0:05:08](https://youtu.be/qLCE8spVX9Q?t=308) satellite and we have I think most  
[0:05:10](https://youtu.be/qLCE8spVX9Q?t=310) commonly these all-in-one printers they  
[0:05:13](https://youtu.be/qLCE8spVX9Q?t=313) have a lot of things right and they come  
[0:05:15](https://youtu.be/qLCE8spVX9Q?t=315) pre equipped with fax functionality in  
[0:05:18](https://youtu.be/qLCE8spVX9Q?t=318) them and now let's take a look at this  
[0:05:21](https://youtu.be/qLCE8spVX9Q?t=321) all-in-one printers for a second and if  
[0:05:24](https://youtu.be/qLCE8spVX9Q?t=324) you think of it from a security point of  
[0:05:27](https://youtu.be/qLCE8spVX9Q?t=327) view there are just black boxes right  
[0:05:29](https://youtu.be/qLCE8spVX9Q?t=329) and those black boxes has interfaces on  
[0:05:32](https://youtu.be/qLCE8spVX9Q?t=332) one side they have interfaces like Wi-Fi  
[0:05:35](https://youtu.be/qLCE8spVX9Q?t=335) USB bluetooth Ethernet stuff like that  
[0:05:37](https://youtu.be/qLCE8spVX9Q?t=337) those interfaces connects us to the  
[0:05:39](https://youtu.be/qLCE8spVX9Q?t=339) internal network or to the external  
[0:05:41](https://youtu.be/qLCE8spVX9Q?t=341) network or basically they connect us to  
[0:05:43](https://youtu.be/qLCE8spVX9Q?t=343) the world right and on the other hand we  
[0:05:46](https://youtu.be/qLCE8spVX9Q?t=346) have interfaces for connecting facts to  
[0:05:49](https://youtu.be/qLCE8spVX9Q?t=349) the phone line and those interfaces  
[0:05:50](https://youtu.be/qLCE8spVX9Q?t=350) connects us well to the 1970s something  
[0:05:55](https://youtu.be/qLCE8spVX9Q?t=355) like that and now this sounded  
[0:05:59](https://youtu.be/qLCE8spVX9Q?t=359) interesting to us and we thought ok  
[0:06:00](https://youtu.be/qLCE8spVX9Q?t=360) let's imagine this nice attack scenario  
[0:06:03](https://youtu.be/qLCE8spVX9Q?t=363) right if you consider those all-in-one  
[0:06:05](https://youtu.be/qLCE8spVX9Q?t=365) printers are at the end of the day  
[0:06:07](https://youtu.be/qLCE8spVX9Q?t=367) nothing but computers right they have  
[0:06:09](https://youtu.be/qLCE8spVX9Q?t=369) memory they have CPU just complete  
[0:06:11](https://youtu.be/qLCE8spVX9Q?t=371) computers what happens if an attacker  
[0:06:14](https://youtu.be/qLCE8spVX9Q?t=374) with access to the telephone line and  
[0:06:16](https://youtu.be/qLCE8spVX9Q?t=376) equipped only with its victims phone  
[0:06:19](https://youtu.be/qLCE8spVX9Q?t=379) number will be able to attack this  
[0:06:21](https://youtu.be/qLCE8spVX9Q?t=381) printer just through the telephone line  
[0:06:23](https://youtu.be/qLCE8spVX9Q?t=383) and exploit the printer and then take  
[0:06:25](https://youtu.be/qLCE8spVX9Q?t=385) full control of it right in this  
[0:06:28](https://youtu.be/qLCE8spVX9Q?t=388) scenario it can then propagate from the  
[0:06:30](https://youtu.be/qLCE8spVX9Q?t=390) printer through any one of the other  
[0:06:32](https://youtu.be/qLCE8spVX9Q?t=392) interfaces let's say the internet to the  
[0:06:34](https://youtu.be/qLCE8spVX9Q?t=394) internal network right effectively  
[0:06:36](https://youtu.be/qLCE8spVX9Q?t=396) creating a bridge between the internal  
[0:06:39](https://youtu.be/qLCE8spVX9Q?t=399) work and external network using the  
[0:06:42](https://youtu.be/qLCE8spVX9Q?t=402) telephone  
[0:06:42](https://youtu.be/qLCE8spVX9Q?t=402) that's 1980s again right so we thought  
[0:06:45](https://youtu.be/qLCE8spVX9Q?t=405) that's a really cool concept and we went  
[0:06:49](https://youtu.be/qLCE8spVX9Q?t=409) on and began the research for that and  
[0:06:52](https://youtu.be/qLCE8spVX9Q?t=412) after we got excited which sat down and  
[0:06:55](https://youtu.be/qLCE8spVX9Q?t=415) talked about the challenges we have and  
[0:06:57](https://youtu.be/qLCE8spVX9Q?t=417) it seems like we have quite a few  
[0:06:59](https://youtu.be/qLCE8spVX9Q?t=419) challenges in front of us and they are  
[0:07:03](https://youtu.be/qLCE8spVX9Q?t=423) really not simple so let's just name a  
[0:07:06](https://youtu.be/qLCE8spVX9Q?t=426) few of those challenges for example how  
[0:07:10](https://youtu.be/qLCE8spVX9Q?t=430) do we obtain the film were the code for  
[0:07:11](https://youtu.be/qLCE8spVX9Q?t=431) this printer how do we analyze the film  
[0:07:15](https://youtu.be/qLCE8spVX9Q?t=435) where once we got it what operating  
[0:07:17](https://youtu.be/qLCE8spVX9Q?t=437) system does this huge monsters are using  
[0:07:20](https://youtu.be/qLCE8spVX9Q?t=440) how can we be back this thing we have no  
[0:07:23](https://youtu.be/qLCE8spVX9Q?t=443) idea how does fax even work we just know  
[0:07:26](https://youtu.be/qLCE8spVX9Q?t=446) the beeping sounds but we have no idea  
[0:07:28](https://youtu.be/qLCE8spVX9Q?t=448) effects works and then after we  
[0:07:30](https://youtu.be/qLCE8spVX9Q?t=450) understand all that we need to  
[0:07:31](https://youtu.be/qLCE8spVX9Q?t=451) understand where should we look for  
[0:07:33](https://youtu.be/qLCE8spVX9Q?t=453) vulnerabilities inside this big big big  
[0:07:35](https://youtu.be/qLCE8spVX9Q?t=455) ecosystem so today we're gonna try and  
[0:07:38](https://youtu.be/qLCE8spVX9Q?t=458) take you through these questions one by  
[0:07:40](https://youtu.be/qLCE8spVX9Q?t=460) one until we'll be able to exploit this  
[0:07:43](https://youtu.be/qLCE8spVX9Q?t=463) printer right here on the table so let's  
[0:07:46](https://youtu.be/qLCE8spVX9Q?t=466) begin with how do we obtain the fumer  
[0:07:48](https://youtu.be/qLCE8spVX9Q?t=468) for printer so this is our printer I can  
[0:07:54](https://youtu.be/qLCE8spVX9Q?t=474) tell you a lot of things about why we  
[0:07:55](https://youtu.be/qLCE8spVX9Q?t=475) chose this printer but basically it's  
[0:07:57](https://youtu.be/qLCE8spVX9Q?t=477) the cheapest one so yeah we could afford  
[0:08:01](https://youtu.be/qLCE8spVX9Q?t=481) to break like four or five of those  
[0:08:03](https://youtu.be/qLCE8spVX9Q?t=483) doing the research so that was fun  
[0:08:06](https://youtu.be/qLCE8spVX9Q?t=486) actually we have a lot of ink and it's  
[0:08:09](https://youtu.be/qLCE8spVX9Q?t=489) really expensive so if you want  
[0:08:10](https://youtu.be/qLCE8spVX9Q?t=490) something will be able we'll be happy to  
[0:08:12](https://youtu.be/qLCE8spVX9Q?t=492) share so we need to break fax right but  
[0:08:16](https://youtu.be/qLCE8spVX9Q?t=496) just a minute before we break fax we  
[0:08:19](https://youtu.be/qLCE8spVX9Q?t=499) need to break the printer and I mean  
[0:08:20](https://youtu.be/qLCE8spVX9Q?t=500) literally break the printer that was the  
[0:08:24](https://youtu.be/qLCE8spVX9Q?t=504) fun part of the research we broke  
[0:08:25](https://youtu.be/qLCE8spVX9Q?t=505) everything up and try to look inside and  
[0:08:28](https://youtu.be/qLCE8spVX9Q?t=508) see what is this thing even built from  
[0:08:30](https://youtu.be/qLCE8spVX9Q?t=510) and this is basically the brain of the  
[0:08:34](https://youtu.be/qLCE8spVX9Q?t=514) printer that's how it looks like in the  
[0:08:35](https://youtu.be/qLCE8spVX9Q?t=515) inside from the inside let's go through  
[0:08:38](https://youtu.be/qLCE8spVX9Q?t=518) the major components of this PCB so it  
[0:08:41](https://youtu.be/qLCE8spVX9Q?t=521) has a flash rom manufactured by  
[0:08:43](https://youtu.be/qLCE8spVX9Q?t=523) expansion and then some more memory and  
[0:08:46](https://youtu.be/qLCE8spVX9Q?t=526) looking at that it looks a bit like some  
[0:08:48](https://youtu.be/qLCE8spVX9Q?t=528) components are missing right that's  
[0:08:50](https://youtu.be/qLCE8spVX9Q?t=530) mainly because the PCB has two  
[0:08:52](https://youtu.be/qLCE8spVX9Q?t=532) sites so on the other side is the most  
[0:08:56](https://youtu.be/qLCE8spVX9Q?t=536) interesting stuff like USB Wi-Fi  
[0:08:58](https://youtu.be/qLCE8spVX9Q?t=538) electricity SRAM this huge battery  
[0:09:01](https://youtu.be/qLCE8spVX9Q?t=541) that's used for something and then two  
[0:09:04](https://youtu.be/qLCE8spVX9Q?t=544) very interesting components one is the  
[0:09:06](https://youtu.be/qLCE8spVX9Q?t=546) main CPU that's a Marvel CPU and it's  
[0:09:10](https://youtu.be/qLCE8spVX9Q?t=550) manufactured specifically for HP by the  
[0:09:13](https://youtu.be/qLCE8spVX9Q?t=553) way I didn't mention that we chose HP  
[0:09:15](https://youtu.be/qLCE8spVX9Q?t=555) and not because we dislike HP but there  
[0:09:17](https://youtu.be/qLCE8spVX9Q?t=557) are just the biggest vendor they have  
[0:09:18](https://youtu.be/qLCE8spVX9Q?t=558) around 40% of the market share so they  
[0:09:21](https://youtu.be/qLCE8spVX9Q?t=561) look like a good target and then another  
[0:09:24](https://youtu.be/qLCE8spVX9Q?t=564) component is this component and this is  
[0:09:27](https://youtu.be/qLCE8spVX9Q?t=567) a fax modem  
[0:09:28](https://youtu.be/qLCE8spVX9Q?t=568) it's a CSP 1040 and we basically want to  
[0:09:32](https://youtu.be/qLCE8spVX9Q?t=572) focus our research on those two  
[0:09:34](https://youtu.be/qLCE8spVX9Q?t=574) components and understand how do they  
[0:09:36](https://youtu.be/qLCE8spVX9Q?t=576) work and what is the relation between  
[0:09:38](https://youtu.be/qLCE8spVX9Q?t=578) them so as I said one of the first  
[0:09:40](https://youtu.be/qLCE8spVX9Q?t=580) challenges will be to obtain the film  
[0:09:42](https://youtu.be/qLCE8spVX9Q?t=582) wear of this printer so we're taking a  
[0:09:44](https://youtu.be/qLCE8spVX9Q?t=584) closer look at this PCB and we find  
[0:09:47](https://youtu.be/qLCE8spVX9Q?t=587) these two very interesting interesting  
[0:09:50](https://youtu.be/qLCE8spVX9Q?t=590) things in here like its serial debug and  
[0:09:54](https://youtu.be/qLCE8spVX9Q?t=594) a JTAG it's clearly marked on the PCB so  
[0:09:56](https://youtu.be/qLCE8spVX9Q?t=596) we say okay that's gonna be really easy  
[0:09:58](https://youtu.be/qLCE8spVX9Q?t=598) if you're not familiar with them they  
[0:10:00](https://youtu.be/qLCE8spVX9Q?t=600) are just interfaces that will let you  
[0:10:01](https://youtu.be/qLCE8spVX9Q?t=601) deep bug the the printer the the CPU  
[0:10:05](https://youtu.be/qLCE8spVX9Q?t=605) read and write memory so that's  
[0:10:07](https://youtu.be/qLCE8spVX9Q?t=607) basically all we need to obtain a few  
[0:10:09](https://youtu.be/qLCE8spVX9Q?t=609) more unfortunately for us the JTAG is  
[0:10:12](https://youtu.be/qLCE8spVX9Q?t=612) completely disabled we can't access it  
[0:10:14](https://youtu.be/qLCE8spVX9Q?t=614) and the serial what we were able to  
[0:10:17](https://youtu.be/qLCE8spVX9Q?t=617) access the serial get is terminal but  
[0:10:20](https://youtu.be/qLCE8spVX9Q?t=620) almost every command we try to write  
[0:10:22](https://youtu.be/qLCE8spVX9Q?t=622) would give us this strange message I  
[0:10:24](https://youtu.be/qLCE8spVX9Q?t=624) don't understand what we don't  
[0:10:26](https://youtu.be/qLCE8spVX9Q?t=626) understand either so it seems like we're  
[0:10:30](https://youtu.be/qLCE8spVX9Q?t=630) not gonna go anywhere from here we need  
[0:10:33](https://youtu.be/qLCE8spVX9Q?t=633) to find an alternate path to get the  
[0:10:34](https://youtu.be/qLCE8spVX9Q?t=634) film work we looked a bit around and it  
[0:10:38](https://youtu.be/qLCE8spVX9Q?t=638) turns out that actually luckily for us  
[0:10:40](https://youtu.be/qLCE8spVX9Q?t=640) HP has this site online an FTP site and  
[0:10:44](https://youtu.be/qLCE8spVX9Q?t=644) this site contains each and every few  
[0:10:47](https://youtu.be/qLCE8spVX9Q?t=647) more version for every HP product ever  
[0:10:50](https://youtu.be/qLCE8spVX9Q?t=650) produced in history that's a huge FTP  
[0:10:53](https://youtu.be/qLCE8spVX9Q?t=653) site it actually took us about two weeks  
[0:10:56](https://youtu.be/qLCE8spVX9Q?t=656) to find our film were within this mess  
[0:10:57](https://youtu.be/qLCE8spVX9Q?t=657) of a few MERS but yeah finally we were  
[0:11:01](https://youtu.be/qLCE8spVX9Q?t=661) able to find this fumarole have our  
[0:11:03](https://youtu.be/qLCE8spVX9Q?t=663) female file yeah we can start war  
[0:11:05](https://youtu.be/qLCE8spVX9Q?t=665) King but then we asked ourselves wait  
[0:11:09](https://youtu.be/qLCE8spVX9Q?t=669) how do you even upgrade a printer fumer  
[0:11:11](https://youtu.be/qLCE8spVX9Q?t=671) have have you ever done that I hadn't so  
[0:11:14](https://youtu.be/qLCE8spVX9Q?t=674) we have this file we need to understand  
[0:11:16](https://youtu.be/qLCE8spVX9Q?t=676) to do that and the answer to this  
[0:11:17](https://youtu.be/qLCE8spVX9Q?t=677) question is surprisingly simple  
[0:11:20](https://youtu.be/qLCE8spVX9Q?t=680) well you just print it yeah you see HP  
[0:11:25](https://youtu.be/qLCE8spVX9Q?t=685) define this standard called PCL excel  
[0:11:28](https://youtu.be/qLCE8spVX9Q?t=688) future reference protocol class 2.1  
[0:11:30](https://youtu.be/qLCE8spVX9Q?t=690) supplement that if you are still sane  
[0:11:32](https://youtu.be/qLCE8spVX9Q?t=692) after reading this thing you understand  
[0:11:34](https://youtu.be/qLCE8spVX9Q?t=694) that the printer receives a pretty few  
[0:11:37](https://youtu.be/qLCE8spVX9Q?t=697) more upgrades the same way as it  
[0:11:39](https://youtu.be/qLCE8spVX9Q?t=699) receives a print job a normal print job  
[0:11:41](https://youtu.be/qLCE8spVX9Q?t=701) that's nice so cool if we look at the  
[0:11:46](https://youtu.be/qLCE8spVX9Q?t=706) file that we got from this FTP site this  
[0:11:49](https://youtu.be/qLCE8spVX9Q?t=709) actually correlates pretty well because  
[0:11:50](https://youtu.be/qLCE8spVX9Q?t=710) you see it says pjl it stands for print  
[0:11:53](https://youtu.be/qLCE8spVX9Q?t=713) job language so now that we know that we  
[0:11:57](https://youtu.be/qLCE8spVX9Q?t=717) just need to decode this fumé work we're  
[0:12:00](https://youtu.be/qLCE8spVX9Q?t=720) not going to take you to the process of  
[0:12:02](https://youtu.be/qLCE8spVX9Q?t=722) decoding this thing I'll just give you  
[0:12:04](https://youtu.be/qLCE8spVX9Q?t=724) the highlights this thing is composed of  
[0:12:06](https://youtu.be/qLCE8spVX9Q?t=726) a few decoding decoders like serial C  
[0:12:11](https://youtu.be/qLCE8spVX9Q?t=731) really aligned decoders like null  
[0:12:14](https://youtu.be/qLCE8spVX9Q?t=734) decoder TIF decoder Delta all decoder  
[0:12:17](https://youtu.be/qLCE8spVX9Q?t=737) there's a lot I can say about them but  
[0:12:19](https://youtu.be/qLCE8spVX9Q?t=739) they do something like you know if the  
[0:12:21](https://youtu.be/qLCE8spVX9Q?t=741) previous line was all spaces then if  
[0:12:24](https://youtu.be/qLCE8spVX9Q?t=744) this line is also all spaces just write  
[0:12:26](https://youtu.be/qLCE8spVX9Q?t=746) one instead of the line so you will save  
[0:12:29](https://youtu.be/qLCE8spVX9Q?t=749) some space now this makes a lot of sense  
[0:12:31](https://youtu.be/qLCE8spVX9Q?t=751) if you're talking about the print job  
[0:12:32](https://youtu.be/qLCE8spVX9Q?t=752) because you're expecting to see a lot of  
[0:12:34](https://youtu.be/qLCE8spVX9Q?t=754) empty lines in the in there but when  
[0:12:36](https://youtu.be/qLCE8spVX9Q?t=756) you're talking about binary file it  
[0:12:38](https://youtu.be/qLCE8spVX9Q?t=758) makes absolutely no sense to encode it  
[0:12:41](https://youtu.be/qLCE8spVX9Q?t=761) this way and to that we have to say well  
[0:12:43](https://youtu.be/qLCE8spVX9Q?t=763) if you're a hammer everything looks like  
[0:12:45](https://youtu.be/qLCE8spVX9Q?t=765) a nail and if you're a printer  
[0:12:46](https://youtu.be/qLCE8spVX9Q?t=766) everything looks like a print job and  
[0:12:49](https://youtu.be/qLCE8spVX9Q?t=769) okay we were finally able to decode this  
[0:12:52](https://youtu.be/qLCE8spVX9Q?t=772) thing and we got ourselves what seems to  
[0:12:55](https://youtu.be/qLCE8spVX9Q?t=775) be the few more file and now we can  
[0:12:57](https://youtu.be/qLCE8spVX9Q?t=777) finally start working but how do we  
[0:13:00](https://youtu.be/qLCE8spVX9Q?t=780) analyze this file so we start looking at  
[0:13:03](https://youtu.be/qLCE8spVX9Q?t=783) this file and right in the beginning of  
[0:13:05](https://youtu.be/qLCE8spVX9Q?t=785) it we see something that looks like a  
[0:13:07](https://youtu.be/qLCE8spVX9Q?t=787) table so we're able to parse this thing  
[0:13:10](https://youtu.be/qLCE8spVX9Q?t=790) and to understand that it is a table and  
[0:13:13](https://youtu.be/qLCE8spVX9Q?t=793) this actually is a section table so it  
[0:13:15](https://youtu.be/qLCE8spVX9Q?t=795) means that the big file that we have is  
[0:13:17](https://youtu.be/qLCE8spVX9Q?t=797) actually composed of sections and this  
[0:13:20](https://youtu.be/qLCE8spVX9Q?t=800) table actually tells us stuff like the  
[0:13:22](https://youtu.be/qLCE8spVX9Q?t=802) loading address for each section sorry  
[0:13:24](https://youtu.be/qLCE8spVX9Q?t=804) the section name and the location in  
[0:13:27](https://youtu.be/qLCE8spVX9Q?t=807) binary and this basically enables us to  
[0:13:30](https://youtu.be/qLCE8spVX9Q?t=810) break this big file into small sections  
[0:13:33](https://youtu.be/qLCE8spVX9Q?t=813) and now we can inspect each and every  
[0:13:35](https://youtu.be/qLCE8spVX9Q?t=815) section specifically there's one really  
[0:13:37](https://youtu.be/qLCE8spVX9Q?t=817) big section in there that we're really  
[0:13:39](https://youtu.be/qLCE8spVX9Q?t=819) interested in because it looks to be our  
[0:13:41](https://youtu.be/qLCE8spVX9Q?t=821) actual femur and we start to look at it  
[0:13:44](https://youtu.be/qLCE8spVX9Q?t=824) and when we look at that we see this now  
[0:13:47](https://youtu.be/qLCE8spVX9Q?t=827) this looks promising but something is  
[0:13:49](https://youtu.be/qLCE8spVX9Q?t=829) not right look at this this is the part  
[0:13:54](https://youtu.be/qLCE8spVX9Q?t=834) of the section it clearly says error I  
[0:13:57](https://youtu.be/qLCE8spVX9Q?t=837) don't understand this is the same error  
[0:13:58](https://youtu.be/qLCE8spVX9Q?t=838) message we got from the serial port so  
[0:14:00](https://youtu.be/qLCE8spVX9Q?t=840) yeah that's probably the code that we  
[0:14:03](https://youtu.be/qLCE8spVX9Q?t=843) are looking for right but but it's not  
[0:14:05](https://youtu.be/qLCE8spVX9Q?t=845) exactly there something is missing you  
[0:14:07](https://youtu.be/qLCE8spVX9Q?t=847) see what we can understand its error I  
[0:14:09](https://youtu.be/qLCE8spVX9Q?t=849) don't understand but something is  
[0:14:11](https://youtu.be/qLCE8spVX9Q?t=851) missing bytes are missing and those  
[0:14:12](https://youtu.be/qLCE8spVX9Q?t=852) bytes are consistently consistently  
[0:14:14](https://youtu.be/qLCE8spVX9Q?t=854) missing from the entire file so although  
[0:14:16](https://youtu.be/qLCE8spVX9Q?t=856) we know we are there  
[0:14:18](https://youtu.be/qLCE8spVX9Q?t=858) we still can't analyze this thing until  
[0:14:19](https://youtu.be/qLCE8spVX9Q?t=859) we will be able to fill those missing  
[0:14:22](https://youtu.be/qLCE8spVX9Q?t=862) bytes and now we are trying to  
[0:14:25](https://youtu.be/qLCE8spVX9Q?t=865) understand what is this thing there are  
[0:14:27](https://youtu.be/qLCE8spVX9Q?t=867) a lot of options all of them are crazy  
[0:14:29](https://youtu.be/qLCE8spVX9Q?t=869) but the least craziest option is to  
[0:14:33](https://youtu.be/qLCE8spVX9Q?t=873) understand that this thing is another  
[0:14:34](https://youtu.be/qLCE8spVX9Q?t=874) form of compression because yeah it's  
[0:14:37](https://youtu.be/qLCE8spVX9Q?t=877) just it has to be there is no other  
[0:14:39](https://youtu.be/qLCE8spVX9Q?t=879) option it's really bad compression  
[0:14:42](https://youtu.be/qLCE8spVX9Q?t=882) because when we try to compress this  
[0:14:43](https://youtu.be/qLCE8spVX9Q?t=883) thing with zealey for for example we get  
[0:14:46](https://youtu.be/qLCE8spVX9Q?t=886) 80% better compression and the thing is  
[0:14:48](https://youtu.be/qLCE8spVX9Q?t=888) that we know that we have Z live in the  
[0:14:50](https://youtu.be/qLCE8spVX9Q?t=890) printer because we see the strings to it  
[0:14:51](https://youtu.be/qLCE8spVX9Q?t=891) so why would you use this compression I  
[0:14:54](https://youtu.be/qLCE8spVX9Q?t=894) don't know but it must be a compression  
[0:14:56](https://youtu.be/qLCE8spVX9Q?t=896) now let's try to analyze this thing  
[0:14:58](https://youtu.be/qLCE8spVX9Q?t=898) together here so this is one of the  
[0:15:01](https://youtu.be/qLCE8spVX9Q?t=901) snippets I just showed you before and  
[0:15:03](https://youtu.be/qLCE8spVX9Q?t=903) let's try to analyze it basically it's  
[0:15:06](https://youtu.be/qLCE8spVX9Q?t=906) composed of two parts one part is ASCII  
[0:15:08](https://youtu.be/qLCE8spVX9Q?t=908) characters stuff that we can read right  
[0:15:10](https://youtu.be/qLCE8spVX9Q?t=910) and the other part is non ASCII  
[0:15:13](https://youtu.be/qLCE8spVX9Q?t=913) characters stuff that we can't read  
[0:15:14](https://youtu.be/qLCE8spVX9Q?t=914) those non ASCII characters are actually  
[0:15:16](https://youtu.be/qLCE8spVX9Q?t=916) the missing bytes that we have and we  
[0:15:19](https://youtu.be/qLCE8spVX9Q?t=919) need to understand how to you know  
[0:15:20](https://youtu.be/qLCE8spVX9Q?t=920) understand what they are so what we do  
[0:15:24](https://youtu.be/qLCE8spVX9Q?t=924) is just take this byte view right  
[0:15:27](https://youtu.be/qLCE8spVX9Q?t=927) and take all the ascii characters out of  
[0:15:29](https://youtu.be/qLCE8spVX9Q?t=929) it and now we are left with with our  
[0:15:31](https://youtu.be/qLCE8spVX9Q?t=931) missing bytes right now if you stir this  
[0:15:35](https://youtu.be/qLCE8spVX9Q?t=935) long enough you will start seeing a  
[0:15:36](https://youtu.be/qLCE8spVX9Q?t=936) pattern and let me help you a bit with  
[0:15:39](https://youtu.be/qLCE8spVX9Q?t=939) this because you see this thing is  
[0:15:41](https://youtu.be/qLCE8spVX9Q?t=941) composed of single bytes and double  
[0:15:43](https://youtu.be/qLCE8spVX9Q?t=943) bytes right and the distance between the  
[0:15:46](https://youtu.be/qLCE8spVX9Q?t=946) single bytes looks suspiciously pattern  
[0:15:49](https://youtu.be/qLCE8spVX9Q?t=949) ish I would say like 8 bytes 9 bytes 9  
[0:15:51](https://youtu.be/qLCE8spVX9Q?t=951) by 8 bytes and now try to look at this  
[0:15:53](https://youtu.be/qLCE8spVX9Q?t=953) for a second from a different  
[0:15:55](https://youtu.be/qLCE8spVX9Q?t=955) perspective so from this perspective the  
[0:15:58](https://youtu.be/qLCE8spVX9Q?t=958) pattern starts seeing being more clear  
[0:16:01](https://youtu.be/qLCE8spVX9Q?t=961) right because you see the F 7 and F 7  
[0:16:03](https://youtu.be/qLCE8spVX9Q?t=963) they look the same the FF & FF they look  
[0:16:05](https://youtu.be/qLCE8spVX9Q?t=965) the same but what does it mean well to  
[0:16:08](https://youtu.be/qLCE8spVX9Q?t=968) understand that you need to sharpen your  
[0:16:10](https://youtu.be/qLCE8spVX9Q?t=970) binary view for a second and if you  
[0:16:13](https://youtu.be/qLCE8spVX9Q?t=973) understand that FF for example is just 8  
[0:16:15](https://youtu.be/qLCE8spVX9Q?t=975) 1 bits right and if you do this  
[0:16:18](https://youtu.be/qLCE8spVX9Q?t=978) consistently for every chunk that you  
[0:16:21](https://youtu.be/qLCE8spVX9Q?t=981) have here you will see the pattern and  
[0:16:23](https://youtu.be/qLCE8spVX9Q?t=983) the pattern is that the 0 bit always  
[0:16:25](https://youtu.be/qLCE8spVX9Q?t=985) falls within this 2 bytes hole and that  
[0:16:28](https://youtu.be/qLCE8spVX9Q?t=988) practically means that the first byte is  
[0:16:30](https://youtu.be/qLCE8spVX9Q?t=990) just a bit nap describing the next the  
[0:16:33](https://youtu.be/qLCE8spVX9Q?t=993) following 8 bytes so this is all 9 by  
[0:16:35](https://youtu.be/qLCE8spVX9Q?t=995) chunks and the first byte is just a map  
[0:16:38](https://youtu.be/qLCE8spVX9Q?t=998) of the of the following 8 bytes that's  
[0:16:40](https://youtu.be/qLCE8spVX9Q?t=1000) amazing so now we understand what is 1  
[0:16:43](https://youtu.be/qLCE8spVX9Q?t=1003) byte 1 bytes are and all we need to do  
[0:16:46](https://youtu.be/qLCE8spVX9Q?t=1006) is to understand this 2 bytes what are  
[0:16:49](https://youtu.be/qLCE8spVX9Q?t=1009) those 2 bytes and they must be replaced  
[0:16:51](https://youtu.be/qLCE8spVX9Q?t=1011) for some characters but what are the  
[0:16:53](https://youtu.be/qLCE8spVX9Q?t=1013) replaced 4 that's a big question it took  
[0:16:56](https://youtu.be/qLCE8spVX9Q?t=1016) us some time to understand that and if  
[0:16:59](https://youtu.be/qLCE8spVX9Q?t=1019) you know anything about compression you  
[0:17:01](https://youtu.be/qLCE8spVX9Q?t=1021) know that you don't have a lot of  
[0:17:02](https://youtu.be/qLCE8spVX9Q?t=1022) options here it can either be a forward  
[0:17:04](https://youtu.be/qLCE8spVX9Q?t=1024) or backward pointer it could be some  
[0:17:06](https://youtu.be/qLCE8spVX9Q?t=1026) kind of dictionary or it could be a  
[0:17:08](https://youtu.be/qLCE8spVX9Q?t=1028) sliding window now we could pretty  
[0:17:11](https://youtu.be/qLCE8spVX9Q?t=1031) easily say that it's not a forward and  
[0:17:13](https://youtu.be/qLCE8spVX9Q?t=1033) backward pointer and it's also not a  
[0:17:14](https://youtu.be/qLCE8spVX9Q?t=1034) dictionary because we try to find  
[0:17:16](https://youtu.be/qLCE8spVX9Q?t=1036) references with from within our file and  
[0:17:19](https://youtu.be/qLCE8spVX9Q?t=1039) we can't so the only valid option will  
[0:17:22](https://youtu.be/qLCE8spVX9Q?t=1042) be that this thing is a sliding window  
[0:17:23](https://youtu.be/qLCE8spVX9Q?t=1043) right and equipped with this information  
[0:17:26](https://youtu.be/qLCE8spVX9Q?t=1046) we go to our favorite place to Google  
[0:17:29](https://youtu.be/qLCE8spVX9Q?t=1049) and in some dark corner of the Internet  
[0:17:32](https://youtu.be/qLCE8spVX9Q?t=1052) we find this  
[0:17:34](https://youtu.be/qLCE8spVX9Q?t=1054) Wiki strange wikipage defining something  
[0:17:37](https://youtu.be/qLCE8spVX9Q?t=1057) called the soft disk library format and  
[0:17:39](https://youtu.be/qLCE8spVX9Q?t=1059) this thing within it has a compression  
[0:17:41](https://youtu.be/qLCE8spVX9Q?t=1061) algorithm that looks really familiar and  
[0:17:43](https://youtu.be/qLCE8spVX9Q?t=1063) it looks really like ours I mean really  
[0:17:46](https://youtu.be/qLCE8spVX9Q?t=1066) really like ours I mean it looks exactly  
[0:17:49](https://youtu.be/qLCE8spVX9Q?t=1069) like our compression exactly the same  
[0:17:51](https://youtu.be/qLCE8spVX9Q?t=1071) thing we find it really funny and the  
[0:17:54](https://youtu.be/qLCE8spVX9Q?t=1074) thing is that this thing anybody knows  
[0:17:56](https://youtu.be/qLCE8spVX9Q?t=1076) what soft disk is so it turns out that  
[0:17:59](https://youtu.be/qLCE8spVX9Q?t=1079) this compression algorithm was invented  
[0:18:01](https://youtu.be/qLCE8spVX9Q?t=1081) by soft disk and it was used once in  
[0:18:04](https://youtu.be/qLCE8spVX9Q?t=1084) history once in the past you will never  
[0:18:07](https://youtu.be/qLCE8spVX9Q?t=1087) guess where that's because it was used  
[0:18:10](https://youtu.be/qLCE8spVX9Q?t=1090) in Commander Keen yeah now how did this  
[0:18:18](https://youtu.be/qLCE8spVX9Q?t=1098) make its way into an HP printer I have  
[0:18:22](https://youtu.be/qLCE8spVX9Q?t=1102) no idea but it did so if you want to  
[0:18:26](https://youtu.be/qLCE8spVX9Q?t=1106) follow up on that feel free and now once  
[0:18:30](https://youtu.be/qLCE8spVX9Q?t=1110) we have we're equipped with this  
[0:18:32](https://youtu.be/qLCE8spVX9Q?t=1112) information we actually know what those  
[0:18:34](https://youtu.be/qLCE8spVX9Q?t=1114) two bytes are I mean they are just  
[0:18:36](https://youtu.be/qLCE8spVX9Q?t=1116) composed of you know this this bitmap  
[0:18:39](https://youtu.be/qLCE8spVX9Q?t=1119) which stands for two values a window  
[0:18:42](https://youtu.be/qLCE8spVX9Q?t=1122) location and a data length and that's  
[0:18:43](https://youtu.be/qLCE8spVX9Q?t=1123) basically all the information we  
[0:18:45](https://youtu.be/qLCE8spVX9Q?t=1125) required in order to open this thing let  
[0:18:47](https://youtu.be/qLCE8spVX9Q?t=1127) me show you how it works so we have an  
[0:18:49](https://youtu.be/qLCE8spVX9Q?t=1129) input text and output text and a sliding  
[0:18:51](https://youtu.be/qLCE8spVX9Q?t=1131) window and let's try to compress this  
[0:18:53](https://youtu.be/qLCE8spVX9Q?t=1133) string here abcdefg so what we do is the  
[0:18:57](https://youtu.be/qLCE8spVX9Q?t=1137) first byte as I said is a bitmap so we  
[0:18:59](https://youtu.be/qLCE8spVX9Q?t=1139) just leave it open for now we don't know  
[0:19:01](https://youtu.be/qLCE8spVX9Q?t=1141) what the value will be and we start  
[0:19:02](https://youtu.be/qLCE8spVX9Q?t=1142) working so a we write it boiling in the  
[0:19:05](https://youtu.be/qLCE8spVX9Q?t=1145) output text and sliding windows aims for  
[0:19:07](https://youtu.be/qLCE8spVX9Q?t=1147) BCD and then we get to a a is already  
[0:19:10](https://youtu.be/qLCE8spVX9Q?t=1150) present in the sliding window so we  
[0:19:12](https://youtu.be/qLCE8spVX9Q?t=1152) don't need to write it in the output  
[0:19:14](https://youtu.be/qLCE8spVX9Q?t=1154) text and then B again is just following  
[0:19:16](https://youtu.be/qLCE8spVX9Q?t=1156) a and then when we eat E we just write  
[0:19:19](https://youtu.be/qLCE8spVX9Q?t=1159) zero zero zero two that means go to the  
[0:19:22](https://youtu.be/qLCE8spVX9Q?t=1162) sliding window at position zero and take  
[0:19:24](https://youtu.be/qLCE8spVX9Q?t=1164) the first two bytes that's that's the  
[0:19:26](https://youtu.be/qLCE8spVX9Q?t=1166) replacement that we were looking for  
[0:19:28](https://youtu.be/qLCE8spVX9Q?t=1168) right and then we continue e FG and once  
[0:19:31](https://youtu.be/qLCE8spVX9Q?t=1171) we have that we can just put our bitmap  
[0:19:33](https://youtu.be/qLCE8spVX9Q?t=1173) here see that the replacement was at  
[0:19:36](https://youtu.be/qLCE8spVX9Q?t=1176) this position and we have our bitmap  
[0:19:38](https://youtu.be/qLCE8spVX9Q?t=1178) that's pretty easy looking at that way  
[0:19:41](https://youtu.be/qLCE8spVX9Q?t=1181) of course when you're doing it in  
[0:19:42](https://youtu.be/qLCE8spVX9Q?t=1182) Reverse it's kind of a bit more  
[0:19:46](https://youtu.be/qLCE8spVX9Q?t=1186) but with this we were able to open the  
[0:19:49](https://youtu.be/qLCE8spVX9Q?t=1189) Fillmore file and now we have a full  
[0:19:51](https://youtu.be/qLCE8spVX9Q?t=1191) Fillmore file that we can finally  
[0:19:54](https://youtu.be/qLCE8spVX9Q?t=1194) finally analyze and now that we have  
[0:19:56](https://youtu.be/qLCE8spVX9Q?t=1196) that we need to understand what  
[0:19:58](https://youtu.be/qLCE8spVX9Q?t=1198) operating system is this monster using  
[0:20:01](https://youtu.be/qLCE8spVX9Q?t=1201) well we spent quite a few time on that  
[0:20:04](https://youtu.be/qLCE8spVX9Q?t=1204) but let me give you a brief explanation  
[0:20:06](https://youtu.be/qLCE8spVX9Q?t=1206) so basically this thing as an operating  
[0:20:09](https://youtu.be/qLCE8spVX9Q?t=1209) system called tread X it's a real-time  
[0:20:11](https://youtu.be/qLCE8spVX9Q?t=1211) operating system and the CPU is running  
[0:20:13](https://youtu.be/qLCE8spVX9Q?t=1213) on as arm9 big-endian  
[0:20:15](https://youtu.be/qLCE8spVX9Q?t=1215) something really sexy and then there's  
[0:20:19](https://youtu.be/qLCE8spVX9Q?t=1219) some system and stuff here some common  
[0:20:21](https://youtu.be/qLCE8spVX9Q?t=1221) libraries and tasks which are the rat  
[0:20:24](https://youtu.be/qLCE8spVX9Q?t=1224) equivalent of processes in normal  
[0:20:26](https://youtu.be/qLCE8spVX9Q?t=1226) operating systems now the for system we  
[0:20:29](https://youtu.be/qLCE8spVX9Q?t=1229) have two-stage bootloader and some  
[0:20:31](https://youtu.be/qLCE8spVX9Q?t=1231) networking functionality is some other  
[0:20:33](https://youtu.be/qLCE8spVX9Q?t=1233) stuff we have a lot of common libraries  
[0:20:36](https://youtu.be/qLCE8spVX9Q?t=1236) just common libraries and then we have  
[0:20:38](https://youtu.be/qLCE8spVX9Q?t=1238) tasks and once we have this picture in  
[0:20:41](https://youtu.be/qLCE8spVX9Q?t=1241) mind we know that we have to focus on  
[0:20:43](https://youtu.be/qLCE8spVX9Q?t=1243) these specific tasks because this is  
[0:20:46](https://youtu.be/qLCE8spVX9Q?t=1246) what we're looking for t30 tax log t  
[0:20:48](https://youtu.be/qLCE8spVX9Q?t=1248) modem all the rest we can pretty much  
[0:20:50](https://youtu.be/qLCE8spVX9Q?t=1250) put aside right so we need to start  
[0:20:53](https://youtu.be/qLCE8spVX9Q?t=1253) analyzing them but just a second before  
[0:20:55](https://youtu.be/qLCE8spVX9Q?t=1255) we do that we notice something that  
[0:20:57](https://youtu.be/qLCE8spVX9Q?t=1257) looks fishy you see this thing has a  
[0:21:01](https://youtu.be/qLCE8spVX9Q?t=1261) spider monkey library now if you're not  
[0:21:03](https://youtu.be/qLCE8spVX9Q?t=1263) familiar with this spider monkey is the  
[0:21:05](https://youtu.be/qLCE8spVX9Q?t=1265) most illa inflammation of JavaScript  
[0:21:07](https://youtu.be/qLCE8spVX9Q?t=1267) it's used in Firefox and we were  
[0:21:09](https://youtu.be/qLCE8spVX9Q?t=1269) thinking to ourselves why would the  
[0:21:11](https://youtu.be/qLCE8spVX9Q?t=1271) printer use JavaScript it makes  
[0:21:14](https://youtu.be/qLCE8spVX9Q?t=1274) absolutely no sense and we were  
[0:21:18](https://youtu.be/qLCE8spVX9Q?t=1278) intrigued by this question so we tried  
[0:21:20](https://youtu.be/qLCE8spVX9Q?t=1280) looking at where does this thing  
[0:21:21](https://youtu.be/qLCE8spVX9Q?t=1281) implement JavaScript and it turns out  
[0:21:23](https://youtu.be/qLCE8spVX9Q?t=1283) that the answer is simple it uses that  
[0:21:25](https://youtu.be/qLCE8spVX9Q?t=1285) in a feature called pack pac-10 for  
[0:21:29](https://youtu.be/qLCE8spVX9Q?t=1289) proxy Auto configuration it uses  
[0:21:32](https://youtu.be/qLCE8spVX9Q?t=1292) JavaScript in order to auto configure  
[0:21:34](https://youtu.be/qLCE8spVX9Q?t=1294) proxy is a pretty pretty common thing  
[0:21:36](https://youtu.be/qLCE8spVX9Q?t=1296) and the thing is that the top layer  
[0:21:39](https://youtu.be/qLCE8spVX9Q?t=1299) functionality of this thing was written  
[0:21:40](https://youtu.be/qLCE8spVX9Q?t=1300) by HP and when we're looking at this top  
[0:21:43](https://youtu.be/qLCE8spVX9Q?t=1303) layer functionality we see this this  
[0:21:47](https://youtu.be/qLCE8spVX9Q?t=1307) thing before it does the functionality  
[0:21:51](https://youtu.be/qLCE8spVX9Q?t=1311) it can it contacts this URL fake URL one  
[0:21:54](https://youtu.be/qLCE8spVX9Q?t=1314) two three four com  
[0:21:55](https://youtu.be/qLCE8spVX9Q?t=1315) it does nothing with it  
[0:21:56](https://youtu.be/qLCE8spVX9Q?t=1316) it just it just contacts to it and and  
[0:21:58](https://youtu.be/qLCE8spVX9Q?t=1318) that's it like some sort of sanity test  
[0:22:00](https://youtu.be/qLCE8spVX9Q?t=1320) maybe I don't know but the interesting  
[0:22:03](https://youtu.be/qLCE8spVX9Q?t=1323) is thing is does anybody know who owns  
[0:22:05](https://youtu.be/qLCE8spVX9Q?t=1325) the domain fake URL one two three four  
[0:22:07](https://youtu.be/qLCE8spVX9Q?t=1327) comm any guesses how did you know yes it  
[0:22:14](https://youtu.be/qLCE8spVX9Q?t=1334) wasn't registered so we just registered  
[0:22:16](https://youtu.be/qLCE8spVX9Q?t=1336) this domain so if anybody is interested  
[0:22:22](https://youtu.be/qLCE8spVX9Q?t=1342) in a domain please contact me I have a  
[0:22:25](https://youtu.be/qLCE8spVX9Q?t=1345) very good price for this domain  
[0:22:26](https://youtu.be/qLCE8spVX9Q?t=1346) basically every HP printer in the world  
[0:22:29](https://youtu.be/qLCE8spVX9Q?t=1349) now connects to my domain so that's  
[0:22:33](https://youtu.be/qLCE8spVX9Q?t=1353) really nice  
[0:22:34](https://youtu.be/qLCE8spVX9Q?t=1354) and now after we've done all that we  
[0:22:38](https://youtu.be/qLCE8spVX9Q?t=1358) need to actually start looking at facts  
[0:22:40](https://youtu.be/qLCE8spVX9Q?t=1360) and for that I will hand it over to Al  
[0:22:46](https://youtu.be/qLCE8spVX9Q?t=1366) [Music]  
[0:22:47](https://youtu.be/qLCE8spVX9Q?t=1367) so so finish messing around we can  
[0:22:55](https://youtu.be/qLCE8spVX9Q?t=1375) actually focus on T 30 T 30 the standard  
[0:22:58](https://youtu.be/qLCE8spVX9Q?t=1378) defines the facts for a call it's called  
[0:23:00](https://youtu.be/qLCE8spVX9Q?t=1380) itu-t recommendation T 14 in its full  
[0:23:03](https://youtu.be/qLCE8spVX9Q?t=1383) name thus I define the procedures and  
[0:23:06](https://youtu.be/qLCE8spVX9Q?t=1386) phases and messages needed in order to  
[0:23:12](https://youtu.be/qLCE8spVX9Q?t=1392) Center to see the fax document it's  
[0:23:14](https://youtu.be/qLCE8spVX9Q?t=1394) actually a huge standard it has a PDF  
[0:23:16](https://youtu.be/qLCE8spVX9Q?t=1396) we've all 300 pages we read through it  
[0:23:20](https://youtu.be/qLCE8spVX9Q?t=1400) all and it's complicated under standard  
[0:23:23](https://youtu.be/qLCE8spVX9Q?t=1403) itself was first design on 1985 and it  
[0:23:26](https://youtu.be/qLCE8spVX9Q?t=1406) was last updated move in a decade ago so  
[0:23:29](https://youtu.be/qLCE8spVX9Q?t=1409) from our perspective it was like it's an  
[0:23:32](https://youtu.be/qLCE8spVX9Q?t=1412) old standard it's complicated we're  
[0:23:34](https://youtu.be/qLCE8spVX9Q?t=1414) going to find vulnerabilities in it  
[0:23:36](https://youtu.be/qLCE8spVX9Q?t=1416) while you read through the standard we  
[0:23:39](https://youtu.be/qLCE8spVX9Q?t=1419) started to reverse-engineer the teeth  
[0:23:41](https://youtu.be/qLCE8spVX9Q?t=1421) ready state machine in the framework and  
[0:23:43](https://youtu.be/qLCE8spVX9Q?t=1423) you can look to see how it looks like  
[0:23:45](https://youtu.be/qLCE8spVX9Q?t=1425) don't let this we have you folio as most  
[0:23:48](https://youtu.be/qLCE8spVX9Q?t=1428) of the code books you see over there  
[0:23:49](https://youtu.be/qLCE8spVX9Q?t=1429) contains additional state machines  
[0:23:52](https://youtu.be/qLCE8spVX9Q?t=1432) inside them and this means we're going  
[0:23:54](https://youtu.be/qLCE8spVX9Q?t=1434) to have a pretty rough job reversing it  
[0:23:57](https://youtu.be/qLCE8spVX9Q?t=1437) as if that wasn't enough he turns out  
[0:24:00](https://youtu.be/qLCE8spVX9Q?t=1440) the femur heavily relies on function  
[0:24:03](https://youtu.be/qLCE8spVX9Q?t=1443) pointers in global  
[0:24:04](https://youtu.be/qLCE8spVX9Q?t=1444) variables and it's going to be a real  
[0:24:06](https://youtu.be/qLCE8spVX9Q?t=1446) mess to statically reverse engineering  
[0:24:08](https://youtu.be/qLCE8spVX9Q?t=1448) this thing so we decided to change  
[0:24:11](https://youtu.be/qLCE8spVX9Q?t=1451) tactics  
[0:24:11](https://youtu.be/qLCE8spVX9Q?t=1451) we are going to use dynamic reverse  
[0:24:15](https://youtu.be/qLCE8spVX9Q?t=1455) engineering  
[0:24:16](https://youtu.be/qLCE8spVX9Q?t=1456) we'll need a debugger so how can you  
[0:24:20](https://youtu.be/qLCE8spVX9Q?t=1460) debug a printer we can't connect to it  
[0:24:23](https://youtu.be/qLCE8spVX9Q?t=1463) yaniv already said but we try to connect  
[0:24:26](https://youtu.be/qLCE8spVX9Q?t=1466) to the JTAG and the serial port but that  
[0:24:29](https://youtu.be/qLCE8spVX9Q?t=1469) word really helpful we then try to look  
[0:24:32](https://youtu.be/qLCE8spVX9Q?t=1472) for ability in gdb stop we could connect  
[0:24:34](https://youtu.be/qLCE8spVX9Q?t=1474) to but we couldn't find one either at  
[0:24:37](https://youtu.be/qLCE8spVX9Q?t=1477) this point we should remember that I  
[0:24:39](https://youtu.be/qLCE8spVX9Q?t=1479) can't simply load a debugger because we  
[0:24:42](https://youtu.be/qLCE8spVX9Q?t=1482) don't have any control over the  
[0:24:43](https://youtu.be/qLCE8spVX9Q?t=1483) execution flow and even if we could load  
[0:24:46](https://youtu.be/qLCE8spVX9Q?t=1486) a debugger the printer uses the harbor  
[0:24:48](https://youtu.be/qLCE8spVX9Q?t=1488) watchdog this soon as the CPU will halt  
[0:24:51](https://youtu.be/qLCE8spVX9Q?t=1491) or enter a netlist loop the watchdog  
[0:24:54](https://youtu.be/qLCE8spVX9Q?t=1494) will trigger a reboot and a breakpoint  
[0:24:56](https://youtu.be/qLCE8spVX9Q?t=1496) usually halts the program so we can  
[0:25:00](https://youtu.be/qLCE8spVX9Q?t=1500) simply hit breakpoints we are the  
[0:25:02](https://youtu.be/qLCE8spVX9Q?t=1502) watchdog kicking us out at this point we  
[0:25:05](https://youtu.be/qLCE8spVX9Q?t=1505) decided to split it parts if we could  
[0:25:08](https://youtu.be/qLCE8spVX9Q?t=1508) find a code execution vulnerability we  
[0:25:10](https://youtu.be/qLCE8spVX9Q?t=1510) could try to exploit it and load the  
[0:25:12](https://youtu.be/qLCE8spVX9Q?t=1512) debugger at this point we had a stroke  
[0:25:16](https://youtu.be/qLCE8spVX9Q?t=1516) of luck actually we believe that luck is  
[0:25:18](https://youtu.be/qLCE8spVX9Q?t=1518) an important part of every research  
[0:25:20](https://youtu.be/qLCE8spVX9Q?t=1520) project and we sure had our stroke of  
[0:25:23](https://youtu.be/qLCE8spVX9Q?t=1523) luck on the 19th of July send you a  
[0:25:25](https://youtu.be/qLCE8spVX9Q?t=1525) publish the curve an ability called  
[0:25:27](https://youtu.be/qLCE8spVX9Q?t=1527) devil's Ivy Davis IV is actually a  
[0:25:30](https://youtu.be/qLCE8spVX9Q?t=1530) remote code execution vulnerability in  
[0:25:32](https://youtu.be/qLCE8spVX9Q?t=1532) the gzip open source library embedded  
[0:25:35](https://youtu.be/qLCE8spVX9Q?t=1535) devices in document included tend to  
[0:25:38](https://youtu.be/qLCE8spVX9Q?t=1538) implement embedded web server inside  
[0:25:40](https://youtu.be/qLCE8spVX9Q?t=1540) them so you could manage and configure  
[0:25:43](https://youtu.be/qLCE8spVX9Q?t=1543) your embedded device in our case the  
[0:25:46](https://youtu.be/qLCE8spVX9Q?t=1546) printer uses gee soap in its web server  
[0:25:48](https://youtu.be/qLCE8spVX9Q?t=1548) after we dug in a bit deeper we saw that  
[0:25:51](https://youtu.be/qLCE8spVX9Q?t=1551) we had a jackpot  
[0:25:52](https://youtu.be/qLCE8spVX9Q?t=1552) our Peter is fun over the David's IV and  
[0:25:55](https://youtu.be/qLCE8spVX9Q?t=1555) we now have how I debugging  
[0:25:56](https://youtu.be/qLCE8spVX9Q?t=1556) vulnerability so for those of you who  
[0:26:00](https://youtu.be/qLCE8spVX9Q?t=1560) are not familiar of Devon's IV this is a  
[0:26:02](https://youtu.be/qLCE8spVX9Q?t=1562) relevant piece of code and here is the  
[0:26:04](https://youtu.be/qLCE8spVX9Q?t=1564) vulnerability itself the bad part about  
[0:26:07](https://youtu.be/qLCE8spVX9Q?t=1567) this vulnerability is that it's assigned  
[0:26:09](https://youtu.be/qLCE8spVX9Q?t=1569) in detail under flow and this means we  
[0:26:13](https://youtu.be/qLCE8spVX9Q?t=1573) need to send roughly 2gb bytes of data  
[0:26:15](https://youtu.be/qLCE8spVX9Q?t=1575) in order to exploit it  
[0:26:18](https://youtu.be/qLCE8spVX9Q?t=1578) I don't know if you're familiar with the  
[0:26:19](https://youtu.be/qLCE8spVX9Q?t=1579) daily weights of printers however  
[0:26:22](https://youtu.be/qLCE8spVX9Q?t=1582) Twitter's are pretty slow so after many  
[0:26:26](https://youtu.be/qLCE8spVX9Q?t=1586) optimization rounds you wanted to reduce  
[0:26:29](https://youtu.be/qLCE8spVX9Q?t=1589) the transmission time to roughly seven  
[0:26:32](https://youtu.be/qLCE8spVX9Q?t=1592) minutes so it's successful exploit took  
[0:26:35](https://youtu.be/qLCE8spVX9Q?t=1595) us seven minutes and this practically  
[0:26:38](https://youtu.be/qLCE8spVX9Q?t=1598) signals the end of our stock of luck  
[0:26:40](https://youtu.be/qLCE8spVX9Q?t=1600) because our exploit had several side  
[0:26:43](https://youtu.be/qLCE8spVX9Q?t=1603) effects on top of them so after each  
[0:26:45](https://youtu.be/qLCE8spVX9Q?t=1605) successful exploit we're going to have a  
[0:26:47](https://youtu.be/qLCE8spVX9Q?t=1607) grace period of three to ten minutes and  
[0:26:49](https://youtu.be/qLCE8spVX9Q?t=1609) then the printer crashes so we waited a  
[0:26:54](https://youtu.be/qLCE8spVX9Q?t=1614) lot of seven minutes in research but at  
[0:26:59](https://youtu.be/qLCE8spVX9Q?t=1619) least we have an ability we can try to  
[0:27:02](https://youtu.be/qLCE8spVX9Q?t=1622) use it for e buggying it's better than  
[0:27:04](https://youtu.be/qLCE8spVX9Q?t=1624) nothing so we had pretty much we had  
[0:27:08](https://youtu.be/qLCE8spVX9Q?t=1628) several debugging challenges so we need  
[0:27:11](https://youtu.be/qLCE8spVX9Q?t=1631) to focus up originally we wanted to read  
[0:27:14](https://youtu.be/qLCE8spVX9Q?t=1634) ram in right round soak a dynamically  
[0:27:16](https://youtu.be/qLCE8spVX9Q?t=1636) reverse-engineer the t30 state machine  
[0:27:18](https://youtu.be/qLCE8spVX9Q?t=1638) so now we have a control of the  
[0:27:21](https://youtu.be/qLCE8spVX9Q?t=1641) execution flow you can use there is Ivy  
[0:27:22](https://youtu.be/qLCE8spVX9Q?t=1642) we can try to exploit it in order to  
[0:27:25](https://youtu.be/qLCE8spVX9Q?t=1645) load a debugger phone once loaded we'll  
[0:27:29](https://youtu.be/qLCE8spVX9Q?t=1649) need to tell the MP you what our  
[0:27:30](https://youtu.be/qLCE8spVX9Q?t=1650) debugger is were free of execution so it  
[0:27:33](https://youtu.be/qLCE8spVX9Q?t=1653) get its privileges and when we start  
[0:27:36](https://youtu.be/qLCE8spVX9Q?t=1656) executing our debugger we need to  
[0:27:39](https://youtu.be/qLCE8spVX9Q?t=1659) actually install it and blend it inside  
[0:27:42](https://youtu.be/qLCE8spVX9Q?t=1662) the firmware address space because we  
[0:27:45](https://youtu.be/qLCE8spVX9Q?t=1665) want to connect to this debugger and it  
[0:27:47](https://youtu.be/qLCE8spVX9Q?t=1667) will you don't want it to crash the  
[0:27:49](https://youtu.be/qLCE8spVX9Q?t=1669) printer so it should natively blend in  
[0:27:52](https://youtu.be/qLCE8spVX9Q?t=1672) signed a few more at this space we  
[0:27:55](https://youtu.be/qLCE8spVX9Q?t=1675) couldn't find any known debugger we know  
[0:27:58](https://youtu.be/qLCE8spVX9Q?t=1678) that does it and my battled always tells  
[0:28:00](https://youtu.be/qLCE8spVX9Q?t=1680) me to stop reinventing the wheel and is  
[0:28:03](https://youtu.be/qLCE8spVX9Q?t=1683) correct because wheels are not very  
[0:28:06](https://youtu.be/qLCE8spVX9Q?t=1686) useful so we reinvented a debugger  
[0:28:09](https://youtu.be/qLCE8spVX9Q?t=1689) instead so meet Scout Scott is an  
[0:28:14](https://youtu.be/qLCE8spVX9Q?t=1694) instruction based debugger but we've  
[0:28:15](https://youtu.be/qLCE8spVX9Q?t=1695) developed it currently supports Intel  
[0:28:17](https://youtu.be/qLCE8spVX9Q?t=1697) CPUs as well as RM and in fact it even  
[0:28:20](https://youtu.be/qLCE8spVX9Q?t=1700) supports aren't some mode I don't really  
[0:28:24](https://youtu.be/qLCE8spVX9Q?t=1704) like this mode but that's what the  
[0:28:26](https://youtu.be/qLCE8spVX9Q?t=1706) printer uses so you get it as a bonus on  
[0:28:29](https://youtu.be/qLCE8spVX9Q?t=1709) a previous research  
[0:28:31](https://youtu.be/qLCE8spVX9Q?t=1711) we use actually a prototype version of  
[0:28:33](https://youtu.be/qLCE8spVX9Q?t=1713) Scout in a Linux kernel environment in  
[0:28:35](https://youtu.be/qLCE8spVX9Q?t=1715) which we loaded Scout is a Linux kernel  
[0:28:37](https://youtu.be/qLCE8spVX9Q?t=1717) driver to debug RPE  
[0:28:39](https://youtu.be/qLCE8spVX9Q?t=1719) this time we used cat in its embedded  
[0:28:43](https://youtu.be/qLCE8spVX9Q?t=1723) environment but in this environment we  
[0:28:53](https://youtu.be/qLCE8spVX9Q?t=1733) use Scout with a fully position  
[0:28:56](https://youtu.be/qLCE8spVX9Q?t=1736) independent compilation it actually uses  
[0:28:58](https://youtu.be/qLCE8spVX9Q?t=1738) its own global of the table when we try  
[0:29:01](https://youtu.be/qLCE8spVX9Q?t=1741) to locate and execute functions from the  
[0:29:04](https://youtu.be/qLCE8spVX9Q?t=1744) framework itself all you have to do in  
[0:29:06](https://youtu.be/qLCE8spVX9Q?t=1746) order to use Scout is to compile it and  
[0:29:08](https://youtu.be/qLCE8spVX9Q?t=1748) supplied with the addresses in the  
[0:29:09](https://youtu.be/qLCE8spVX9Q?t=1749) framework of usual framer functions such  
[0:29:12](https://youtu.be/qLCE8spVX9Q?t=1752) as socket bind mem copy or even sleep  
[0:29:16](https://youtu.be/qLCE8spVX9Q?t=1756) once compiled you throw the compiled  
[0:29:18](https://youtu.be/qLCE8spVX9Q?t=1758) binary somewhere inside the other space  
[0:29:21](https://youtu.be/qLCE8spVX9Q?t=1761) of your target and you have it once  
[0:29:23](https://youtu.be/qLCE8spVX9Q?t=1763) executed Scout will create a network  
[0:29:27](https://youtu.be/qLCE8spVX9Q?t=1767) server and wait for instructions because  
[0:29:29](https://youtu.be/qLCE8spVX9Q?t=1769) it's an instruction based debugger by  
[0:29:31](https://youtu.be/qLCE8spVX9Q?t=1771) remotely connecting that the newly  
[0:29:33](https://youtu.be/qLCE8spVX9Q?t=1773) created network server we can now issue  
[0:29:36](https://youtu.be/qLCE8spVX9Q?t=1776) instructions to read Ram write RAM or  
[0:29:39](https://youtu.be/qLCE8spVX9Q?t=1779) any other extension you wish to  
[0:29:40](https://youtu.be/qLCE8spVX9Q?t=1780) implement it's extendable in checkpoint  
[0:29:43](https://youtu.be/qLCE8spVX9Q?t=1783) user to believe in sharing with the  
[0:29:45](https://youtu.be/qLCE8spVX9Q?t=1785) community so we can find Scout in our  
[0:29:47](https://youtu.be/qLCE8spVX9Q?t=1787) github account it includes an embedded  
[0:29:49](https://youtu.be/qLCE8spVX9Q?t=1789) environment tutorials and even the Linux  
[0:29:52](https://youtu.be/qLCE8spVX9Q?t=1792) kernel driver we use for previous  
[0:29:54](https://youtu.be/qLCE8spVX9Q?t=1794) research at this point of the topic we  
[0:29:59](https://youtu.be/qLCE8spVX9Q?t=1799) call it many different subjects but you  
[0:30:02](https://youtu.be/qLCE8spVX9Q?t=1802) haven't covered yet the most important  
[0:30:04](https://youtu.be/qLCE8spVX9Q?t=1804) thing how facts actually works using  
[0:30:07](https://youtu.be/qLCE8spVX9Q?t=1807) Scout we were able to dynamically  
[0:30:09](https://youtu.be/qLCE8spVX9Q?t=1809) reverse-engineer the framework so let us  
[0:30:12](https://youtu.be/qLCE8spVX9Q?t=1812) now tell you how facts actually works in  
[0:30:17](https://youtu.be/qLCE8spVX9Q?t=1817) order to set of facts I need a fax  
[0:30:19](https://youtu.be/qLCE8spVX9Q?t=1819) machine it's going to be sent to the  
[0:30:22](https://youtu.be/qLCE8spVX9Q?t=1822) receivers modem the modem will transfer  
[0:30:25](https://youtu.be/qLCE8spVX9Q?t=1825) packets to the CPU which handles the t30  
[0:30:27](https://youtu.be/qLCE8spVX9Q?t=1827) state machine and later on the data will  
[0:30:30](https://youtu.be/qLCE8spVX9Q?t=1830) be handled for processing and printing  
[0:30:34](https://youtu.be/qLCE8spVX9Q?t=1834) when we start interacting between both  
[0:30:37](https://youtu.be/qLCE8spVX9Q?t=1837) of the modems  
[0:30:38](https://youtu.be/qLCE8spVX9Q?t=1838) we have network interaction we have  
[0:30:41](https://youtu.be/qLCE8spVX9Q?t=1841) throw being and Reggie  
[0:30:42](https://youtu.be/qLCE8spVX9Q?t=1842) we have a equalizer and echo canceller  
[0:30:45](https://youtu.be/qLCE8spVX9Q?t=1845) and we have additional trainings you  
[0:30:48](https://youtu.be/qLCE8spVX9Q?t=1848) should be quite familiar of these four  
[0:30:50](https://youtu.be/qLCE8spVX9Q?t=1850) phases they actually sound like this  
[0:30:55](https://youtu.be/qLCE8spVX9Q?t=1855) what would be actually done was to  
[0:30:58](https://youtu.be/qLCE8spVX9Q?t=1858) create an hdl-c tonic using this hdl-c  
[0:31:01](https://youtu.be/qLCE8spVX9Q?t=1861) tunnel we are able now to send our t30  
[0:31:04](https://youtu.be/qLCE8spVX9Q?t=1864) packets as hdl-c data grounds from our  
[0:31:08](https://youtu.be/qLCE8spVX9Q?t=1868) fax machine to the receive a fax machine  
[0:31:11](https://youtu.be/qLCE8spVX9Q?t=1871) t30 itself has many faces of its own on  
[0:31:14](https://youtu.be/qLCE8spVX9Q?t=1874) face a we send our caller ID it's 20  
[0:31:18](https://youtu.be/qLCE8spVX9Q?t=1878) bytes stream we can send whatever we  
[0:31:21](https://youtu.be/qLCE8spVX9Q?t=1881) want on face bo we negotiate our  
[0:31:23](https://youtu.be/qLCE8spVX9Q?t=1883) capabilities and tracy is the most  
[0:31:26](https://youtu.be/qLCE8spVX9Q?t=1886) important phase of them all because here  
[0:31:28](https://youtu.be/qLCE8spVX9Q?t=1888) we actually send the data itself so our  
[0:31:31](https://youtu.be/qLCE8spVX9Q?t=1891) document is going to be sent line by  
[0:31:33](https://youtu.be/qLCE8spVX9Q?t=1893) line page by page until it finally  
[0:31:36](https://youtu.be/qLCE8spVX9Q?t=1896) receive and then face deal we finish we  
[0:31:39](https://youtu.be/qLCE8spVX9Q?t=1899) send arcs we receive the acts and that's  
[0:31:41](https://youtu.be/qLCE8spVX9Q?t=1901) it so let us now see how a normal black  
[0:31:45](https://youtu.be/qLCE8spVX9Q?t=1905) and white fats document is going to be  
[0:31:48](https://youtu.be/qLCE8spVX9Q?t=1908) sent for this follicle so here's our  
[0:31:51](https://youtu.be/qLCE8spVX9Q?t=1911) document it will go through the HPLC  
[0:31:54](https://youtu.be/qLCE8spVX9Q?t=1914) tunnel the data will be transferred  
[0:31:56](https://youtu.be/qLCE8spVX9Q?t=1916) using phase C and the received result  
[0:31:58](https://youtu.be/qLCE8spVX9Q?t=1918) looks like this we actually send the  
[0:32:02](https://youtu.be/qLCE8spVX9Q?t=1922) data of a tiff file format a compressed  
[0:32:05](https://youtu.be/qLCE8spVX9Q?t=1925) in g3 of G for compression layers and if  
[0:32:09](https://youtu.be/qLCE8spVX9Q?t=1929) you think with something here is missing  
[0:32:11](https://youtu.be/qLCE8spVX9Q?t=1931) then you're correct we can't cut to all  
[0:32:14](https://youtu.be/qLCE8spVX9Q?t=1934) the heroes of the defile the printer  
[0:32:16](https://youtu.be/qLCE8spVX9Q?t=1936) actually builds them itself using data  
[0:32:19](https://youtu.be/qLCE8spVX9Q?t=1939) we negotiated on phase a and phase B so  
[0:32:22](https://youtu.be/qLCE8spVX9Q?t=1942) from an attackers perspective either  
[0:32:24](https://youtu.be/qLCE8spVX9Q?t=1944) partially bad news  
[0:32:25](https://youtu.be/qLCE8spVX9Q?t=1945) there are many vulnerabilities and TIFF  
[0:32:28](https://youtu.be/qLCE8spVX9Q?t=1948) parcels however we usually require us to  
[0:32:31](https://youtu.be/qLCE8spVX9Q?t=1951) control the hero this time we only  
[0:32:34](https://youtu.be/qLCE8spVX9Q?t=1954) control the data itself so we're a bit  
[0:32:36](https://youtu.be/qLCE8spVX9Q?t=1956) limited and after we finish building up  
[0:32:39](https://youtu.be/qLCE8spVX9Q?t=1959) and processing the TIFF file it's going  
[0:32:41](https://youtu.be/qLCE8spVX9Q?t=1961) to be sent for printing you know because  
[0:32:45](https://youtu.be/qLCE8spVX9Q?t=1965) that's what normal people do with fax  
[0:32:47](https://youtu.be/qLCE8spVX9Q?t=1967) documents and here's where it becomes  
[0:32:51](https://youtu.be/qLCE8spVX9Q?t=1971) really interesting because we figured  
[0:32:54](https://youtu.be/qLCE8spVX9Q?t=1974) out where t30 had  
[0:32:55](https://youtu.be/qLCE8spVX9Q?t=1975) extensions for it and one of the  
[0:32:58](https://youtu.be/qLCE8spVX9Q?t=1978) extensions can you guess  
[0:33:00](https://youtu.be/qLCE8spVX9Q?t=1980) well the extension is color extension  
[0:33:05](https://youtu.be/qLCE8spVX9Q?t=1985) that I didn't know that taxes can be  
[0:33:08](https://youtu.be/qLCE8spVX9Q?t=1988) colorful but it's a thing so let's see  
[0:33:11](https://youtu.be/qLCE8spVX9Q?t=1991) how a colorful fax is going to be sent  
[0:33:14](https://youtu.be/qLCE8spVX9Q?t=1994) we have here our fax documents which  
[0:33:17](https://youtu.be/qLCE8spVX9Q?t=1997) will travel through the atlc tunnel  
[0:33:19](https://youtu.be/qLCE8spVX9Q?t=1999) using Phase II of the t-34 the call and  
[0:33:21](https://youtu.be/qLCE8spVX9Q?t=2001) the receive result will be a jpg file  
[0:33:27](https://youtu.be/qLCE8spVX9Q?t=2007) this time we control the entire JPEG  
[0:33:29](https://youtu.be/qLCE8spVX9Q?t=2009) file its headers and data because the  
[0:33:31](https://youtu.be/qLCE8spVX9Q?t=2011) colorful fax is in fact a fully  
[0:33:33](https://youtu.be/qLCE8spVX9Q?t=2013) functional JPEG file so we received 80  
[0:33:37](https://youtu.be/qLCE8spVX9Q?t=2017) file with a black and white fax and a  
[0:33:40](https://youtu.be/qLCE8spVX9Q?t=2020) JPEG file with colorful fax both will be  
[0:33:43](https://youtu.be/qLCE8spVX9Q?t=2023) sent for printing now that we finally  
[0:33:48](https://youtu.be/qLCE8spVX9Q?t=2028) understood how fax even works where we  
[0:33:51](https://youtu.be/qLCE8spVX9Q?t=2031) should look for vulnerabilities in it so  
[0:33:54](https://youtu.be/qLCE8spVX9Q?t=2034) all of the layers we showed earlier can  
[0:33:57](https://youtu.be/qLCE8spVX9Q?t=2037) contain vulnerabilities we have  
[0:33:59](https://youtu.be/qLCE8spVX9Q?t=2039) complicated state machines we exchange  
[0:34:01](https://youtu.be/qLCE8spVX9Q?t=2041) strings were several decompression  
[0:34:04](https://youtu.be/qLCE8spVX9Q?t=2044) layers and we have two different file  
[0:34:06](https://youtu.be/qLCE8spVX9Q?t=2046) formats we need two parts we decided  
[0:34:08](https://youtu.be/qLCE8spVX9Q?t=2048) that the most convenient layer of them  
[0:34:10](https://youtu.be/qLCE8spVX9Q?t=2050) all will be the application one and more  
[0:34:12](https://youtu.be/qLCE8spVX9Q?t=2052) specifically the jpg parcel because we  
[0:34:14](https://youtu.be/qLCE8spVX9Q?t=2054) can fully control the entire JPEG file  
[0:34:17](https://youtu.be/qLCE8spVX9Q?t=2057) so we have a much better attack surface  
[0:34:20](https://youtu.be/qLCE8spVX9Q?t=2060) let us now see how Jake your viola  
[0:34:22](https://youtu.be/qLCE8spVX9Q?t=2062) actually looks like so this is a JPEG  
[0:34:26](https://youtu.be/qLCE8spVX9Q?t=2066) file it stands for it finds a colorful  
[0:34:29](https://youtu.be/qLCE8spVX9Q?t=2069) image and the most important thing is  
[0:34:31](https://youtu.be/qLCE8spVX9Q?t=2071) that JPEG consists of markers you have a  
[0:34:34](https://youtu.be/qLCE8spVX9Q?t=2074) start of marker after which we have an  
[0:34:37](https://youtu.be/qLCE8spVX9Q?t=2077) additional marker with its opcode link  
[0:34:40](https://youtu.be/qLCE8spVX9Q?t=2080) field and data after which you have a  
[0:34:43](https://youtu.be/qLCE8spVX9Q?t=2083) Malkiel with its opcode length and data  
[0:34:47](https://youtu.be/qLCE8spVX9Q?t=2087) and so on and so on  
[0:34:49](https://youtu.be/qLCE8spVX9Q?t=2089) and you finish with a marker now we know  
[0:34:54](https://youtu.be/qLCE8spVX9Q?t=2094) how big a file actually looks like let's  
[0:34:56](https://youtu.be/qLCE8spVX9Q?t=2096) zoom in on one such marker Oh specific  
[0:35:03](https://youtu.be/qLCE8spVX9Q?t=2103) marker is going to present a compression  
[0:35:05](https://youtu.be/qLCE8spVX9Q?t=2105) table we define a forever for  
[0:35:07](https://youtu.be/qLCE8spVX9Q?t=2107) compression matrix  
[0:35:08](https://youtu.be/qLCE8spVX9Q?t=2108) to efficiently compress our specific  
[0:35:10](https://youtu.be/qLCE8spVX9Q?t=2110) document in T files you use other tables  
[0:35:14](https://youtu.be/qLCE8spVX9Q?t=2114) and they were design and fixed and JPEG  
[0:35:18](https://youtu.be/qLCE8spVX9Q?t=2118) files you can use your own compression  
[0:35:20](https://youtu.be/qLCE8spVX9Q?t=2120) table for a specific image namakkal  
[0:35:23](https://youtu.be/qLCE8spVX9Q?t=2123) itself looks like this you have our  
[0:35:25](https://youtu.be/qLCE8spVX9Q?t=2125) opcode or length field the 4x4 matrix  
[0:35:29](https://youtu.be/qLCE8spVX9Q?t=2129) and our data if you assume in a bit  
[0:35:34](https://youtu.be/qLCE8spVX9Q?t=2134) deeper we can see that the values of  
[0:35:39](https://youtu.be/qLCE8spVX9Q?t=2139) four or four matrix are going to be  
[0:35:42](https://youtu.be/qLCE8spVX9Q?t=2142) accumulated together the matrix is  
[0:35:44](https://youtu.be/qLCE8spVX9Q?t=2144) supposed to be really sparse as you can  
[0:35:46](https://youtu.be/qLCE8spVX9Q?t=2146) see over there most of these zeros some  
[0:35:49](https://youtu.be/qLCE8spVX9Q?t=2149) one some twos the accumulated value is  
[0:35:52](https://youtu.be/qLCE8spVX9Q?t=2152) going to be the length field for the  
[0:35:54](https://youtu.be/qLCE8spVX9Q?t=2154) data inside a marker in this case we  
[0:35:57](https://youtu.be/qLCE8spVX9Q?t=2157) have our data is six so we're going to  
[0:36:00](https://youtu.be/qLCE8spVX9Q?t=2160) have six data bytes the data byte is  
[0:36:02](https://youtu.be/qLCE8spVX9Q?t=2162) themselves are going to be copied into a  
[0:36:05](https://youtu.be/qLCE8spVX9Q?t=2165) small array located on the stack so  
[0:36:08](https://youtu.be/qLCE8spVX9Q?t=2168) let's sum grab a bit we're going to sum  
[0:36:11](https://youtu.be/qLCE8spVX9Q?t=2171) all of the values you know forward for  
[0:36:12](https://youtu.be/qLCE8spVX9Q?t=2172) matrix the length field will be 6 in  
[0:36:15](https://youtu.be/qLCE8spVX9Q?t=2175) this case and 6 bytes are going to be  
[0:36:18](https://youtu.be/qLCE8spVX9Q?t=2178) copied into our local stack buffer so at  
[0:36:23](https://youtu.be/qLCE8spVX9Q?t=2183) this point we're like over the facts  
[0:36:26](https://youtu.be/qLCE8spVX9Q?t=2186) because what will happen if we'll use  
[0:36:29](https://youtu.be/qLCE8spVX9Q?t=2189) large values inside our matrix we have  
[0:36:33](https://youtu.be/qLCE8spVX9Q?t=2193) 16 bytes you know 4 by 4 matrix and  
[0:36:36](https://youtu.be/qLCE8spVX9Q?t=2196) we're going to send them all up to  
[0:36:37](https://youtu.be/qLCE8spVX9Q?t=2197) roughly 4 kilobytes and 4 kilobytes of  
[0:36:41](https://youtu.be/qLCE8spVX9Q?t=2201) data are going to be copy into a small  
[0:36:43](https://youtu.be/qLCE8spVX9Q?t=2203) stack buffer of size 256 bytes so that's  
[0:36:47](https://youtu.be/qLCE8spVX9Q?t=2207) be ideas for the film where we have an  
[0:36:50](https://youtu.be/qLCE8spVX9Q?t=2210) overflow now that we found our  
[0:36:54](https://youtu.be/qLCE8spVX9Q?t=2214) vulnerability it's still stuck based  
[0:36:57](https://youtu.be/qLCE8spVX9Q?t=2217) buffer overflow let us do you have any  
[0:36:59](https://youtu.be/qLCE8spVX9Q?t=2219) sort of constraints because we simply  
[0:37:02](https://youtu.be/qLCE8spVX9Q?t=2222) copy data from one file to the stock  
[0:37:04](https://youtu.be/qLCE8spVX9Q?t=2224) buffer where have no constraints or  
[0:37:07](https://youtu.be/qLCE8spVX9Q?t=2227) forbidden bytes we can use null by it's  
[0:37:09](https://youtu.be/qLCE8spVX9Q?t=2229) not a skew by its whatever bytes you  
[0:37:11](https://youtu.be/qLCE8spVX9Q?t=2231) choose we can use up to 4 kilobytes of  
[0:37:14](https://youtu.be/qLCE8spVX9Q?t=2234) data and we can control the length so we  
[0:37:16](https://youtu.be/qLCE8spVX9Q?t=2236) can we actually used in our exploit  
[0:37:18](https://youtu.be/qLCE8spVX9Q?t=2238) roughly 2 K so it's controllable  
[0:37:21](https://youtu.be/qLCE8spVX9Q?t=2241) and since we actually sent a large JPEG  
[0:37:24](https://youtu.be/qLCE8spVX9Q?t=2244) file we can embed inside it much more  
[0:37:27](https://youtu.be/qLCE8spVX9Q?t=2247) data to be used layer so we can use  
[0:37:30](https://youtu.be/qLCE8spVX9Q?t=2250) roughly 4k for exploit and our exploit  
[0:37:33](https://youtu.be/qLCE8spVX9Q?t=2253) can load enormous amount of data from  
[0:37:36](https://youtu.be/qLCE8spVX9Q?t=2256) the fax itself so we could continue on  
[0:37:39](https://youtu.be/qLCE8spVX9Q?t=2259) at this point we have a vulnerability  
[0:37:42](https://youtu.be/qLCE8spVX9Q?t=2262) let us now see what bypass we should use  
[0:37:47](https://youtu.be/qLCE8spVX9Q?t=2267) for operating system security  
[0:37:49](https://youtu.be/qLCE8spVX9Q?t=2269) mitigations no not really because it's a  
[0:37:53](https://youtu.be/qLCE8spVX9Q?t=2273) real-time operating system all of the  
[0:37:55](https://youtu.be/qLCE8spVX9Q?t=2275) addresses are fakes with no stack  
[0:37:58](https://youtu.be/qLCE8spVX9Q?t=2278) Canaries all the tests share the same  
[0:38:00](https://youtu.be/qLCE8spVX9Q?t=2280) address space we run in the highest of  
[0:38:03](https://youtu.be/qLCE8spVX9Q?t=2283) privileges so it's it's an 80s party and  
[0:38:07](https://youtu.be/qLCE8spVX9Q?t=2287) it couldn't be easier once we found a  
[0:38:11](https://youtu.be/qLCE8spVX9Q?t=2291) vulnerability is we contacted HP and we  
[0:38:13](https://youtu.be/qLCE8spVX9Q?t=2293) started a responsible disclosure process  
[0:38:15](https://youtu.be/qLCE8spVX9Q?t=2295) we actually flew over there to HP's  
[0:38:18](https://youtu.be/qLCE8spVX9Q?t=2298) campus to help them with demonstrated a  
[0:38:21](https://youtu.be/qLCE8spVX9Q?t=2301) vulnerability and we help them catch it  
[0:38:23](https://youtu.be/qLCE8spVX9Q?t=2303) it was quite interesting because at  
[0:38:26](https://youtu.be/qLCE8spVX9Q?t=2306) first we were told to fly to Portland  
[0:38:28](https://youtu.be/qLCE8spVX9Q?t=2308) and very no HP offices in Portland so we  
[0:38:32](https://youtu.be/qLCE8spVX9Q?t=2312) talked to them a bit more and they told  
[0:38:34](https://youtu.be/qLCE8spVX9Q?t=2314) you neva tree I should fly to Vancouver  
[0:38:37](https://youtu.be/qLCE8spVX9Q?t=2317) and we were like Vancouver in Canada so  
[0:38:41](https://youtu.be/qLCE8spVX9Q?t=2321) I flew the Portland and I drilled to  
[0:38:44](https://youtu.be/qLCE8spVX9Q?t=2324) Vancouver Washington and we help them  
[0:38:47](https://youtu.be/qLCE8spVX9Q?t=2327) fix it and if you were to their blackhat  
[0:38:50](https://youtu.be/qLCE8spVX9Q?t=2330) I was the back end and first time this  
[0:38:52](https://youtu.be/qLCE8spVX9Q?t=2332) year you couldn't miss a huge booth of  
[0:38:56](https://youtu.be/qLCE8spVX9Q?t=2336) HP we're using the wolf or the fixer  
[0:39:01](https://youtu.be/qLCE8spVX9Q?t=2341) this year so you don't probably know the  
[0:39:03](https://youtu.be/qLCE8spVX9Q?t=2343) HP really cares about the security of  
[0:39:05](https://youtu.be/qLCE8spVX9Q?t=2345) its product so we got an official I see  
[0:39:10](https://youtu.be/qLCE8spVX9Q?t=2350) the ease from HP here the two CVEs  
[0:39:13](https://youtu.be/qLCE8spVX9Q?t=2353) they're both rated as critical with a  
[0:39:15](https://youtu.be/qLCE8spVX9Q?t=2355) CVS core of nine point eight out of ten  
[0:39:17](https://youtu.be/qLCE8spVX9Q?t=2357) so that's quite rare maybe even familiar  
[0:39:21](https://youtu.be/qLCE8spVX9Q?t=2361) with these two CVEs because they got  
[0:39:23](https://youtu.be/qLCE8spVX9Q?t=2363) several media attention in the past week  
[0:39:26](https://youtu.be/qLCE8spVX9Q?t=2366) so here's the official response from HP  
[0:39:30](https://youtu.be/qLCE8spVX9Q?t=2370) when HP learned of the issue we worked  
[0:39:32](https://youtu.be/qLCE8spVX9Q?t=2372) quickly to provide updates amiss  
[0:39:34](https://youtu.be/qLCE8spVX9Q?t=2374) risks HP take security seriously and  
[0:39:37](https://youtu.be/qLCE8spVX9Q?t=2377) causes customers the keep the system's  
[0:39:38](https://youtu.be/qLCE8spVX9Q?t=2378) updated to protect against potential  
[0:39:40](https://youtu.be/qLCE8spVX9Q?t=2380) vulnerabilities and once we finish this  
[0:39:43](https://youtu.be/qLCE8spVX9Q?t=2383) this is a good time for our live demo  
[0:39:47](https://youtu.be/qLCE8spVX9Q?t=2387) [Applause]  
[0:39:51](https://youtu.be/qLCE8spVX9Q?t=2391) okay thank you so we don't we don't have  
[0:39:54](https://youtu.be/qLCE8spVX9Q?t=2394) a lot of time let's see this thing in  
[0:39:57](https://youtu.be/qLCE8spVX9Q?t=2397) action so we brought you here printer  
[0:39:59](https://youtu.be/qLCE8spVX9Q?t=2399) Def Con could supply us with phone lines  
[0:40:01](https://youtu.be/qLCE8spVX9Q?t=2401) so we just brought our own phone thing  
[0:40:05](https://youtu.be/qLCE8spVX9Q?t=2405) and then we have the attacker attacker a  
[0:40:08](https://youtu.be/qLCE8spVX9Q?t=2408) laptop over there and we're sending our  
[0:40:11](https://youtu.be/qLCE8spVX9Q?t=2411) fax now yeah good and our answer in two  
[0:40:17](https://youtu.be/qLCE8spVX9Q?t=2417) rings take a look at the LCD screen of  
[0:40:24](https://youtu.be/qLCE8spVX9Q?t=2424) the of the critter receiving fax from  
[0:40:33](https://youtu.be/qLCE8spVX9Q?t=2433) malicious attacker if you can relive so  
[0:40:37](https://youtu.be/qLCE8spVX9Q?t=2437) if you see these facts right run away  
[0:40:40](https://youtu.be/qLCE8spVX9Q?t=2440) [Music]  
[0:40:44](https://youtu.be/qLCE8spVX9Q?t=2444) and should be here now  
[0:40:51](https://youtu.be/qLCE8spVX9Q?t=2451) yeah faxes are slow sorry for that yeah  
[0:41:01](https://youtu.be/qLCE8spVX9Q?t=2461) fax received now the JPEG parsing is  
[0:41:03](https://youtu.be/qLCE8spVX9Q?t=2463) going on and basically we have control  
[0:41:08](https://youtu.be/qLCE8spVX9Q?t=2468) of the printer so this is our logo and  
[0:41:10](https://youtu.be/qLCE8spVX9Q?t=2470) that means the printer is ours thank you  
[0:41:15](https://youtu.be/qLCE8spVX9Q?t=2475) thank you but but we have we have we  
[0:41:17](https://youtu.be/qLCE8spVX9Q?t=2477) have something else because now that we  
[0:41:19](https://youtu.be/qLCE8spVX9Q?t=2479) have control over the printer it's not  
[0:41:20](https://youtu.be/qLCE8spVX9Q?t=2480) enough we want to show that we can  
[0:41:21](https://youtu.be/qLCE8spVX9Q?t=2481) propagate from the printer to the rest  
[0:41:24](https://youtu.be/qLCE8spVX9Q?t=2484) of the network and basically what we did  
[0:41:25](https://youtu.be/qLCE8spVX9Q?t=2485) is to embed eternal blew the leaked NSA  
[0:41:28](https://youtu.be/qLCE8spVX9Q?t=2488) exploit within our fax and now this  
[0:41:31](https://youtu.be/qLCE8spVX9Q?t=2491) printer once it what's it identifies any  
[0:41:35](https://youtu.be/qLCE8spVX9Q?t=2495) connected computer you just try to  
[0:41:36](https://youtu.be/qLCE8spVX9Q?t=2496) exploit it and here I'll connect if you  
[0:41:40](https://youtu.be/qLCE8spVX9Q?t=2500) look at the laptop for a second then you  
[0:41:43](https://youtu.be/qLCE8spVX9Q?t=2503) will see a calque popping  
[0:41:52](https://youtu.be/qLCE8spVX9Q?t=2512) so we did it it was a long research let  
[0:41:56](https://youtu.be/qLCE8spVX9Q?t=2516) me tell you but it was successful we  
[0:41:58](https://youtu.be/qLCE8spVX9Q?t=2518) think this is groundbreaking I hope you  
[0:42:00](https://youtu.be/qLCE8spVX9Q?t=2520) feel the same  
[0:42:01](https://youtu.be/qLCE8spVX9Q?t=2521) and now let's sum up with some  
[0:42:03](https://youtu.be/qLCE8spVX9Q?t=2523) conclusions if you'll switch back to the  
[0:42:05](https://youtu.be/qLCE8spVX9Q?t=2525) presentation yeah thank you so  
[0:42:08](https://youtu.be/qLCE8spVX9Q?t=2528) conclusions or pstn is still a valid  
[0:42:11](https://youtu.be/qLCE8spVX9Q?t=2531) attack surface even in 2018 facts can be  
[0:42:15](https://youtu.be/qLCE8spVX9Q?t=2535) used as a gateway to internal networks  
[0:42:17](https://youtu.be/qLCE8spVX9Q?t=2537) and another thing is that all in  
[0:42:19](https://youtu.be/qLCE8spVX9Q?t=2539) outdated protocols are probably bad for  
[0:42:21](https://youtu.be/qLCE8spVX9Q?t=2541) you so keep an eye for them and now  
[0:42:24](https://youtu.be/qLCE8spVX9Q?t=2544) probably you're asking yourselves what  
[0:42:26](https://youtu.be/qLCE8spVX9Q?t=2546) can you do well you can do some stuff  
[0:42:28](https://youtu.be/qLCE8spVX9Q?t=2548) you can patch your printers as we said  
[0:42:30](https://youtu.be/qLCE8spVX9Q?t=2550) HP published patches for these specific  
[0:42:34](https://youtu.be/qLCE8spVX9Q?t=2554) more abilities you can find them in this  
[0:42:36](https://youtu.be/qLCE8spVX9Q?t=2556) URL here and instructions from HP too  
[0:42:39](https://youtu.be/qLCE8spVX9Q?t=2559) and it identify by the way this works  
[0:42:41](https://youtu.be/qLCE8spVX9Q?t=2561) for any HP Officejet printer in inkjet  
[0:42:44](https://youtu.be/qLCE8spVX9Q?t=2564) like 80 or 100 models of them so make  
[0:42:48](https://youtu.be/qLCE8spVX9Q?t=2568) sure your another thing is don't connect  
[0:42:52](https://youtu.be/qLCE8spVX9Q?t=2572) fax if you don't if you don't need it  
[0:42:54](https://youtu.be/qLCE8spVX9Q?t=2574) right and if you do not need to connect  
[0:42:56](https://youtu.be/qLCE8spVX9Q?t=2576) fax then make sure to segregate your  
[0:42:58](https://youtu.be/qLCE8spVX9Q?t=2578) printers so they won't be connected to  
[0:43:00](https://youtu.be/qLCE8spVX9Q?t=2580) the rest of the network so if somebody  
[0:43:02](https://youtu.be/qLCE8spVX9Q?t=2582) manages to take over your printers at  
[0:43:04](https://youtu.be/qLCE8spVX9Q?t=2584) least the risk will be contained within  
[0:43:07](https://youtu.be/qLCE8spVX9Q?t=2587) the printer and you won't be able to  
[0:43:09](https://youtu.be/qLCE8spVX9Q?t=2589) propagate to the rest of the network now  
[0:43:11](https://youtu.be/qLCE8spVX9Q?t=2591) these are all really good suggestions  
[0:43:13](https://youtu.be/qLCE8spVX9Q?t=2593) but really the best suggestions are the  
[0:43:16](https://youtu.be/qLCE8spVX9Q?t=2596) best suggestion I have to give you today  
[0:43:18](https://youtu.be/qLCE8spVX9Q?t=2598) is please stop using fax  
[0:43:22](https://youtu.be/qLCE8spVX9Q?t=2602) [Applause]  
[0:43:27](https://youtu.be/qLCE8spVX9Q?t=2607) and now we really couldn't do a lot of  
[0:43:31](https://youtu.be/qLCE8spVX9Q?t=2611) this research if it wasn't for our  
[0:43:33](https://youtu.be/qLCE8spVX9Q?t=2613) wonderful friends so they helped us  
[0:43:36](https://youtu.be/qLCE8spVX9Q?t=2616) physically technically and mentally  
[0:43:39](https://youtu.be/qLCE8spVX9Q?t=2619) throughout the entire process of this  
[0:43:40](https://youtu.be/qLCE8spVX9Q?t=2620) research so they deserve some some  
[0:43:43](https://youtu.be/qLCE8spVX9Q?t=2623) clapping thank you thank them and one  
[0:43:48](https://youtu.be/qLCE8spVX9Q?t=2628) specific guy Ian I also helped us a lot  
[0:43:51](https://youtu.be/qLCE8spVX9Q?t=2631) in the few more thing and that's  
[0:43:55](https://youtu.be/qLCE8spVX9Q?t=2635) practically it so thank you very much  
[0:43:58](https://youtu.be/qLCE8spVX9Q?t=2638) and if you want to follow us please  
[0:44:00](https://youtu.be/qLCE8spVX9Q?t=2640) follow us on Twitter read our stuff on  
[0:44:03](https://youtu.be/qLCE8spVX9Q?t=2643) the on our blog and thank you very much  
[0:44:05](https://youtu.be/qLCE8spVX9Q?t=2645) for coming to this talk  
[0:44:07](https://youtu.be/qLCE8spVX9Q?t=2647) [Applause]  

